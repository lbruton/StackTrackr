<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8"><title>StakTrakr â€” OAuth</title></head>
<body>
<p>Authenticating&hellip;</p>
<script>
  var params = new URLSearchParams(location.search);
  var code = params.get('code');
  var state = params.get('state');
  if (code && state) {
    // Primary: postMessage to opener window
    if (window.opener) {
      window.opener.postMessage({ type: 'staktrakr-oauth', code: code, state: state }, '*');
    }
    // Fallback: localStorage relay for when opener is lost (Cloudflare challenge, etc.)
    try {
      localStorage.setItem('staktrakr_oauth_result', JSON.stringify({ code: code, state: state }));
    } catch (e) { /* ignore */ }
  }
  window.close();
</script>
</body>
</html>
