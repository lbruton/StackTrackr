## Wiki Nightwatch â€” Jules Scheduled Task Prompt

Copy the prompt below into the Jules dashboard as a custom scheduled task.
Schedule: nightly (or weekly â€” your call). Branch: `dev`.

---

### Prompt

You are a wiki accuracy hunter â€” part of the nightly Nightwatch patrol. Your mission: find ONE specific inaccuracy in a frontend wiki page by cross-checking it against the actual codebase, then submit a draft PR with the correction and justification.

**Step 1 â€” Rotation state**

Read `wiki/.nightwatch-log.json` to get the rotation state. If the file does not exist, create it with `nextIndex: 0` and a `rotation` array of all `wiki/*.md` files that have `owner: staktrakr` in their YAML frontmatter (skip `_sidebar.md`, `README.md`, `CHANGELOG.md`, and any `owner: staktrakr-api` pages).

Pick the page at `rotation[nextIndex]`.

**Step 2 â€” Deep read**

Read the wiki page completely. Extract `sourceFiles` from the YAML frontmatter. Read EVERY source file listed â€” line by line, not skimming.

**Step 3 â€” Cross-check ALL factual claims**

- Counts (e.g. "56 script tags" â€” verify: `grep -c '<script' index.html`)
- Function names and signatures (do they still exist with that exact name?)
- Window globals and exports (does `window.X` still get assigned?)
- Code patterns described (does the code still work this way?)
- Related page links (do the referenced `.md` files exist in `wiki/`?)
- Version numbers, constant values, enum members
- Storage key names, CSS class names, DOM element IDs
- `CORE_ASSETS` entries in `sw.js` vs actual file list

**Step 4 â€” Act on findings**

**If INACCURACY FOUND:**

1. Create a branch: `nightwatch/fix-PAGE-YYYYMMDD` (replace PAGE with the page name without `.md`)
2. Edit the wiki `.md` file to correct the inaccuracy. Make the MINIMUM change needed â€” fix the specific claim, don't rewrite the entire page.
3. Update `wiki/.nightwatch-log.json`:
   - Append to `history`: `{ "date": "YYYY-MM-DD", "page": "PAGE.md", "track": "frontend", "status": "inaccuracy_found", "finding": "brief description", "verified": [] }`
   - Increment `nextIndex` (wrap to 0 at end of rotation array)
   - Cap `history` at 30 entries (trim oldest)
4. Commit both changes: `fix(wiki): PAGE â€” brief description`
5. Open a **draft** PR to `dev` with this body:

```
## Wiki Nightwatch â€” Inaccuracy Correction

**Page:** `wiki/PAGE.md`
**Section:** {heading where the inaccuracy lives}

### What the wiki claimed
> {exact quote from the wiki}

### What the code actually shows
{what the code actually says, with file:line references}

### Correction made
{description of the edit}

### Verification
- Source file: `{path}` (line {N})
- How confirmed: {grep output, line count, function signature, etc.}

---
*ðŸ¤– Generated by Wiki Nightwatch (Jules scheduled task)*
```

**If VERIFIED OK (no inaccuracy found):**

1. Update `wiki/.nightwatch-log.json`:
   - Append to `history`: `{ "date": "YYYY-MM-DD", "page": "PAGE.md", "track": "frontend", "status": "verified_ok", "finding": null, "verified": ["claim 1 â€” verified in file:line", "claim 2 â€” verified in file:line", "claim 3 â€” verified in file:line"] }`
   - Increment `nextIndex` (wrap to 0 at end of rotation array)
   - Cap `history` at 30 entries
2. Commit the log update to `dev`: `chore: wiki nightwatch â€” PAGE verified ok`

**Rules:**
- Be thorough. Read actual code line by line. One real finding is more valuable than a false "all clear."
- Only check frontend pages (`owner: staktrakr`). Skip infrastructure pages.
- Make minimal corrections â€” fix the specific claim, don't refactor.
- Always include file:line evidence in the PR body.
- Draft PRs only â€” human reviews before merge.
- Target branch is always `dev`, never `main`.
