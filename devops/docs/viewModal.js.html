<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: viewModal.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: viewModal.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// VIEW ITEM MODAL — Card-style showcase with coin images + enriched data
// =============================================================================

/**
 * Active object URLs created for the current view modal session.
 * Revoked on modal close to prevent memory leaks.
 * @type {string[]}
 */
let _viewModalObjectUrls = [];

/** @type {Chart|null} Price history chart instance — destroyed on modal close */
let _viewModalChartInstance = null;

/** @type {number[]} Available chart range options (0 = all, -1 = from purchase date) */
const _VIEW_CHART_RANGES = [7, 14, 30, 60, 90, 180, 365, 1825, 3650, -1, 0];

/** @type {string[]} Display labels for chart range pills */
const _VIEW_CHART_RANGE_LABELS = ['7d', '14d', '30d', '60d', '90d', '180d', '1Y', '5Y', '10Y', 'Purchased', 'All'];

/** @type {number} Default chart range in days (-1 = from purchase date, falls back to 30d) */
const _VIEW_CHART_DEFAULT_RANGE = -1;

// ---------------------------------------------------------------------------
// Public API
// ---------------------------------------------------------------------------

/**
 * Open the view modal for a specific inventory item.
 * @param {number} index - Index into the global `inventory` array
 */
async function showViewModal(index) {
  const item = inventory[index];
  if (!item) return;

  const modal = document.getElementById('viewItemModal');
  if (!modal) return;

  const body = document.getElementById('viewModalBody');
  if (!body) return;

  // Build modal content
  body.textContent = '';
  body.appendChild(buildViewContent(item, index));

  // Render price history chart (canvas must be in DOM first)
  const chartCanvas = body.querySelector('#viewPriceHistoryChart');
  if (chartCanvas &amp;&amp; chartCanvas._chartData) {
    const cd = chartCanvas._chartData;
    // "Purchased" default (-1): calculate days from purchase date, fall back to 30d
    let initRange = _VIEW_CHART_DEFAULT_RANGE;
    if (initRange === -1) {
      initRange = cd.purchaseDate > 0
        ? Math.max(1, Math.ceil((Date.now() - cd.purchaseDate) / 86400000))
        : 30;
    }
    if (initRange === 0 || initRange > 180) {
      const metalName = item.metal || 'Silver';
      _fetchHistoricalSpotData(metalName, initRange).then((fullSpot) => {
        _createPriceHistoryChart(chartCanvas, fullSpot, cd.retailEntries, cd.purchasePerUnit, cd.meltFactor, initRange, cd.purchaseDate, cd.currentRetail);
      }).catch(() => {
        _createPriceHistoryChart(chartCanvas, cd.spotEntries, cd.retailEntries, cd.purchasePerUnit, cd.meltFactor, initRange, cd.purchaseDate, cd.currentRetail);
      });
    } else {
      _createPriceHistoryChart(chartCanvas, cd.spotEntries, cd.retailEntries, cd.purchasePerUnit, cd.meltFactor, initRange, cd.purchaseDate, cd.currentRetail);
    }
  }

  modal.style.display = 'flex';

  // Load images and Numista data asynchronously after modal is visible
  // Share a single API result to avoid duplicate calls
  const catalogId = item.numistaId || '';
  let apiResult = null;

  // Try loading images from cache/item first
  const cacheResult = await loadViewImages(item, body);
  const imagesLoaded = cacheResult.loaded;
  const imageSource = cacheResult.source;

  // Check whether metadata is already cached in IndexedDB
  let metaCached = false;
  if (catalogId &amp;&amp; window.imageCache?.isAvailable()) {
    try {
      const cachedMeta = await imageCache.getMetadata(catalogId);
      metaCached = !!(cachedMeta &amp;&amp; (Date.now() - (cachedMeta.cachedAt || 0)) &lt; VIEW_METADATA_TTL);
    } catch { /* ignore */ }
  }

  // Only hit the API when images are missing OR metadata is not in cache
  if (catalogId &amp;&amp; (!imagesLoaded || !metaCached)) {
    apiResult = await _fetchNumistaResult(catalogId);
  }

  // Fill images from API result when:
  // 1. No images were loaded at all, OR
  // 2. Override is ON and current images are from user uploads or pattern rules (Numista wins)
  const numistaOverride = localStorage.getItem('numistaOverridePersonal') === 'true';
  const shouldReplaceWithApi = !imagesLoaded || (numistaOverride &amp;&amp; (imageSource === 'pattern' || imageSource === 'user'));

  if (shouldReplaceWithApi &amp;&amp; apiResult &amp;&amp; (apiResult.imageUrl || apiResult.reverseImageUrl)) {
    const section = body.querySelector('#viewImageSection');
    if (section) {
      const slots = section.querySelectorAll('.view-image-slot');
      if (apiResult.imageUrl) _setSlotImage(slots[0], apiResult.imageUrl);
      if (apiResult.reverseImageUrl) _setSlotImage(slots[1], apiResult.reverseImageUrl);

      // Cache for next time (future resolveImageForItem will find it)
      if (window.imageCache?.isAvailable()) {
        imageCache.cacheImages(catalogId, apiResult.imageUrl || '', apiResult.reverseImageUrl || '').catch(() => {});
      }
    }

  } else if (!imagesLoaded &amp;&amp; apiResult) {
    // Fallback: cache even if no image URLs (metadata-only result)
    if (window.imageCache?.isAvailable() &amp;&amp; catalogId) {
      imageCache.cacheImages(catalogId, apiResult.imageUrl || '', apiResult.reverseImageUrl || '').catch(() => {});
    }
  }

  // Persist CDN URLs to the inventory item so table/card views can use them
  // without needing an API call. Runs regardless of whether images were replaced
  // in the modal — the URLs are valuable for card/table rendering. Never overwrite.
  if (apiResult &amp;&amp; (apiResult.imageUrl || apiResult.reverseImageUrl)) {
    let urlsDirty = false;
    if (apiResult.imageUrl &amp;&amp; !item.obverseImageUrl) {
      item.obverseImageUrl = apiResult.imageUrl;
      urlsDirty = true;
    }
    if (apiResult.reverseImageUrl &amp;&amp; !item.reverseImageUrl) {
      item.reverseImageUrl = apiResult.reverseImageUrl;
      urlsDirty = true;
    }
    if (urlsDirty &amp;&amp; typeof saveInventory === 'function') {
      saveInventory();
    }
  }

  // Load Numista enrichment section
  await loadViewNumistaData(item, body, apiResult);
}

/**
 * Close the view modal and clean up resources.
 */
function closeViewModal() {
  const modal = document.getElementById('viewItemModal');
  if (modal) modal.style.display = 'none';

  // Destroy price history chart to free canvas resources
  if (_viewModalChartInstance) {
    _viewModalChartInstance.destroy();
    _viewModalChartInstance = null;
  }

  // Revoke all object URLs to free memory
  _viewModalObjectUrls.forEach(url => {
    try { URL.revokeObjectURL(url); } catch { /* ignore */ }
  });
  _viewModalObjectUrls = [];
}

// ---------------------------------------------------------------------------
// Content builder
// ---------------------------------------------------------------------------

/**
 * Compute shared metrics used by all view modal section renderers.
 * @param {Object} item - Inventory item
 * @returns {Object} Metrics object with currentSpot, qty, weight, purity, isGb, weightOz, metalColor
 */
function _getViewMetrics(item) {
  const metalKey = (item.metal || 'silver').toLowerCase();
  const currentSpot = spotPrices[metalKey] || 0;
  const qty = Number(item.qty) || 1;
  const weight = parseFloat(item.weight) || 0;
  const purity = parseFloat(item.purity) || 1.0;
  const isGb = item.weightUnit === 'gb';
  const weightOz = isGb ? weight * GB_TO_OZT : weight;
  const metalColor = typeof getMetalColor === 'function' ? getMetalColor(metalKey) : null;
  return { currentSpot, qty, weight, purity, isGb, weightOz, metalColor };
}

function _renderHeaderMeta(item, metrics) {
  const header = document.getElementById('viewModalTitle');
  if (header) header.textContent = sanitizeHtml(item.name || 'Untitled Item');
  _renderCatalogBadge(item);
  _applyHeaderGradient(header, metrics.metalColor);
  _renderCountChip(item);
}

function _renderCatalogBadge(item) {
  const catalogBadge = document.getElementById('viewModalCatalogId');
  if (!catalogBadge) return;
  const nId = item.numistaId || '';
  catalogBadge.textContent = nId ? `N#${nId}` : '';
  catalogBadge.style.display = nId ? '' : 'none';
  if (!nId) {
    catalogBadge.onclick = null;
    catalogBadge.style.cursor = '';
    return;
  }
  catalogBadge.style.cursor = 'pointer';
  catalogBadge.title = 'View on Numista';
  catalogBadge.onclick = (e) => {
    e.stopPropagation();
    const isSet = /^S/i.test(nId);
    const cleanId = nId.replace(/^[NS]?#?\s*/i, '').trim();
    const url = isSet
      ? `https://en.numista.com/catalogue/set.php?id=${cleanId}`
      : `https://en.numista.com/catalogue/pieces${cleanId}.html`;
    _openExternalPopup(url, `numista_${nId}`);
  };
}

function _applyHeaderGradient(header, metalColor) {
  const modalHeader = document.getElementById('viewItemModal')?.querySelector('.modal-header');
  if (!modalHeader || !metalColor) return;
  modalHeader.style.background = `linear-gradient(135deg, ${metalColor}, ${_darkenColor(metalColor, 0.3)})`;
  const textColor = _isLightColor(metalColor) ? '#1e293b' : '#f8fafc';
  modalHeader.style.color = textColor;
  if (header) header.style.color = textColor;
}

function _renderCountChip(item) {
  const countChip = document.getElementById('viewModalCountChip');
  if (!countChip) return;
  const totalQty = inventory.reduce((sum, invItem) => {
    return invItem.name === item.name &amp;&amp; invItem.metal === item.metal
      ? sum + (Number(invItem.qty) || 1)
      : sum;
  }, 0);
  countChip.textContent = totalQty > 1 ? `\u00d7${totalQty} in inventory` : '';
  countChip.style.display = totalQty > 1 ? '' : 'none';
}

function _buildImageSection(item, metrics) {
  const itemType = (item.type || '').toLowerCase();
  const isRectShape = itemType === 'bar' || itemType === 'note' || itemType === 'aurum'
    || itemType === 'set' || metrics.isGb;
  const imgSection = _el('div', 'view-image-section' + (isRectShape ? ' view-shape-rect' : ''));
  imgSection.id = 'viewImageSection';
  imgSection.appendChild(_imageSlot('obverse', 'Obverse'));
  imgSection.appendChild(_imageSlot('reverse', 'Reverse'));
  if (metrics.metalColor) {
    imgSection.style.background = `linear-gradient(145deg, color-mix(in srgb, ${metrics.metalColor} 15%, #1a1a2e), color-mix(in srgb, ${metrics.metalColor} 8%, #16213e))`;
  }
  const badge = _buildImageCertBadge(item);
  if (badge) imgSection.appendChild(badge);
  return imgSection;
}

function _buildImageCertBadge(item) {
  if (!item.grade) return null;
  const badge = _el('div', 'view-cert-badge');
  const authority = item.gradingAuthority || '';
  const certNum = item.certNumber || '';
  const pcgsNo = item.pcgsNumber || '';
  const isVerified = item.pcgsVerified === true &amp;&amp; authority === 'PCGS';
  if (authority) badge.dataset.authority = authority;
  const gradeSpan = _buildImageCertGrade(item, authority, certNum, pcgsNo);
  badge.appendChild(gradeSpan);
  const verifySpan = _buildPcgsVerifyControl(item, authority, certNum, isVerified, false);
  if (verifySpan) badge.appendChild(verifySpan);
  return badge;
}

function _buildImageCertGrade(item, authority, certNum, pcgsNo) {
  const gradeSpan = _el('span', 'view-cert-grade');
  gradeSpan.textContent = authority ? `${authority} ${item.grade}` : item.grade;
  const certUrlTemplate = (typeof CERT_LOOKUP_URLS !== 'undefined' &amp;&amp; authority) ? CERT_LOOKUP_URLS[authority] : '';
  const hasCertLink = certUrlTemplate &amp;&amp; (certNum || pcgsNo);
  const hasCoinFacts = authority === 'PCGS' &amp;&amp; pcgsNo;
  if (hasCertLink || hasCoinFacts) {
    gradeSpan.classList.add('view-cert-clickable');
    gradeSpan.title = certNum ? `Look up ${authority} Cert #${certNum}` : `Open ${authority} verification`;
    gradeSpan.tabIndex = 0;
    gradeSpan.role = 'button';
    gradeSpan.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); gradeSpan.click(); } });
    gradeSpan.addEventListener('click', (e) => {
      e.stopPropagation();
      const url = hasCoinFacts
        ? _buildPcgsCoinFactsUrl(item.grade || '', pcgsNo)
        : certUrlTemplate.replace(/\{certNumber\}/g, encodeURIComponent(certNum)).replace(/\{grade\}/g, encodeURIComponent(item.grade || ''));
      const popupName = `cert_${authority}_${certNum || pcgsNo}`.replace(/[^a-zA-Z0-9_]/g, '_');
      const popup = window.open(url, popupName, 'width=1250,height=800,scrollbars=yes,resizable=yes,toolbar=no,location=no,menubar=no,status=no');
      if (popup) popup.focus();
    });
  } else {
    gradeSpan.title = authority ? `Graded by ${authority}: ${item.grade}${certNum ? ` — Cert #${certNum}` : ''}` : `Grade: ${item.grade}`;
  }
  return gradeSpan;
}

function _buildPcgsCoinFactsUrl(gradeText, pcgsNo) {
  const gradeNum = gradeText.match(/\d+/)?.[0] || '';
  return gradeNum
    ? `https://www.pcgs.com/coinfacts/coin/detail/${encodeURIComponent(pcgsNo)}/${encodeURIComponent(gradeNum)}`
    : `https://www.pcgs.com/coinfacts/coin/${encodeURIComponent(pcgsNo)}`;
}

function _buildPcgsVerifyControl(item, authority, certNum, isVerified, inline) {
  const showVerifyBtn = authority === 'PCGS' &amp;&amp; certNum
    &amp;&amp; typeof catalogConfig !== 'undefined' &amp;&amp; catalogConfig.isPcgsEnabled()
    &amp;&amp; typeof verifyPcgsCert === 'function';
  if (!showVerifyBtn) return null;
  const cls = inline ? 'view-cert-verify view-cert-verify-inline' : 'view-cert-verify';
  const verifySpan = _el('span', `${cls}${isVerified ? ' pcgs-verified' : ''}`);
  verifySpan.tabIndex = 0;
  verifySpan.role = 'button';
  verifySpan.dataset.certNumber = certNum;
  verifySpan.title = isVerified ? `Verified — Cert #${certNum}` : 'Verify cert via PCGS API';
  verifySpan.innerHTML = '&lt;svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">&lt;path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>&lt;polyline points="22 4 12 14.01 9 11.01"/>&lt;/svg>';
  verifySpan.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); verifySpan.click(); } });
  verifySpan.addEventListener('click', (e) => {
    e.stopPropagation();
    _verifyPcgsCertAndUpdate(item, certNum, verifySpan, inline);
  });
  return verifySpan;
}

function _verifyPcgsCertAndUpdate(item, certNum, verifyEl, syncImageBadge) {
  verifyEl.classList.add('pcgs-verifying');
  verifyEl.title = 'Verifying...';
  verifyPcgsCert(certNum).then((result) => {
    verifyEl.classList.remove('pcgs-verifying');
    if (!result.verified) {
      verifyEl.title = result.error || 'Verification failed';
      verifyEl.classList.add('pcgs-verify-failed');
      setTimeout(() => verifyEl.classList.remove('pcgs-verify-failed'), 3000);
      return;
    }
    verifyEl.classList.add('pcgs-verified');
    const idx = inventory.findIndex((inv) => inv.uuid === item.uuid);
    if (idx >= 0) {
      inventory[idx].pcgsVerified = true;
      saveInventory();
    }
    const parts = [];
    if (result.grade) parts.push(`Grade: ${result.grade}`);
    if (result.population) parts.push(`Pop: ${result.population}`);
    if (result.popHigher) parts.push(`Pop Higher: ${result.popHigher}`);
    if (result.priceGuide) parts.push(`Price Guide: $${Number(result.priceGuide).toLocaleString()}`);
    verifyEl.title = `Verified — ${parts.join(' | ')}`;
    if (syncImageBadge) {
      const imgBadgeVerify = document.querySelector('#viewItemModal .view-cert-verify:not(.view-cert-verify-inline)');
      if (imgBadgeVerify) imgBadgeVerify.classList.add('pcgs-verified');
    }
  }).catch((err) => {
    verifyEl.classList.remove('pcgs-verifying');
    verifyEl.title = 'Verification service unavailable';
    if (typeof debugLog === 'function') debugLog('warn', 'PCGS verify failed:', err);
  });
}

function _buildInventorySection(item, metrics) {
  const invSection = _section('Inventory');
  const invGrid = _el('div', 'view-detail-grid three-col');
  _addDetail(invGrid, 'Metal', item.composition || item.metal || '—');
  _addDetail(invGrid, 'Type', item.type || '—');
  _addDetail(invGrid, 'Year', item.year || '—');
  _addDetail(invGrid, 'Purity', metrics.purity &lt; 1 ? `.${String(metrics.purity).replace('0.', '')}` : metrics.purity === 1 ? '.999+' : String(metrics.purity));
  _addDetail(invGrid, 'Weight', typeof formatWeight === 'function' ? formatWeight(metrics.weight, item.weightUnit) : `${metrics.weight} oz`);
  _addDetail(invGrid, 'Qty', String(metrics.qty));
  invSection.appendChild(invGrid);
  const invGrid2 = _el('div', 'view-detail-grid three-col');
  const dateVal = item.date ? (typeof formatDisplayDate === 'function' ? formatDisplayDate(item.date) : item.date) : '—';
  _addDetail(invGrid2, 'Date', dateVal);
  _appendSourceField(invGrid2, item.purchaseLocation || '—');
  invSection.appendChild(invGrid2);
  const storGrid = _el('div', 'view-detail-grid');
  _addDetail(storGrid, 'Storage', item.storageLocation || '\u2014');
  invSection.appendChild(storGrid);
  return invSection;
}

function _appendSourceField(container, sourceValue) {
  const srcUrlPattern = /^(https?:\/\/)?[\w.-]+\.(com|net|org|co|io|us|uk|ca|au|de|fr|shop|store)\b/i;
  if (!srcUrlPattern.test(sourceValue)) {
    _addDetail(container, 'Source', sourceValue);
    return;
  }
  const srcItem = _detailItem('Source', '');
  const valEl = srcItem.querySelector('.view-detail-value');
  if (valEl) {
    valEl.textContent = '';
    const srcLink = document.createElement('a');
    srcLink.href = '#';
    const srcHref = /^https?:\/\//i.test(sourceValue) ? sourceValue : `https://${sourceValue}`;
    srcLink.title = srcHref;
    srcLink.style.color = 'var(--primary)';
    srcLink.style.textDecoration = 'none';
    srcLink.textContent = sourceValue.replace(/^(https?:\/\/)?(www\.)?/i, '').replace(/\/(.*)/i, '');
    srcLink.addEventListener('click', (e) => { e.preventDefault(); _openExternalPopup(srcHref, 'source_popup'); });
    valEl.appendChild(srcLink);
  }
  container.appendChild(srcItem);
}

function _buildValuationSection(item, metrics) {
  const meltValue = metrics.currentSpot > 0 ? metrics.weightOz * metrics.qty * metrics.currentSpot * metrics.purity : 0;
  const purchaseTotal = metrics.qty * (parseFloat(item.price) || 0);
  const marketVal = parseFloat(item.marketValue) || 0;
  const retailTotal = marketVal > 0 ? metrics.qty * marketVal : meltValue;
  const gainLoss = retailTotal > 0 ? retailTotal - purchaseTotal : null;
  const valSection = _section('Valuation');
  valSection.classList.add('view-valuation-section');
  const valGrid = _el('div', 'view-detail-grid four-col');
  const purchaseDateStr = item.date ? (typeof formatDisplayDate === 'function' ? formatDisplayDate(item.date) : item.date) : '';
  const purchaseLabel = purchaseDateStr ? `${formatCurrency(purchaseTotal)} (${purchaseDateStr})` : formatCurrency(purchaseTotal);
  _addDetail(valGrid, 'Purchase', purchaseLabel);
  _addDetail(valGrid, 'Melt Value', metrics.currentSpot > 0 ? formatCurrency(meltValue) : '—');
  _addDetail(valGrid, 'Retail', retailTotal > 0 ? formatCurrency(retailTotal) : '—');
  if (gainLoss !== null &amp;&amp; retailTotal > 0) {
    const glItem = _detailItem('Gain/Loss', (gainLoss >= 0 ? '+' : '') + formatCurrency(gainLoss));
    const valEl = glItem.querySelector('.view-detail-value');
    if (valEl) valEl.classList.add(gainLoss >= 0 ? 'gain' : 'loss');
    valGrid.appendChild(glItem);
  } else {
    _addDetail(valGrid, 'Gain/Loss', '—', 'muted');
  }
  valSection.appendChild(valGrid);
  return valSection;
}

function _getPriceHistoryContext(item, metrics) {
  const metalName = item.metal || 'Silver';
  const meltFactor = metrics.weightOz * metrics.qty * metrics.purity;
  const spotEntries = (typeof spotHistory !== 'undefined')
    ? spotHistory.filter(e => e.metal === metalName).map(e => ({ ts: new Date(e.timestamp).getTime(), spot: e.spot })).sort((a, b) => a.ts - b.ts)
    : [];
  const spotByDay = new Map();
  for (const e of spotEntries) {
    const day = new Date(e.ts).toISOString().slice(0, 10);
    spotByDay.set(day, e);
  }
  const dailySpotEntries = [...spotByDay.values()];
  const retailEntries = (typeof itemPriceHistory !== 'undefined' &amp;&amp; item.uuid) ? (itemPriceHistory[item.uuid] || []).filter(e => e.retail > 0) : [];
  return {
    metalName,
    meltFactor,
    dailySpotEntries,
    retailEntries,
    purchasePerUnit: parseFloat(item.price) || 0,
    purchaseDate: item.date ? new Date(item.date).getTime() : 0,
    currentRetail: parseFloat(item.marketValue) || 0,
  };
}

function _buildPriceHistorySection(chartCtx) {
  if (chartCtx.dailySpotEntries.length &lt; 2) return null;
  const chartSection = _section('Price History');
  const rangeBar = _buildChartRangeBar(chartSection, chartCtx);
  chartSection.appendChild(rangeBar);
  const chartContainer = _el('div', 'view-chart-container');
  const canvas = document.createElement('canvas');
  canvas.id = 'viewPriceHistoryChart';
  canvas._chartData = {
    spotEntries: chartCtx.dailySpotEntries,
    retailEntries: chartCtx.retailEntries,
    purchasePerUnit: chartCtx.purchasePerUnit,
    meltFactor: chartCtx.meltFactor,
    purchaseDate: chartCtx.purchaseDate,
    currentRetail: chartCtx.currentRetail,
  };
  chartContainer.appendChild(canvas);
  chartSection.appendChild(chartContainer);
  return chartSection;
}

function _buildChartRangeBar(chartSection, chartCtx) {
  const rangeBar = _el('div', 'view-chart-range-bar');
  const dateRange = _buildChartDateRangePicker(rangeBar, chartSection, chartCtx);
  _VIEW_CHART_RANGES.forEach((days, i) => {
    if (days === -1 &amp;&amp; !chartCtx.purchaseDate) return;
    const pill = _el('button', 'view-chart-range-pill');
    pill.type = 'button';
    pill.textContent = _VIEW_CHART_RANGE_LABELS[i];
    pill.dataset.days = String(days);
    const isDefaultPill = _VIEW_CHART_DEFAULT_RANGE === -1 ? (chartCtx.purchaseDate ? days === -1 : days === 30) : days === _VIEW_CHART_DEFAULT_RANGE;
    if (isDefaultPill) pill.classList.add('active');
    pill.addEventListener('click', async () => {
      rangeBar.querySelectorAll('.view-chart-range-pill').forEach(p => p.classList.remove('active'));
      pill.classList.add('active');
      await _onChartRangePillClick(days, dateRange, chartSection, chartCtx);
    });
    rangeBar.appendChild(pill);
  });
  rangeBar.appendChild(dateRange.wrap);
  return rangeBar;
}

function _buildChartDateRangePicker(rangeBar, chartSection, chartCtx) {
  const wrap = _el('div', 'view-chart-date-range');
  const fromInput = document.createElement('input');
  fromInput.type = 'date';
  fromInput.className = 'view-chart-date-input';
  fromInput.title = 'From date';
  const toInput = document.createElement('input');
  toInput.type = 'date';
  toInput.className = 'view-chart-date-input';
  toInput.title = 'To date';
  const todayStr = new Date().toISOString().slice(0, 10);
  fromInput.max = todayStr;
  toInput.max = todayStr;
  const dateSep = _el('span', 'view-chart-date-sep');
  dateSep.textContent = '\u2014';
  wrap.appendChild(fromInput);
  wrap.appendChild(dateSep);
  wrap.appendChild(toInput);
  const onDateChange = async () => {
    rangeBar.querySelectorAll('.view-chart-range-pill').forEach(p => p.classList.remove('active'));
    if (fromInput.value) toInput.min = fromInput.value; else toInput.min = '';
    if (toInput.value) fromInput.max = toInput.value; else fromInput.max = todayStr;
    const fromTs = fromInput.value ? new Date(fromInput.value + 'T00:00:00').getTime() : 0;
    const toTs = toInput.value ? new Date(toInput.value + 'T23:59:59').getTime() : 0;
    if (fromTs &lt;= 0 &amp;&amp; toTs &lt;= 0) return;
    const canvas = chartSection.querySelector('#viewPriceHistoryChart');
    if (!canvas) return;
    try {
      const fullSpot = await _fetchHistoricalSpotData(chartCtx.metalName, 0, fromTs, toTs);
      _createPriceHistoryChart(canvas, fullSpot, chartCtx.retailEntries, chartCtx.purchasePerUnit, chartCtx.meltFactor, 0, chartCtx.purchaseDate, chartCtx.currentRetail, fromTs, toTs);
    } catch (err) {
      console.error('Custom date range fetch failed:', err);
      _createPriceHistoryChart(canvas, [], chartCtx.retailEntries, chartCtx.purchasePerUnit, chartCtx.meltFactor, 0, chartCtx.purchaseDate, chartCtx.currentRetail, fromTs, toTs);
    }
  };
  fromInput.addEventListener('change', onDateChange);
  toInput.addEventListener('change', onDateChange);
  return { wrap, fromInput, toInput, todayStr };
}

async function _onChartRangePillClick(days, dateRange, chartSection, chartCtx) {
  dateRange.fromInput.value = '';
  dateRange.toInput.value = '';
  dateRange.fromInput.max = dateRange.todayStr;
  dateRange.toInput.min = '';
  const canvas = chartSection.querySelector('#viewPriceHistoryChart');
  if (!canvas) return;
  const effectiveDays = days === -1 &amp;&amp; chartCtx.purchaseDate > 0
    ? Math.max(1, Math.ceil((Date.now() - chartCtx.purchaseDate) / 86400000))
    : days;
  if (effectiveDays === 0 || effectiveDays > 180) {
    try {
      const fullSpot = await _fetchHistoricalSpotData(chartCtx.metalName, effectiveDays);
      _createPriceHistoryChart(canvas, fullSpot, chartCtx.retailEntries, chartCtx.purchasePerUnit, chartCtx.meltFactor, effectiveDays, chartCtx.purchaseDate, chartCtx.currentRetail);
    } catch (err) {
      console.error('Range pill fetch failed:', err);
      _createPriceHistoryChart(canvas, chartCtx.dailySpotEntries, chartCtx.retailEntries, chartCtx.purchasePerUnit, chartCtx.meltFactor, effectiveDays, chartCtx.purchaseDate, chartCtx.currentRetail);
    }
    return;
  }
  _createPriceHistoryChart(canvas, chartCtx.dailySpotEntries, chartCtx.retailEntries, chartCtx.purchasePerUnit, chartCtx.meltFactor, effectiveDays, chartCtx.purchaseDate, chartCtx.currentRetail);
}

function _buildGradingSection(item) {
  if (!item.grade &amp;&amp; !item.gradingAuthority &amp;&amp; !item.certNumber) return null;
  const gradeSection = _section('Grading');
  const gradeGrid = _el('div', 'view-detail-grid three-col');
  _addDetail(gradeGrid, 'Grade', item.grade || '—');
  _addDetail(gradeGrid, 'Authority', item.gradingAuthority || '—');
  const certItem = _buildGradingCertItem(item);
  if (certItem) gradeGrid.appendChild(certItem); else _addDetail(gradeGrid, 'Cert #', '—');
  gradeSection.appendChild(gradeGrid);
  return gradeSection;
}

function _buildGradingCertItem(item) {
  if (!item.certNumber) return null;
  const certItem = _detailItem('Cert #', item.certNumber);
  _attachGradingCertLink(certItem, item);
  const valEl = certItem.querySelector('.view-detail-value');
  if (!valEl) return certItem;
  const inlineVerify = _buildPcgsVerifyControl(item, item.gradingAuthority || '', item.certNumber, item.pcgsVerified === true, true);
  if (inlineVerify) valEl.appendChild(inlineVerify);
  return certItem;
}

function _attachGradingCertLink(certItem, item) {
  if (!item.gradingAuthority || typeof CERT_LOOKUP_URLS === 'undefined' || !CERT_LOOKUP_URLS[item.gradingAuthority]) return;
  const url = CERT_LOOKUP_URLS[item.gradingAuthority]
    .replace(/{certNumber}/g, encodeURIComponent(item.certNumber))
    .replace(/{grade}/g, encodeURIComponent(item.grade || ''));
  const valEl = certItem.querySelector('.view-detail-value');
  if (!valEl) return;
  valEl.textContent = '';
  const link = document.createElement('a');
  link.href = url;
  link.target = '_blank';
  link.rel = 'noopener noreferrer';
  link.textContent = item.certNumber;
  link.style.color = 'var(--primary)';
  link.title = `Verify on ${item.gradingAuthority}`;
  valEl.appendChild(link);
}

function _buildNumistaPlaceholderSection() {
  const numistaPlaceholder = _el('div', '');
  numistaPlaceholder.id = 'viewNumistaSection';
  return numistaPlaceholder;
}

function _buildTagsSection(item) {
  if (typeof buildTagSection !== 'function') return null;
  return buildTagSection(item.uuid, [], () => {
    if (typeof renderActiveFilters === 'function') renderActiveFilters();
  });
}

function _buildNotesSection(item) {
  if (!item.notes) return null;
  const notesSection = _section('Notes');
  const noteText = _el('div', 'view-notes-text');
  noteText.textContent = item.notes;
  notesSection.appendChild(noteText);
  return notesSection;
}

function _appendSectionsInConfiguredOrder(frag, sectionBuilders) {
  const sectionConfig = typeof getViewModalSectionConfig === 'function' ? getViewModalSectionConfig() : VIEW_MODAL_SECTION_DEFAULTS;
  for (const sec of sectionConfig) {
    if (!sec.enabled) continue;
    const builder = sectionBuilders[sec.id];
    if (!builder) continue;
    const el = builder();
    if (el) frag.appendChild(el);
  }
}

function _renderHeaderActions(item, index) {
  const headerActions = document.getElementById('viewHeaderActions');
  if (!headerActions) return;
  headerActions.textContent = '';
  const ebayBtn = document.createElement('button');
  ebayBtn.className = 'view-ebay-btn';
  ebayBtn.innerHTML = '&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" aria-hidden="true" style="fill:currentColor;margin-right:4px;vertical-align:-2px;">&lt;circle cx="10.5" cy="10.5" r="6" fill="none" stroke="currentColor" stroke-width="2.5"/>&lt;line x1="15" y1="15" x2="21" y2="21" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>&lt;/svg>eBay';
  ebayBtn.title = 'Search eBay for this item';
  ebayBtn.addEventListener('click', () => {
    const searchTerm = (item.metal || '') + (item.year ? ' ' + item.year : '') + ' ' + (item.name || '');
    if (typeof openEbayBuySearch === 'function') openEbayBuySearch(searchTerm);
    else if (typeof openEbaySoldSearch === 'function') openEbaySoldSearch(searchTerm);
  });
  const editBtn = document.createElement('button');
  editBtn.className = 'view-edit-btn';
  editBtn.textContent = 'Edit';
  editBtn.addEventListener('click', () => {
    closeViewModal();
    if (typeof editItem === 'function') editItem(index);
  });
  const closeBtn = document.createElement('button');
  closeBtn.className = 'view-close-btn';
  closeBtn.textContent = 'Close';
  closeBtn.addEventListener('click', closeViewModal);
  headerActions.appendChild(ebayBtn);
  headerActions.appendChild(editBtn);
  headerActions.appendChild(closeBtn);
}

/**
 * Build the full view modal body as a DocumentFragment.
 * Sections are built eagerly then appended in user-configured order.
 * @param {Object} item - Inventory item
 * @param {number} index - Item index for edit button
 * @returns {DocumentFragment}
 */
function buildViewContent(item, index) {
  const frag = document.createDocumentFragment();
  const metrics = _getViewMetrics(item);
  _renderHeaderMeta(item, metrics);

  const chartCtx = _getPriceHistoryContext(item, metrics);
  const sectionBuilders = {
    images:       () => _buildImageSection(item, metrics),
    priceHistory: () => _buildPriceHistorySection(chartCtx),
    valuation:    () => _buildValuationSection(item, metrics),
    inventory:    () => _buildInventorySection(item, metrics),
    grading:      () => _buildGradingSection(item),
    numista:      () => _buildNumistaPlaceholderSection(),
    tags:         () => _buildTagsSection(item),
    notes:        () => _buildNotesSection(item),
  };

  _appendSectionsInConfiguredOrder(frag, sectionBuilders);
  _renderHeaderActions(item, index);
  return frag;
}

// ---------------------------------------------------------------------------
// Async loaders
// ---------------------------------------------------------------------------

/**
 * Load coin images from IndexedDB cache → CDN URL fallback.
 * @param {Object} item
 * @param {HTMLElement} container
 * @returns {Promise&lt;{loaded: boolean, source: string|null}>}
 */
async function loadViewImages(item, container) {
  const section = container.querySelector('#viewImageSection');
  if (!section) return { loaded: false, source: null };

  const slots = section.querySelectorAll('.view-image-slot');
  const obvSlot = slots[0];
  const revSlot = slots[1];

  if (!window.imageCache?.isAvailable()) {
    // Fallback: CDN URLs stored on the item
    const validObv = ImageCache.isValidImageUrl(item.obverseImageUrl);
    const validRev = ImageCache.isValidImageUrl(item.reverseImageUrl);
    if (validObv) _setSlotImage(obvSlot, item.obverseImageUrl);
    if (validRev) _setSlotImage(revSlot, item.reverseImageUrl);
    return { loaded: validObv || validRev, source: 'cdn' };
  }

  // Use the resolution cascade (user → pattern → numista)
  const resolved = await imageCache.resolveImageForItem(item);
  if (resolved) {
    let obvUrl, revUrl;
    if (resolved.source === 'user') {
      obvUrl = await imageCache.getUserImageUrl(resolved.catalogId, 'obverse');
      revUrl = await imageCache.getUserImageUrl(resolved.catalogId, 'reverse');
    } else if (resolved.source === 'pattern') {
      obvUrl = await imageCache.getPatternImageUrl(resolved.catalogId, 'obverse');
      revUrl = await imageCache.getPatternImageUrl(resolved.catalogId, 'reverse');
    } else {
      obvUrl = await imageCache.getImageUrl(resolved.catalogId, 'obverse');
      revUrl = await imageCache.getImageUrl(resolved.catalogId, 'reverse');
    }

    if (obvUrl) { _viewModalObjectUrls.push(obvUrl); _setSlotImage(obvSlot, obvUrl); }
    if (revUrl) { _viewModalObjectUrls.push(revUrl); _setSlotImage(revSlot, revUrl); }
    if (obvUrl || revUrl) return { loaded: true, source: resolved.source };
  }

  // Final fallback: CDN URLs stored on the item (validate to skip corrupted URLs)
  const validObv = ImageCache.isValidImageUrl(item.obverseImageUrl);
  const validRev = ImageCache.isValidImageUrl(item.reverseImageUrl);
  if (validObv) _setSlotImage(obvSlot, item.obverseImageUrl);
  if (validRev) _setSlotImage(revSlot, item.reverseImageUrl);
  return { loaded: validObv || validRev, source: (validObv || validRev) ? 'cdn' : null };
}

/**
 * Load Numista metadata from IndexedDB cache or pre-fetched API result, render enrichment section.
 * @param {Object} item
 * @param {HTMLElement} container
 * @param {Object|null} apiResult - Pre-fetched Numista API result (avoids duplicate call)
 */
async function loadViewNumistaData(item, container, apiResult) {
  const catalogId = item.numistaId || '';
  if (!catalogId) return;

  const placeholder = container.querySelector('#viewNumistaSection');
  if (!placeholder) return;

  let meta = null;

  // Check cache
  if (window.imageCache?.isAvailable()) {
    meta = await imageCache.getMetadata(catalogId);

    // Stale check
    if (meta &amp;&amp; (Date.now() - (meta.cachedAt || 0)) > VIEW_METADATA_TTL) {
      meta = null; // Force refresh
    }
  }

  // Use pre-fetched API result if no cache hit
  if (!meta &amp;&amp; apiResult) {
    meta = _extractMetadata(apiResult);

    // Cache for next time
    if (window.imageCache?.isAvailable()) {
      imageCache.cacheMetadata(catalogId, apiResult).catch(() => {});
    }
  }

  if (!meta) return;

  // Load user's field visibility config
  const cfg = typeof getNumistaViewFieldConfig === 'function'
    ? getNumistaViewFieldConfig()
    : {};

  // Update image frame shape based on Numista data if not already rectangular
  if (meta.shape) {
    const imgSection = container.querySelector('#viewImageSection');
    const shapeStr = meta.shape.toLowerCase();
    const isNonRound = shapeStr !== 'round' &amp;&amp; shapeStr !== 'circular';
    if (isNonRound &amp;&amp; imgSection &amp;&amp; !imgSection.classList.contains('view-shape-rect')) {
      imgSection.classList.add('view-shape-rect');
    }
  }

  // Build Numista section
  const section = _el('div', 'view-numista-section');

  const badge = _el('span', 'view-numista-badge');
  badge.textContent = 'Numista Data';
  section.appendChild(badge);

  const grid = _el('div', 'view-detail-grid');

  if (cfg.denomination !== false &amp;&amp; meta.denomination) _addDetail(grid, 'Denomination', meta.denomination);
  if (cfg.shape !== false &amp;&amp; meta.shape) _addDetail(grid, 'Shape', meta.shape);
  if (cfg.diameter !== false &amp;&amp; meta.diameter) _addDetail(grid, 'Diameter', `${meta.diameter}mm`);
  if (cfg.thickness !== false &amp;&amp; meta.thickness) _addDetail(grid, 'Thickness', `${meta.thickness}mm`);
  if (cfg.orientation !== false &amp;&amp; meta.orientation) _addDetail(grid, 'Orientation', meta.orientation);
  if (cfg.composition !== false &amp;&amp; meta.composition) _addDetail(grid, 'Composition', meta.composition);
  if (cfg.country !== false &amp;&amp; meta.country) _addDetail(grid, 'Country', meta.country);
  if (cfg.technique !== false &amp;&amp; meta.technique) _addDetail(grid, 'Technique', meta.technique);

  if (cfg.references !== false &amp;&amp; meta.kmReferences &amp;&amp; meta.kmReferences.length > 0) {
    _addDetail(grid, 'References', meta.kmReferences.join(', '));
  }

  section.appendChild(grid);

  // Edge description on its own full-width line (can be long)
  if (cfg.edge !== false &amp;&amp; meta.edgeDesc) {
    const edgeGrid = _el('div', 'view-detail-grid');
    const edgeItem = _detailItem('Edge', meta.edgeDesc);
    edgeItem.classList.add('full-width');
    edgeGrid.appendChild(edgeItem);
    section.appendChild(edgeGrid);
  }

  // Set obverse/reverse descriptions as tooltips on the image slots
  if (cfg.imageTooltips !== false &amp;&amp; (meta.obverseDesc || meta.reverseDesc)) {
    const imgSection = container.querySelector('#viewImageSection');
    if (imgSection) {
      const slots = imgSection.querySelectorAll('.view-image-slot');
      if (meta.obverseDesc &amp;&amp; slots[0]) {
        slots[0].title = `Obverse: ${meta.obverseDesc}`;
      }
      if (meta.reverseDesc &amp;&amp; slots[1]) {
        slots[1].title = `Reverse: ${meta.reverseDesc}`;
      }
    }
  }

  // Tags
  if (cfg.tags !== false &amp;&amp; meta.tags &amp;&amp; meta.tags.length > 0) {
    const tagGrid = _el('div', 'view-detail-grid');
    const tagItem = _detailItem('Tags', meta.tags.join(', '));
    tagItem.classList.add('full-width');
    tagGrid.appendChild(tagItem);
    section.appendChild(tagGrid);
  }

  // Commemorative
  if (cfg.commemorative !== false &amp;&amp; meta.commemorative &amp;&amp; meta.commemorativeDesc) {
    const commGrid = _el('div', 'view-detail-grid');
    const commItem = _detailItem('Commemorative', meta.commemorativeDesc);
    commItem.classList.add('full-width');
    commGrid.appendChild(commItem);
    section.appendChild(commGrid);
  }

  // Rarity index
  if (cfg.rarity !== false &amp;&amp; meta.rarityIndex > 0) {
    const rarityRow = _el('div', 'view-detail-item');

    const lbl = _el('span', 'view-detail-label');
    lbl.textContent = 'Rarity';
    rarityRow.appendChild(lbl);

    const bar = _el('div', 'view-rarity-bar');

    const track = _el('div', 'view-rarity-track');
    const fill = _el('div', 'view-rarity-fill');
    fill.style.width = `${Math.min(meta.rarityIndex, 100)}%`;
    track.appendChild(fill);
    bar.appendChild(track);

    const score = _el('span', 'view-rarity-score');
    score.textContent = String(meta.rarityIndex);
    bar.appendChild(score);

    rarityRow.appendChild(bar);
    section.appendChild(rarityRow);
  }

  // Mintage by year (show first few)
  if (cfg.mintage !== false &amp;&amp; meta.mintageByYear &amp;&amp; meta.mintageByYear.length > 0) {
    const mintGrid = _el('div', 'view-detail-grid');
    const mintItem = _el('div', 'view-detail-item full-width');
    const mintLabel = _el('span', 'view-detail-label');
    mintLabel.textContent = 'Mintage';
    mintItem.appendChild(mintLabel);

    const mintVal = _el('span', 'view-detail-value');
    const entries = meta.mintageByYear.slice(0, 5);
    mintVal.textContent = entries.map(e => {
      const m = typeof e.mintage === 'number' ? e.mintage.toLocaleString() : e.mintage;
      return `${e.year}: ${m}${e.remark ? ` (${e.remark})` : ''}`;
    }).join(' | ');
    if (meta.mintageByYear.length > 5) mintVal.textContent += ' ...';
    mintItem.appendChild(mintVal);
    mintGrid.appendChild(mintItem);
    section.appendChild(mintGrid);
  }

  placeholder.replaceWith(section);

  // STAK-126: Auto-apply Numista tags to the item's tag store and refresh
  // the tags section so it shows Numista tags with proper visual distinction
  if (meta.tags &amp;&amp; meta.tags.length > 0 &amp;&amp; item.uuid &amp;&amp; typeof applyNumistaTags === 'function') {
    applyNumistaTags(item.uuid, meta.tags);
    // Rebuild the tags section in the modal with Numista tag info
    const tagsSectionEl = container.querySelector('#viewTagsSection');
    if (tagsSectionEl &amp;&amp; typeof buildTagSection === 'function') {
      const newTagsSection = buildTagSection(item.uuid, meta.tags, () => {
        if (typeof renderActiveFilters === 'function') renderActiveFilters();
      });
      tagsSectionEl.replaceWith(newTagsSection);
    }
  }
}

// ---------------------------------------------------------------------------
// API helpers (private)
// ---------------------------------------------------------------------------

/**
 * Fetch a Numista item by catalogId. Returns the normalized result or null.
 * @param {string} catalogId
 * @returns {Promise&lt;Object|null>}
 */
async function _fetchNumistaResult(catalogId) {
  if (!catalogId || typeof catalogAPI === 'undefined') return null;
  try {
    return await catalogAPI.lookupItem(catalogId);
  } catch {
    return null;
  }
}

/**
 * Extract metadata fields from a Numista API result.
 * @param {Object} result
 * @returns {Object}
 */
function _extractMetadata(result) {
  return {
    title: result.name || '',
    country: result.country || '',
    denomination: result.denomination || '',
    diameter: result.diameter || result.size || 0,
    thickness: result.thickness || 0,
    weight: result.weight || 0,
    shape: result.shape || '',
    composition: result.composition || result.metal || '',
    orientation: result.orientation || '',
    commemorative: !!result.commemorative,
    commemorativeDesc: result.commemorativeDesc || '',
    rarityIndex: result.rarityIndex || 0,
    kmReferences: result.kmReferences || [],
    mintageByYear: result.mintageByYear || [],
    technique: result.technique || '',
    tags: result.tags || [],
    obverseDesc: result.obverseDesc || '',
    reverseDesc: result.reverseDesc || '',
    edgeDesc: result.edgeDesc || '',
  };
}

// ---------------------------------------------------------------------------
// External popup (private)
// ---------------------------------------------------------------------------

/**
 * Open a URL in a 1250px popup window.
 * Most external sites block iframe embedding (X-Frame-Options), so we use window.open().
 * @param {string} url
 * @param {string} [name='_blank'] - Window name for reuse
 */
function _openExternalPopup(url, name) {
  const popup = window.open(
    url,
    name || '_blank',
    'width=1250,height=800,scrollbars=yes,resizable=yes,toolbar=no,location=no,menubar=no,status=no'
  );
  if (!popup) {
    // Popup blocked — let user know
    alert(`Popup blocked! Please allow popups or manually visit:\n${url}`);
  } else {
    popup.focus();
  }
}

// ---------------------------------------------------------------------------
// Color helpers (private)
// ---------------------------------------------------------------------------

/**
 * Parse a color string (hex #rrggbb or rgb(r,g,b)) into [r, g, b].
 * @param {string} color
 * @returns {number[]} [r, g, b] in 0-255
 */
function _parseColor(color) {
  if (!color) return [99, 102, 241]; // fallback indigo
  const s = color.trim();
  // Handle #rrggbb / #rgb
  if (s.startsWith('#')) {
    let hex = s.slice(1);
    if (hex.length === 3) hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];
    return [parseInt(hex.slice(0,2),16), parseInt(hex.slice(2,4),16), parseInt(hex.slice(4,6),16)];
  }
  // Handle rgb(r, g, b)
  const m = s.match(/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/);
  if (m) return [parseInt(m[1]), parseInt(m[2]), parseInt(m[3])];
  return [99, 102, 241];
}

/**
 * Darken a hex/rgb color by a factor (0–1). 0 = no change, 1 = black.
 * @param {string} color - Hex or rgb() string
 * @param {number} amount - Darkening factor
 * @returns {string} Hex color
 */
function _darkenColor(color, amount) {
  const [r, g, b] = _parseColor(color);
  const f = 1 - Math.min(Math.max(amount, 0), 1);
  const toHex = v => Math.round(v * f).toString(16).padStart(2, '0');
  return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
}

/**
 * Check if a color is light based on relative luminance.
 * @param {string} color - Hex or rgb() string
 * @returns {boolean} True if light (needs dark text)
 */
function _isLightColor(color) {
  const [r, g, b] = _parseColor(color);
  const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
  return luminance > 0.5;
}

// ---------------------------------------------------------------------------
// Historical spot data fetcher (private, self-contained)
// ---------------------------------------------------------------------------

/** @type {Map&lt;number, Array>} Year-file cache shared with spot.js when available */
const _viewYearCache = new Map();

/** @type {Map&lt;number, Promise&lt;Array>>} In-flight fetch promises to deduplicate concurrent requests */
const _viewYearFetchPromises = new Map();

/**
 * Fetch a single year file with three-tier fallback (fetch → XHR → remote).
 * Reuses spot.js cache/fetcher when available; falls back to own implementation.
 * Deduplicates concurrent fetches for the same year.
 * @param {number} year
 * @returns {Promise&lt;Array>}
 */
function _fetchYearFile(year) {
  // Prefer spot.js fetcher (shares its dedup + cache)
  if (typeof window.fetchYearFile === 'function') {
    return window.fetchYearFile(year);
  }

  // Self-contained fallback
  // Already cached — return immediately
  if (_viewYearCache.has(year)) return Promise.resolve(_viewYearCache.get(year));

  // Already in-flight — return shared promise
  if (_viewYearFetchPromises.has(year)) {
    return _viewYearFetchPromises.get(year);
  }

  const filename = `spot-history-${year}.json`;
  const localUrl = `data/${filename}`;
  const remoteUrl = `https://staktrakr.com/data/${filename}`;

  const promise = fetch(localUrl)
    .then(res => { if (!res.ok) throw new Error(`HTTP ${res.status}`); return res.json(); })
    .catch(() => new Promise((resolve, reject) => {
      const xhr = new XMLHttpRequest();
      xhr.open('GET', localUrl, true);
      xhr.responseType = 'json';
      xhr.onload = () => (xhr.status === 200 || (xhr.status === 0 &amp;&amp; xhr.response)) ? resolve(xhr.response) : reject(new Error(`XHR ${xhr.status}`));
      xhr.onerror = () => reject(new Error('XHR error'));
      xhr.send();
    }))
    .catch(() => fetch(remoteUrl).then(res => { if (!res.ok) throw new Error(`HTTP ${res.status}`); return res.json(); }))
    .then(entries => {
      const valid = Array.isArray(entries) ? entries.filter(e => e &amp;&amp; typeof e.spot === 'number' &amp;&amp; e.metal &amp;&amp; e.timestamp) : [];
      _viewYearCache.set(year, valid);
      return valid;
    })
    .catch(() => { _viewYearCache.set(year, []); return []; })
    .finally(() => {
      _viewYearFetchPromises.delete(year);
    });

  // Store promise in Map immediately to ensure proper cleanup
  _viewYearFetchPromises.set(year, promise);
  return promise;
}

/**
 * Fetch full historical spot data for a metal by loading year files.
 * Merges fetched year-file data with live spotHistory, deduplicates by day
 * (live data wins over seed). Returns sorted {ts, spot} entries.
 *
 * For ranges &lt;= 180 days, just returns the in-memory spotHistory slice (no fetch).
 * For longer ranges (including "All"), async-fetches year files back to 1968.
 *
 * @param {string} metalName - Metal name ('Silver', 'Gold', etc.)
 * @param {number} days - Number of days (0 = all available data)
 * @param {number} [fromTs=0] - Custom range start (0 = unbounded)
 * @param {number} [toTs=0] - Custom range end (0 = unbounded)
 * @returns {Promise&lt;Array&lt;{ts:number, spot:number}>>} Sorted daily spot entries
 */
async function _fetchHistoricalSpotData(metalName, days, fromTs, toTs) {
  fromTs = fromTs || 0;
  toTs = toTs || 0;

  // Calculate which years to fetch
  let startYear;
  if (fromTs > 0) {
    startYear = new Date(fromTs).getFullYear();
  } else if (days > 0 &amp;&amp; days &lt;= 180) {
    // Short range — in-memory spotHistory is sufficient
    const liveEntries = (typeof spotHistory !== 'undefined' ? spotHistory : [])
      .filter(e => e.metal === metalName)
      .map(e => ({ ts: new Date(e.timestamp).getTime(), spot: e.spot }));
    liveEntries.sort((a, b) => a.ts - b.ts);
    const byDay = new Map();
    for (const e of liveEntries) byDay.set(new Date(e.ts).toISOString().slice(0, 10), e);
    return [...byDay.values()].sort((a, b) => a.ts - b.ts);
  } else {
    // "All" — go back to 1968 (earliest seed data)
    startYear = 1968;
  }

  const endYear = new Date().getFullYear();
  const years = [];
  for (let y = startYear; y &lt;= endYear; y++) years.push(y);

  // Fetch all needed year files in parallel
  const yearArrays = await Promise.all(years.map(_fetchYearFile));
  const allHistorical = yearArrays.flat();

  // Merge historical + live spotHistory
  const live = typeof spotHistory !== 'undefined' ? spotHistory : [];
  const combined = [...allHistorical, ...live]
    .filter(e => e.metal === metalName)
    .map(e => ({ ts: new Date(e.timestamp).getTime(), spot: e.spot }));

  // Sort chronologically
  combined.sort((a, b) => a.ts - b.ts);

  // Dedup to one entry per day (later entries win — live data appended after seed)
  const byDay = new Map();
  for (const e of combined) {
    byDay.set(new Date(e.ts).toISOString().slice(0, 10), e);
  }

  return [...byDay.values()].sort((a, b) => a.ts - b.ts);
}

// ---------------------------------------------------------------------------
// Price history chart (private)
// ---------------------------------------------------------------------------

/**
 * Create a Chart.js line chart showing price history for the viewed item.
 * Primary: melt value derived from spotHistory (dense daily data).
 * Secondary: retail value anchored from purchase date/price to current market value,
 *   with sparse itemPriceHistory snapshots in between.
 * Purchase price shown as a flat dashed reference line.
 *
 * @param {HTMLCanvasElement} canvas
 * @param {Array&lt;{ts:number, spot:number}>} allSpotEntries - Daily spot prices for this metal
 * @param {Array&lt;{ts:number, retail:number}>} allRetailEntries - Sparse retail value snapshots
 * @param {number} purchasePerUnit - Original purchase price per unit
 * @param {number} meltFactor - weightOz * qty * purity (melt = spot * meltFactor)
 * @param {number} [days=0] - Number of days to show (0 = all)
 * @param {number} [purchaseDate=0] - Purchase date timestamp (anchor start for retail line)
 * @param {number} [currentRetail=0] - Current market/retail value (anchor end for retail line)
 * @param {number} [fromTs=0] - Custom range start timestamp (0 = unbounded)
 * @param {number} [toTs=0] - Custom range end timestamp (0 = unbounded)
 */
function _createPriceHistoryChart(canvas, allSpotEntries, allRetailEntries, purchasePerUnit, meltFactor, days, purchaseDate, currentRetail, fromTs, toTs) {
  if (typeof Chart === 'undefined') return;

  // Destroy any previous instance
  if (_viewModalChartInstance) {
    _viewModalChartInstance.destroy();
    _viewModalChartInstance = null;
  }

  // Filter spot entries by time range
  fromTs = fromTs || 0;
  toTs = toTs || 0;
  const cutoff = days > 0 ? Date.now() - (days * 86400000) : 0;
  let spotEntries;
  if (fromTs > 0 || toTs > 0) {
    // Custom date range mode
    spotEntries = allSpotEntries.filter(e =>
      (fromTs &lt;= 0 || e.ts >= fromTs) &amp;&amp; (toTs &lt;= 0 || e.ts &lt;= toTs)
    );
  } else {
    spotEntries = cutoff > 0 ? allSpotEntries.filter(e => e.ts >= cutoff) : [...allSpotEntries];
  }

  // If "All" range or custom range and purchase date is before earliest spot data,
  // prepend a synthetic entry so the chart extends back to purchase date
  const isAllOrCustom = days === 0 || fromTs > 0 || toTs > 0;
  if (isAllOrCustom &amp;&amp; purchaseDate > 0 &amp;&amp; spotEntries.length > 0 &amp;&amp; purchaseDate &lt; spotEntries[0].ts) {
    spotEntries.unshift({ ts: purchaseDate, spot: spotEntries[0].spot });
  }

  // Show fallback message if insufficient data for selected range
  const container = canvas.parentElement;
  const existingMsg = container.querySelector('.view-chart-no-data');
  if (existingMsg) existingMsg.remove();
  canvas.style.display = '';

  if (spotEntries.length &lt; 2) {
    canvas.style.display = 'none';
    const msg = _el('div', 'view-chart-no-data');
    msg.textContent = 'Not enough data for this range';
    container.appendChild(msg);
    return;
  }

  // Build labels + melt data from spot entries
  // Adaptive formatting: decade spans → year only, multi-year → two-line [month, year],
  // single-year → month + day
  const firstYear = new Date(spotEntries[0].ts).getFullYear();
  const lastYear = new Date(spotEntries[spotEntries.length - 1].ts).getFullYear();
  const yearSpan = lastYear - firstYear;
  const labels = spotEntries.map(e => {
    const d = new Date(e.ts);
    if (yearSpan > 10) {
      // Decade+ ranges: compact "Jan '24" or just "'24"
      return d.toLocaleDateString(undefined, { year: '2-digit', month: 'short' });
    }
    if (yearSpan >= 1) {
      // 1–10 year ranges: two-line label [month day, year]
      return [
        d.toLocaleDateString(undefined, { month: 'short', day: 'numeric' }),
        String(d.getFullYear())
      ];
    }
    return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
  });
  const meltData = spotEntries.map(e => parseFloat((e.spot * meltFactor).toFixed(2)));
  const purchaseLine = spotEntries.map(() => purchasePerUnit);

  // Build retail data: anchored from purchase date to present, with sparse midpoints.
  // Uses index-based snapping to find the nearest spot entry for each retail point,
  // since anchor dates may not have an exact-match spot entry on that calendar day.
  const retailData = new Array(spotEntries.length).fill(null);

  // Helper: find the index of the spot entry nearest to a given timestamp
  const _nearestSpotIdx = (ts) => {
    let best = 0;
    let bestDist = Math.abs(spotEntries[0].ts - ts);
    for (let i = 1; i &lt; spotEntries.length; i++) {
      const dist = Math.abs(spotEntries[i].ts - ts);
      if (dist &lt; bestDist) { best = i; bestDist = dist; }
    }
    return best;
  };

  // Anchor start: purchase price at the leftmost chart position.
  // If purchase date is within the visible range, snap to that day.
  // If purchase date is before the range, pin to index 0 so the
  // retail line always starts with "what you paid" as a reference.
  if (purchaseDate > 0) {
    if (purchaseDate >= spotEntries[0].ts &amp;&amp;
        purchaseDate &lt;= spotEntries[spotEntries.length - 1].ts) {
      const idx = _nearestSpotIdx(purchaseDate);
      retailData[idx] = purchasePerUnit;
    } else if (purchaseDate &lt; spotEntries[0].ts) {
      retailData[0] = purchasePerUnit;
    }
  }

  // Middle: sparse itemPriceHistory retail values snapped to nearest spot day
  for (const re of allRetailEntries) {
    if (cutoff > 0 &amp;&amp; re.ts &lt; cutoff) continue;
    if (fromTs > 0 &amp;&amp; re.ts &lt; fromTs) continue;
    if (toTs > 0 &amp;&amp; re.ts > toTs) continue;
    const idx = _nearestSpotIdx(re.ts);
    retailData[idx] = re.retail;
  }

  // Anchor end: current market value on the last spot entry (≈ today)
  if (currentRetail > 0) {
    retailData[spotEntries.length - 1] = currentRetail;
  }

  const hasRetail = retailData.some(v => v !== null);

  const showPoints = spotEntries.length &lt;= 30;

  const textColor = typeof getChartTextColor === 'function' ? getChartTextColor() : '#1e293b';
  const bgColor = typeof getChartBackgroundColor === 'function' ? getChartBackgroundColor() : '#f8fafc';

  // Dataset order: purchase (bottom) → melt (middle) → retail (top)
  // Layered fills create visual bands showing cost basis, intrinsic value, and market premium
  const datasets = [
    {
      label: 'Purchase Price',
      data: purchaseLine,
      borderColor: '#ef4444',
      backgroundColor: 'rgba(239, 68, 68, 0.06)',
      fill: 'origin',
      borderDash: [6, 3],
      tension: 0,
      pointRadius: 0,
      pointHoverRadius: 0,
      borderWidth: 1.5,
      order: 3,
    },
    {
      label: 'Melt Value',
      data: meltData,
      borderColor: '#10b981',
      backgroundColor: 'rgba(16, 185, 129, 0.12)',
      fill: 'origin',
      tension: 0.3,
      pointRadius: showPoints ? 3 : 0,
      pointHoverRadius: 5,
      borderWidth: 2,
      order: 2,
    },
    {
      label: 'Retail Value',
      data: retailData,
      borderColor: '#3b82f6',
      backgroundColor: 'rgba(59, 130, 246, 0.08)',
      fill: 'origin',
      tension: 0.3,
      spanGaps: true,
      pointRadius: 4,
      pointHoverRadius: 6,
      borderWidth: 2,
      hidden: !hasRetail,
      order: 1,
    },
  ];

  _viewModalChartInstance = new Chart(canvas, {
    type: 'line',
    data: { labels, datasets },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      animation: { duration: 400 },
      interaction: { mode: 'index', intersect: false },
      scales: {
        x: {
          ticks: {
            color: textColor,
            maxTicksLimit: 6,
            autoSkip: true,
            font: { size: 10 }
          },
          grid: { display: false }
        },
        y: {
          ticks: {
            color: textColor,
            font: { size: 10 },
            callback: function(value) {
              return typeof formatCurrency === 'function' ? formatCurrency(value) : '$' + value;
            }
          },
          grid: { color: 'rgba(128,128,128,0.1)' }
        }
      },
      plugins: {
        legend: {
          position: 'bottom',
          labels: {
            color: textColor,
            usePointStyle: true,
            pointStyle: 'line',
            padding: 12,
            font: { size: 10 }
          }
        },
        tooltip: {
          backgroundColor: bgColor,
          titleColor: textColor,
          bodyColor: textColor,
          borderColor: textColor,
          borderWidth: 1,
          callbacks: {
            label: function(ctx) {
              if (ctx.parsed.y === null) return null;
              const val = typeof formatCurrency === 'function' ? formatCurrency(ctx.parsed.y) : '$' + ctx.parsed.y;
              return `${ctx.dataset.label}: ${val}`;
            }
          }
        }
      }
    }
  });
}

// ---------------------------------------------------------------------------
// DOM helpers (private)
// ---------------------------------------------------------------------------

/** Create element with className */
function _el(tag, className) {
  const el = document.createElement(tag);
  if (className) el.className = className;
  return el;
}

/** Create a data section with title */
function _section(title) {
  const section = _el('div', 'view-detail-section');
  const h = _el('div', 'view-section-title');
  h.textContent = title;
  section.appendChild(h);
  return section;
}

/** Create a label/value detail item element */
function _detailItem(label, value, extraClass) {
  const item = _el('div', 'view-detail-item');
  const lbl = _el('span', 'view-detail-label');
  lbl.textContent = label;
  const val = _el('span', 'view-detail-value' + (extraClass ? ' ' + extraClass : ''));
  val.textContent = value;
  item.appendChild(lbl);
  item.appendChild(val);
  return item;
}

/** Add a detail item to a grid */
function _addDetail(grid, label, value, extraClass) {
  grid.appendChild(_detailItem(label, value, extraClass));
}

/** Create an image slot with placeholder */
function _imageSlot(side, label) {
  const slot = _el('div', 'view-image-slot');
  slot.dataset.side = side;

  const ph = _el('div', 'view-image-placeholder');
  ph.textContent = '\uD83E\uDE99'; // coin emoji
  slot.appendChild(ph);

  const lbl = _el('span', 'view-image-label');
  lbl.textContent = label;
  slot.appendChild(lbl);

  return slot;
}

/** Replace placeholder with actual image in a slot */
function _setSlotImage(slot, src) {
  if (!slot || !src) return;

  // If an image already exists, update its src (for override replacement)
  const existing = slot.querySelector('img');
  if (existing) {
    existing.src = src;
    existing.style.display = '';
    return;
  }

  // First time: replace placeholder with new img element
  const ph = slot.querySelector('.view-image-placeholder');
  if (!ph) return;

  const img = document.createElement('img');
  img.src = src;
  img.alt = slot.dataset.side || 'Coin';
  // Only use lazy loading for network URLs — blob URLs are already in memory
  // and lazy loading can prevent display in modals that just became visible
  if (!src.startsWith('blob:')) img.loading = 'lazy';
  img.onerror = () => { img.style.display = 'none'; };
  ph.replaceWith(img);
}

// ---------------------------------------------------------------------------
// Global exposure
// ---------------------------------------------------------------------------

// ESC key handler
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    const modal = document.getElementById('viewItemModal');
    if (modal &amp;&amp; modal.style.display !== 'none') {
      closeViewModal();
    }
  }
});

if (typeof window !== 'undefined') {
  window.showViewModal = showViewModal;
  window.closeViewModal = closeViewModal;
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CatalogAPI.html">CatalogAPI</a></li><li><a href="CatalogConfig.html">CatalogConfig</a></li><li><a href="CatalogManager.html">CatalogManager</a></li><li><a href="CatalogProvider.html">CatalogProvider</a></li><li><a href="FeatureFlags.html">FeatureFlags</a></li><li><a href="ImageCache.html">ImageCache</a></li><li><a href="ImageProcessor.html">ImageProcessor</a></li><li><a href="LocalProvider.html">LocalProvider</a></li><li><a href="NumistaCatalogProvider.html">NumistaCatalogProvider</a></li><li><a href="NumistaProvider.html">NumistaProvider</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ACK_DISMISSED_KEY">ACK_DISMISSED_KEY</a></li><li><a href="global.html#API_CACHE_KEY">API_CACHE_KEY</a></li><li><a href="global.html#API_KEY_STORAGE_KEY">API_KEY_STORAGE_KEY</a></li><li><a href="global.html#API_PROVIDERS">API_PROVIDERS</a></li><li><a href="global.html#APP_VERSION">APP_VERSION</a></li><li><a href="global.html#APP_VERSION_KEY">APP_VERSION_KEY</a></li><li><a href="global.html#AUTOCOMPLETE_CONFIG">AUTOCOMPLETE_CONFIG</a></li><li><a href="global.html#BRANDING_DOMAIN_OPTIONS">BRANDING_DOMAIN_OPTIONS</a></li><li><a href="global.html#BRANDING_DOMAIN_OVERRIDE">BRANDING_DOMAIN_OVERRIDE</a></li><li><a href="global.html#BRANDING_TITLE">BRANDING_TITLE</a></li><li><a href="global.html#CARD_STYLE_KEY">CARD_STYLE_KEY</a></li><li><a href="global.html#CATALOG_HISTORY_KEY">CATALOG_HISTORY_KEY</a></li><li><a href="global.html#CATALOG_MAP_KEY">CATALOG_MAP_KEY</a></li><li><a href="global.html#CERT_LOOKUP_URLS">CERT_LOOKUP_URLS</a></li><li><a href="global.html#CLOUD_PROVIDERS">CLOUD_PROVIDERS</a></li><li><a href="global.html#DEBUG">DEBUG</a></li><li><a href="global.html#DEFAULT_API_CACHE_DURATION">DEFAULT_API_CACHE_DURATION</a></li><li><a href="global.html#DEFAULT_API_QUOTA">DEFAULT_API_QUOTA</a></li><li><a href="global.html#DEFAULT_CURRENCY">DEFAULT_CURRENCY</a></li><li><a href="global.html#DEFAULT_SORT_COL_KEY">DEFAULT_SORT_COL_KEY</a></li><li><a href="global.html#DEFAULT_SORT_DIR_KEY">DEFAULT_SORT_DIR_KEY</a></li><li><a href="global.html#DESKTOP_CARD_VIEW_KEY">DESKTOP_CARD_VIEW_KEY</a></li><li><a href="global.html#DEV_MODE">DEV_MODE</a></li><li><a href="global.html#DISPLAY_CURRENCY_KEY">DISPLAY_CURRENCY_KEY</a></li><li><a href="global.html#EXCHANGE_RATES_KEY">EXCHANGE_RATES_KEY</a></li><li><a href="global.html#EXCHANGE_RATE_API_URL">EXCHANGE_RATE_API_URL</a></li><li><a href="global.html#FALLBACK_EXCHANGE_RATES">FALLBACK_EXCHANGE_RATES</a></li><li><a href="global.html#FEATURE_FLAGS">FEATURE_FLAGS</a></li><li><a href="global.html#FEATURE_FLAGS_KEY">FEATURE_FLAGS_KEY</a></li><li><a href="global.html#FIELD_COERCIONS">FIELD_COERCIONS</a></li><li><a href="global.html#FILTER_CHIP_CATEGORY_DEFAULTS">FILTER_CHIP_CATEGORY_DEFAULTS</a></li><li><a href="global.html#GB_ESTIMATE_MODIFIER_KEY">GB_ESTIMATE_MODIFIER_KEY</a></li><li><a href="global.html#GB_ESTIMATE_PREMIUM">GB_ESTIMATE_PREMIUM</a></li><li><a href="global.html#GB_TO_OZT">GB_TO_OZT</a></li><li><a href="global.html#GITHUB_RELEASES_URL">GITHUB_RELEASES_URL</a></li><li><a href="global.html#GOLDBACK_DENOMINATIONS">GOLDBACK_DENOMINATIONS</a></li><li><a href="global.html#GOLDBACK_ENABLED_KEY">GOLDBACK_ENABLED_KEY</a></li><li><a href="global.html#GOLDBACK_ESTIMATE_ENABLED_KEY">GOLDBACK_ESTIMATE_ENABLED_KEY</a></li><li><a href="global.html#GOLDBACK_PRICES_KEY">GOLDBACK_PRICES_KEY</a></li><li><a href="global.html#GOLDBACK_PRICE_HISTORY_KEY">GOLDBACK_PRICE_HISTORY_KEY</a></li><li><a href="global.html#HEADER_SYNC_BTN_KEY">HEADER_SYNC_BTN_KEY</a></li><li><a href="global.html#HEADER_TREND_BTN_KEY">HEADER_TREND_BTN_KEY</a></li><li><a href="global.html#IMAGE_MAX_BYTES">IMAGE_MAX_BYTES</a></li><li><a href="global.html#IMAGE_MAX_DIM">IMAGE_MAX_DIM</a></li><li><a href="global.html#IMAGE_QUALITY">IMAGE_QUALITY</a></li><li><a href="global.html#INLINE_CHIP_DEFAULTS">INLINE_CHIP_DEFAULTS</a></li><li><a href="global.html#ITEMS_PER_PAGE_KEY">ITEMS_PER_PAGE_KEY</a></li><li><a href="global.html#ITEM_PRICE_HISTORY_KEY">ITEM_PRICE_HISTORY_KEY</a></li><li><a href="global.html#ITEM_TAGS_KEY">ITEM_TAGS_KEY</a></li><li><a href="global.html#LAST_API_SYNC_KEY">LAST_API_SYNC_KEY</a></li><li><a href="global.html#LAST_CACHE_REFRESH_KEY">LAST_CACHE_REFRESH_KEY</a></li><li><a href="global.html#LAST_VERSION_CHECK_KEY">LAST_VERSION_CHECK_KEY</a></li><li><a href="global.html#LATEST_REMOTE_URL_KEY">LATEST_REMOTE_URL_KEY</a></li><li><a href="global.html#LATEST_REMOTE_VERSION_KEY">LATEST_REMOTE_VERSION_KEY</a></li><li><a href="global.html#LAYOUT_SECTION_DEFAULTS">LAYOUT_SECTION_DEFAULTS</a></li><li><a href="global.html#LOG_TAB_RENDERERS">LOG_TAB_RENDERERS</a></li><li><a href="global.html#LS_KEY">LS_KEY</a></li><li><a href="global.html#MAX_LOCAL_FILE_SIZE">MAX_LOCAL_FILE_SIZE</a></li><li><a href="global.html#MAX_TAGS_PER_ITEM">MAX_TAGS_PER_ITEM</a></li><li><a href="global.html#MAX_TAG_LENGTH">MAX_TAG_LENGTH</a></li><li><a href="global.html#METALS">METALS</a></li><li><a href="global.html#METAL_COLORS">METAL_COLORS</a></li><li><a href="global.html#METAL_ORDER_KEY">METAL_ORDER_KEY</a></li><li><a href="global.html#METAL_SYMBOLS">METAL_SYMBOLS</a></li><li><a href="global.html#NUMISTA_VIEW_FIELD_DEFAULTS">NUMISTA_VIEW_FIELD_DEFAULTS</a></li><li><a href="global.html#NumistaLookup">NumistaLookup</a></li><li><a href="global.html#PREBUILT_LOOKUP_DATA">PREBUILT_LOOKUP_DATA</a></li><li><a href="global.html#PRICE_HISTORY_COLS">PRICE_HISTORY_COLS</a></li><li><a href="global.html#Remote">Remote</a></li><li><a href="global.html#SEED_CUSTOM_RULES">SEED_CUSTOM_RULES</a></li><li><a href="global.html#SEED_DATA_YEARS">SEED_DATA_YEARS</a></li><li><a href="global.html#SEED_IMAGES_VERSION">SEED_IMAGES_VERSION</a></li><li><a href="global.html#SEED_INVENTORY_ITEMS">SEED_INVENTORY_ITEMS</a></li><li><a href="global.html#SERIAL_KEY">SERIAL_KEY</a></li><li><a href="global.html#SPOT_COMPARE_MODE_KEY">SPOT_COMPARE_MODE_KEY</a></li><li><a href="global.html#SPOT_HISTORY_KEY">SPOT_HISTORY_KEY</a></li><li><a href="global.html#SPOT_TREND_KEY">SPOT_TREND_KEY</a></li><li><a href="global.html#SPOT_TREND_RANGE_KEY">SPOT_TREND_RANGE_KEY</a></li><li><a href="global.html#STORAGE_KEY_LABELS">STORAGE_KEY_LABELS</a></li><li><a href="global.html#STORAGE_TINY_THRESHOLD_KB">STORAGE_TINY_THRESHOLD_KB</a></li><li><a href="global.html#SUPPORTED_CURRENCIES">SUPPORTED_CURRENCIES</a></li><li><a href="global.html#SYNC_FILE_PATH">SYNC_FILE_PATH</a></li><li><a href="global.html#SYNC_META_PATH">SYNC_META_PATH</a></li><li><a href="global.html#SYNC_POLL_INTERVAL">SYNC_POLL_INTERVAL</a></li><li><a href="global.html#SYNC_PUSH_DEBOUNCE">SYNC_PUSH_DEBOUNCE</a></li><li><a href="global.html#SYNC_SCOPE_KEYS">SYNC_SCOPE_KEYS</a></li><li><a href="global.html#THEME_KEY">THEME_KEY</a></li><li><a href="global.html#TIMEZONE_KEY">TIMEZONE_KEY</a></li><li><a href="global.html#TREND_PRESETS">TREND_PRESETS</a></li><li><a href="global.html#VALID_TYPES">VALID_TYPES</a></li><li><a href="global.html#VAULT_FILE_EXTENSION">VAULT_FILE_EXTENSION</a></li><li><a href="global.html#VERSION_ACK_KEY">VERSION_ACK_KEY</a></li><li><a href="global.html#VERSION_CHECK_TTL">VERSION_CHECK_TTL</a></li><li><a href="global.html#VERSION_CHECK_URL">VERSION_CHECK_URL</a></li><li><a href="global.html#VIEW_METADATA_TTL">VIEW_METADATA_TTL</a></li><li><a href="global.html#VIEW_MODAL_SECTION_DEFAULTS">VIEW_MODAL_SECTION_DEFAULTS</a></li><li><a href="global.html#_VIEW_CHART_DEFAULT_RANGE">_VIEW_CHART_DEFAULT_RANGE</a></li><li><a href="global.html#_VIEW_CHART_RANGES">_VIEW_CHART_RANGES</a></li><li><a href="global.html#_VIEW_CHART_RANGE_LABELS">_VIEW_CHART_RANGE_LABELS</a></li><li><a href="global.html#__ST_COMP_PREFIX">__ST_COMP_PREFIX</a></li><li><a href="global.html#_addDetail">_addDetail</a></li><li><a href="global.html#_applyTrend">_applyTrend</a></li><li><a href="global.html#_cardChipsHTML">_cardChipsHTML</a></li><li><a href="global.html#_cardClickBound">_cardClickBound</a></li><li><a href="global.html#_cardFmt">_cardFmt</a></li><li><a href="global.html#_cardImageHTML">_cardImageHTML</a></li><li><a href="global.html#_cardMetalClass">_cardMetalClass</a></li><li><a href="global.html#_cardSortBarBound">_cardSortBarBound</a></li><li><a href="global.html#_cloudBackupWithCachedPw">_cloudBackupWithCachedPw</a></li><li><a href="global.html#_cloudBtnAction">_cloudBtnAction</a></li><li><a href="global.html#_cloudContext">_cloudContext</a></li><li><a href="global.html#_cloudRestoreWithCachedPw">_cloudRestoreWithCachedPw</a></li><li><a href="global.html#_computePortfolioSummary">_computePortfolioSummary</a></li><li><a href="global.html#_createPriceHistoryChart">_createPriceHistoryChart</a></li><li><a href="global.html#_cvBlobUrls">_cvBlobUrls</a></li><li><a href="global.html#_cvChartInstances">_cvChartInstances</a></li><li><a href="global.html#_cvEscapeAttr">_cvEscapeAttr</a></li><li><a href="global.html#_cvImageObserver">_cvImageObserver</a></li><li><a href="global.html#_darkenColor">_darkenColor</a></li><li><a href="global.html#_dataToPolylineScaled">_dataToPolylineScaled</a></li><li><a href="global.html#_deleteObverseOnSave">_deleteObverseOnSave</a></li><li><a href="global.html#_deleteReverseOnSave">_deleteReverseOnSave</a></li><li><a href="global.html#_detailItem">_detailItem</a></li><li><a href="global.html#_el">_el</a></li><li><a href="global.html#_enhanceCardImages">_enhanceCardImages</a></li><li><a href="global.html#_enhanceTableThumbnails">_enhanceTableThumbnails</a></li><li><a href="global.html#_extractMetadata">_extractMetadata</a></li><li><a href="global.html#_fetchHistoricalSpotData">_fetchHistoricalSpotData</a></li><li><a href="global.html#_fetchNumistaResult">_fetchNumistaResult</a></li><li><a href="global.html#_fetchYearFile">_fetchYearFile</a></li><li><a href="global.html#_getBulkImageSides">_getBulkImageSides</a></li><li><a href="global.html#_getOrCreateHScrollBar">_getOrCreateHScrollBar</a></li><li><a href="global.html#_getThumbPlaceholder">_getThumbPlaceholder</a></li><li><a href="global.html#_getViewMetrics">_getViewMetrics</a></li><li><a href="global.html#_hScrollWired">_hScrollWired</a></li><li><a href="global.html#_imageSlot">_imageSlot</a></li><li><a href="global.html#_initCardCharts">_initCardCharts</a></li><li><a href="global.html#_initSpotControls">_initSpotControls</a></li><li><a href="global.html#_interpolateNulls">_interpolateNulls</a></li><li><a href="global.html#_isLightColor">_isLightColor</a></li><li><a href="global.html#_itemPriceModalFilterText">_itemPriceModalFilterText</a></li><li><a href="global.html#_itemPriceModalUuid">_itemPriceModalUuid</a></li><li><a href="global.html#_loadBulkRowImages">_loadBulkRowImages</a></li><li><a href="global.html#_loadCardImage">_loadCardImage</a></li><li><a href="global.html#_loadSectionConfig">_loadSectionConfig</a></li><li><a href="global.html#_loadThumbImage">_loadThumbImage</a></li><li><a href="global.html#_normalizePatterns">_normalizePatterns</a></li><li><a href="global.html#_openBulkImagePopover">_openBulkImagePopover</a></li><li><a href="global.html#_openExternalPopup">_openExternalPopup</a></li><li><a href="global.html#_openThumbPopover">_openThumbPopover</a></li><li><a href="global.html#_parseColor">_parseColor</a></li><li><a href="global.html#_patternMode">_patternMode</a></li><li><a href="global.html#_pendingObverseBlob">_pendingObverseBlob</a></li><li><a href="global.html#_pendingObversePreviewUrl">_pendingObversePreviewUrl</a></li><li><a href="global.html#_pendingReverseBlob">_pendingReverseBlob</a></li><li><a href="global.html#_pendingReversePreviewUrl">_pendingReversePreviewUrl</a></li><li><a href="global.html#_renderSectionConfigTable">_renderSectionConfigTable</a></li><li><a href="global.html#_renderSortBarSummary">_renderSortBarSummary</a></li><li><a href="global.html#_restoreCdnFolderFromZip">_restoreCdnFolderFromZip</a></li><li><a href="global.html#_saveSectionConfig">_saveSectionConfig</a></li><li><a href="global.html#_schedulePoll">_schedulePoll</a></li><li><a href="global.html#_section">_section</a></li><li><a href="global.html#_setSlotImage">_setSlotImage</a></li><li><a href="global.html#_showCardImage">_showCardImage</a></li><li><a href="global.html#_statusCells">_statusCells</a></li><li><a href="global.html#_storageTinyVisible">_storageTinyVisible</a></li><li><a href="global.html#_storedSortCol">_storedSortCol</a></li><li><a href="global.html#_syncFallbackUUID">_syncFallbackUUID</a></li><li><a href="global.html#_syncHScrollBar">_syncHScrollBar</a></li><li><a href="global.html#_syncPollerTimer">_syncPollerTimer</a></li><li><a href="global.html#_syncProvider">_syncProvider</a></li><li><a href="global.html#_syncPushInFlight">_syncPushInFlight</a></li><li><a href="global.html#_syncRelativeTime">_syncRelativeTime</a></li><li><a href="global.html#_syncRetryDelay">_syncRetryDelay</a></li><li><a href="global.html#_syncSortBar">_syncSortBar</a></li><li><a href="global.html#_thumbBlobUrls">_thumbBlobUrls</a></li><li><a href="global.html#_thumbObserver">_thumbObserver</a></li><li><a href="global.html#_updateHScrollThumb">_updateHScrollThumb</a></li><li><a href="global.html#_vaultPendingFile">_vaultPendingFile</a></li><li><a href="global.html#_viewModalChartInstance">_viewModalChartInstance</a></li><li><a href="global.html#_viewModalObjectUrls">_viewModalObjectUrls</a></li><li><a href="global.html#_viewYearCache">_viewYearCache</a></li><li><a href="global.html#_viewYearFetchPromises">_viewYearFetchPromises</a></li><li><a href="global.html#acceptAck">acceptAck</a></li><li><a href="global.html#activeFilters">activeFilters</a></li><li><a href="global.html#addCompositionOption">addCompositionOption</a></li><li><a href="global.html#addItemTag">addItemTag</a></li><li><a href="global.html#analyzeStorageData">analyzeStorageData</a></li><li><a href="global.html#analyzeStorageItem">analyzeStorageItem</a></li><li><a href="global.html#apiCache">apiCache</a></li><li><a href="global.html#apiConfig">apiConfig</a></li><li><a href="global.html#apiHistoryEntries">apiHistoryEntries</a></li><li><a href="global.html#apiHistoryFilterText">apiHistoryFilterText</a></li><li><a href="global.html#apiHistorySortAsc">apiHistorySortAsc</a></li><li><a href="global.html#apiHistorySortColumn">apiHistorySortColumn</a></li><li><a href="global.html#applyColumnFilter">applyColumnFilter</a></li><li><a href="global.html#applyHeaderToggleVisibility">applyHeaderToggleVisibility</a></li><li><a href="global.html#applyLayoutOrder">applyLayoutOrder</a></li><li><a href="global.html#applyMetalOrder">applyMetalOrder</a></li><li><a href="global.html#applyMinCountThreshold">applyMinCountThreshold</a></li><li><a href="global.html#applyNumistaTags">applyNumistaTags</a></li><li><a href="global.html#applyQuickFilter">applyQuickFilter</a></li><li><a href="global.html#attachAutocomplete">attachAutocomplete</a></li><li><a href="global.html#attachPriceHistorySortHeaders">attachPriceHistorySortHeaders</a></li><li><a href="global.html#autoSelectDefaultProvider">autoSelectDefaultProvider</a></li><li><a href="global.html#autoSyncSpotPrices">autoSyncSpotPrices</a></li><li><a href="global.html#backfillStaktrakrHourly">backfillStaktrakrHourly</a></li><li><a href="global.html#bindAppearanceAndHeaderListeners">bindAppearanceAndHeaderListeners</a></li><li><a href="global.html#bindCardAndTableImageListeners">bindCardAndTableImageListeners</a></li><li><a href="global.html#bindCardClickHandler">bindCardClickHandler</a></li><li><a href="global.html#bindCloudCacheListeners">bindCloudCacheListeners</a></li><li><a href="global.html#bindCloudStorageListeners">bindCloudStorageListeners</a></li><li><a href="global.html#bindFilterAndNumistaListeners">bindFilterAndNumistaListeners</a></li><li><a href="global.html#bindGoldbackActionListeners">bindGoldbackActionListeners</a></li><li><a href="global.html#bindGoldbackToggleListeners">bindGoldbackToggleListeners</a></li><li><a href="global.html#bindImageImportExportListeners">bindImageImportExportListeners</a></li><li><a href="global.html#bindImageSettingsListeners">bindImageSettingsListeners</a></li><li><a href="global.html#bindImageSyncListeners">bindImageSyncListeners</a></li><li><a href="global.html#bindNumistaBulkSyncListeners">bindNumistaBulkSyncListeners</a></li><li><a href="global.html#bindPatternRuleModeListeners">bindPatternRuleModeListeners</a></li><li><a href="global.html#bindSettingsModalShellListeners">bindSettingsModalShellListeners</a></li><li><a href="global.html#bindSettingsNavigationListeners">bindSettingsNavigationListeners</a></li><li><a href="global.html#bindStorageListeners">bindStorageListeners</a></li><li><a href="global.html#blobToWebP">blobToWebP</a></li><li><a href="global.html#brandingWarned">brandingWarned</a></li><li><a href="global.html#buildBulkItemRow">buildBulkItemRow</a></li><li><a href="global.html#buildImageExportZip">buildImageExportZip</a></li><li><a href="global.html#buildItemFields">buildItemFields</a></li><li><a href="global.html#buildNumistaSearchQuery">buildNumistaSearchQuery</a></li><li><a href="global.html#buildSearchIndices">buildSearchIndices</a></li><li><a href="global.html#buildTagSection">buildTagSection</a></li><li><a href="global.html#buildViewContent">buildViewContent</a></li><li><a href="global.html#cacheLookupTable">cacheLookupTable</a></li><li><a href="global.html#calculateApiUsage">calculateApiUsage</a></li><li><a href="global.html#calculateLevenshteinDistance">calculateLevenshteinDistance</a></li><li><a href="global.html#catalogHistory">catalogHistory</a></li><li><a href="global.html#catalogMap">catalogMap</a></li><li><a href="global.html#changeLog">changeLog</a></li><li><a href="global.html#chartInstances">chartInstances</a></li><li><a href="global.html#checkFileSize">checkFileSize</a></li><li><a href="global.html#checkRemoteVersion">checkRemoteVersion</a></li><li><a href="global.html#checkVersionChange">checkVersionChange</a></li><li><a href="global.html#cleanOrphanedItemPriceHistory">cleanOrphanedItemPriceHistory</a></li><li><a href="global.html#cleanSearchTerm">cleanSearchTerm</a></li><li><a href="global.html#cleanString">cleanString</a></li><li><a href="global.html#cleanupStorage">cleanupStorage</a></li><li><a href="global.html#clearAllCachedData">clearAllCachedData</a></li><li><a href="global.html#clearAllFilters">clearAllFilters</a></li><li><a href="global.html#clearApiCache">clearApiCache</a></li><li><a href="global.html#clearApiConfig">clearApiConfig</a></li><li><a href="global.html#clearApiHistory">clearApiHistory</a></li><li><a href="global.html#clearApiKey">clearApiKey</a></li><li><a href="global.html#clearCatalogHistory">clearCatalogHistory</a></li><li><a href="global.html#clearChangeLog">clearChangeLog</a></li><li><a href="global.html#clearItemPriceHistory">clearItemPriceHistory</a></li><li><a href="global.html#clearLookupCache">clearLookupCache</a></li><li><a href="global.html#clearSpotHistory">clearSpotHistory</a></li><li><a href="global.html#clearUploadState">clearUploadState</a></li><li><a href="global.html#closeCurrencyDropdown">closeCurrencyDropdown</a></li><li><a href="global.html#closeCurrencyDropdownOnOutside">closeCurrencyDropdownOnOutside</a></li><li><a href="global.html#closeDetailsModal">closeDetailsModal</a></li><li><a href="global.html#closeModalById">closeModalById</a></li><li><a href="global.html#closeNumistaResultsModal">closeNumistaResultsModal</a></li><li><a href="global.html#closePcgsFieldPicker">closePcgsFieldPicker</a></li><li><a href="global.html#closeSpotLookupModal">closeSpotLookupModal</a></li><li><a href="global.html#closeVaultModal">closeVaultModal</a></li><li><a href="global.html#closeViewModal">closeViewModal</a></li><li><a href="global.html#cloudBackupEnabled">cloudBackupEnabled</a></li><li><a href="global.html#coerceFieldValue">coerceFieldValue</a></li><li><a href="global.html#collectVaultData">collectVaultData</a></li><li><a href="global.html#commitItemToInventory">commitItemToInventory</a></li><li><a href="global.html#compareVersions">compareVersions</a></li><li><a href="global.html#compositionOptions">compositionOptions</a></li><li><a href="global.html#computeGoldbackEstimatedRate">computeGoldbackEstimatedRate</a></li><li><a href="global.html#computeMeltValue">computeMeltValue</a></li><li><a href="global.html#convertToUsd">convertToUsd</a></li><li><a href="global.html#createBackupData">createBackupData</a></li><li><a href="global.html#createBackupZip">createBackupZip</a></li><li><a href="global.html#createBreakdownElements">createBreakdownElements</a></li><li><a href="global.html#createDummyElement">createDummyElement</a></li><li><a href="global.html#createEmptyLookupTable">createEmptyLookupTable</a></li><li><a href="global.html#createFieldInput">createFieldInput</a></li><li><a href="global.html#createPieChart">createPieChart</a></li><li><a href="global.html#createStorageItemModal">createStorageItemModal</a></li><li><a href="global.html#createThumbEl">createThumbEl</a></li><li><a href="global.html#currentLookupTable">currentLookupTable</a></li><li><a href="global.html#currentMonthKey">currentMonthKey</a></li><li><a href="global.html#cycleSpotTrend">cycleSpotTrend</a></li><li><a href="global.html#dataToPolyline">dataToPolyline</a></li><li><a href="global.html#dataUriToBlob">dataUriToBlob</a></li><li><a href="global.html#debounce">debounce</a></li><li><a href="global.html#debugLog">debugLog</a></li><li><a href="global.html#deleteItem">deleteItem</a></li><li><a href="global.html#deleteItemPriceEntry">deleteItemPriceEntry</a></li><li><a href="global.html#deleteItemTags">deleteItemTags</a></li><li><a href="global.html#deleteTagGlobal">deleteTagGlobal</a></li><li><a href="global.html#deriveSearchLabel">deriveSearchLabel</a></li><li><a href="global.html#destroyCharts">destroyCharts</a></li><li><a href="global.html#destroySparklines">destroySparklines</a></li><li><a href="global.html#detailsChartMetric">detailsChartMetric</a></li><li><a href="global.html#detailsResizeObserver">detailsResizeObserver</a></li><li><a href="global.html#detectCurrency">detectCurrency</a></li><li><a href="global.html#disableCloudSync">disableCloudSync</a></li><li><a href="global.html#dismissAllAutocompletes">dismissAllAutocompletes</a></li><li><a href="global.html#dismissNotesModal">dismissNotesModal</a></li><li><a href="global.html#displayCurrency">displayCurrency</a></li><li><a href="global.html#downloadCompleteBackup">downloadCompleteBackup</a></li><li><a href="global.html#downloadFile">downloadFile</a></li><li><a href="global.html#downloadStorageReport">downloadStorageReport</a></li><li><a href="global.html#duplicateItem">duplicateItem</a></li><li><a href="global.html#editItem">editItem</a></li><li><a href="global.html#editingChangeLogIndex">editingChangeLogIndex</a></li><li><a href="global.html#editingIndex">editingIndex</a></li><li><a href="global.html#elements">elements</a></li><li><a href="global.html#enableCloudSync">enableCloudSync</a></li><li><a href="global.html#escapeAttribute">escapeAttribute</a></li><li><a href="global.html#escapeHtml">escapeHtml</a></li><li><a href="global.html#escapeHtmlCatalog">escapeHtmlCatalog</a></li><li><a href="global.html#escapeHtmlPcgs">escapeHtmlPcgs</a></li><li><a href="global.html#exchangeRates">exchangeRates</a></li><li><a href="global.html#exportCsv">exportCsv</a></li><li><a href="global.html#exportEncryptedBackup">exportEncryptedBackup</a></li><li><a href="global.html#exportGoldbackHistory">exportGoldbackHistory</a></li><li><a href="global.html#exportJson">exportJson</a></li><li><a href="global.html#exportNumistaCsv">exportNumistaCsv</a></li><li><a href="global.html#exportPdf">exportPdf</a></li><li><a href="global.html#exportSpotHistory">exportSpotHistory</a></li><li><a href="global.html#extractUniqueValues">extractUniqueValues</a></li><li><a href="global.html#featureFlags">featureFlags</a></li><li><a href="global.html#fetchBatchSpotPrices">fetchBatchSpotPrices</a></li><li><a href="global.html#fetchExchangeRates">fetchExchangeRates</a></li><li><a href="global.html#fetchHistoryBatched">fetchHistoryBatched</a></li><li><a href="global.html#fetchLatestPrices">fetchLatestPrices</a></li><li><a href="global.html#fetchMetalPriceApiHourly">fetchMetalPriceApiHourly</a></li><li><a href="global.html#fetchSpotForDate">fetchSpotForDate</a></li><li><a href="global.html#fetchSpotPrice">fetchSpotPrice</a></li><li><a href="global.html#fetchSpotPricesFromApi">fetchSpotPricesFromApi</a></li><li><a href="global.html#fetchStaktrakrHourlyRange">fetchStaktrakrHourlyRange</a></li><li><a href="global.html#fetchStaktrakrPrices">fetchStaktrakrPrices</a></li><li><a href="global.html#fetchYearFile">fetchYearFile</a></li><li><a href="global.html#fillFormFromNumistaResult">fillFormFromNumistaResult</a></li><li><a href="global.html#fillFormFromPcgsResult">fillFormFromPcgsResult</a></li><li><a href="global.html#filterInventory">filterInventory</a></li><li><a href="global.html#filterInventoryAdvanced">filterInventoryAdvanced</a></li><li><a href="global.html#filterItemPriceHistoryTable">filterItemPriceHistoryTable</a></li><li><a href="global.html#flattenGoldbackHistory">flattenGoldbackHistory</a></li><li><a href="global.html#formatCurrency">formatCurrency</a></li><li><a href="global.html#formatDateOnly">formatDateOnly</a></li><li><a href="global.html#formatDisplayDate">formatDisplayDate</a></li><li><a href="global.html#formatFileSize">formatFileSize</a></li><li><a href="global.html#formatLossProfit">formatLossProfit</a></li><li><a href="global.html#formatOffsetLabel">formatOffsetLabel</a></li><li><a href="global.html#formatPurchaseLocation">formatPurchaseLocation</a></li><li><a href="global.html#formatStorageLocation">formatStorageLocation</a></li><li><a href="global.html#formatTimeOnly">formatTimeOnly</a></li><li><a href="global.html#formatTimestamp">formatTimestamp</a></li><li><a href="global.html#formatWeight">formatWeight</a></li><li><a href="global.html#fuzzyMatch">fuzzyMatch</a></li><li><a href="global.html#fuzzySearch">fuzzySearch</a></li><li><a href="global.html#gbHistoryFilterText">gbHistoryFilterText</a></li><li><a href="global.html#gbHistorySortAsc">gbHistorySortAsc</a></li><li><a href="global.html#gbHistorySortColumn">gbHistorySortColumn</a></li><li><a href="global.html#generateBackupHtml">generateBackupHtml</a></li><li><a href="global.html#generateCategorySummary">generateCategorySummary</a></li><li><a href="global.html#generateColors">generateColors</a></li><li><a href="global.html#generateItemDataTable">generateItemDataTable</a></li><li><a href="global.html#generateLookupTable">generateLookupTable</a></li><li><a href="global.html#generateNGrams">generateNGrams</a></li><li><a href="global.html#generateReadmeContent">generateReadmeContent</a></li><li><a href="global.html#generateSparklineSVG">generateSparklineSVG</a></li><li><a href="global.html#generateStorageReport">generateStorageReport</a></li><li><a href="global.html#generateStorageReportHTML">generateStorageReportHTML</a></li><li><a href="global.html#generateStorageReportTar">generateStorageReportTar</a></li><li><a href="global.html#generateUUID">generateUUID</a></li><li><a href="global.html#generateVariations">generateVariations</a></li><li><a href="global.html#get24hChange">get24hChange</a></li><li><a href="global.html#getAllMetalsBreakdownData">getAllMetalsBreakdownData</a></li><li><a href="global.html#getAllUniqueTags">getAllUniqueTags</a></li><li><a href="global.html#getApiAvailability">getApiAvailability</a></li><li><a href="global.html#getAppTitle">getAppTitle</a></li><li><a href="global.html#getBreakdownData">getBreakdownData</a></li><li><a href="global.html#getCacheDurationMs">getCacheDurationMs</a></li><li><a href="global.html#getCachedLookupTable">getCachedLookupTable</a></li><li><a href="global.html#getCardStyle">getCardStyle</a></li><li><a href="global.html#getChartBackgroundColor">getChartBackgroundColor</a></li><li><a href="global.html#getChartColor">getChartColor</a></li><li><a href="global.html#getChartTextColor">getChartTextColor</a></li><li><a href="global.html#getChipColors">getChipColors</a></li><li><a href="global.html#getCompositionFirstWords">getCompositionFirstWords</a></li><li><a href="global.html#getContrastColor">getContrastColor</a></li><li><a href="global.html#getCryptoBackend">getCryptoBackend</a></li><li><a href="global.html#getCurrencySymbol">getCurrencySymbol</a></li><li><a href="global.html#getDateChunks">getDateChunks</a></li><li><a href="global.html#getDefaultSyncMode">getDefaultSyncMode</a></li><li><a href="global.html#getDisplayComposition">getDisplayComposition</a></li><li><a href="global.html#getEmbeddedRoadmap">getEmbeddedRoadmap</a></li><li><a href="global.html#getEmbeddedSeedData">getEmbeddedSeedData</a></li><li><a href="global.html#getEmbeddedWhatsNew">getEmbeddedWhatsNew</a></li><li><a href="global.html#getExchangeRate">getExchangeRate</a></li><li><a href="global.html#getExistingElement">getExistingElement</a></li><li><a href="global.html#getFilterChipCategoryConfig">getFilterChipCategoryConfig</a></li><li><a href="global.html#getFooterDomain">getFooterDomain</a></li><li><a href="global.html#getGoldbackDenominationPrice">getGoldbackDenominationPrice</a></li><li><a href="global.html#getGoldbackRetailPrice">getGoldbackRetailPrice</a></li><li><a href="global.html#getHistoricalSparklineData">getHistoricalSparklineData</a></li><li><a href="global.html#getInlineChipConfig">getInlineChipConfig</a></li><li><a href="global.html#getItemTags">getItemTags</a></li><li><a href="global.html#getLastProviderSyncTime">getLastProviderSyncTime</a></li><li><a href="global.html#getLastUpdateTime">getLastUpdateTime</a></li><li><a href="global.html#getLayoutSectionConfig">getLayoutSectionConfig</a></li><li><a href="global.html#getLookupStats">getLookupStats</a></li><li><a href="global.html#getMetalColor">getMetalColor</a></li><li><a href="global.html#getMetalOrderConfig">getMetalOrderConfig</a></li><li><a href="global.html#getNumistaViewFieldConfig">getNumistaViewFieldConfig</a></li><li><a href="global.html#getPasswordStrength">getPasswordStrength</a></li><li><a href="global.html#getPopularNumistaItems">getPopularNumistaItems</a></li><li><a href="global.html#getProviderOrder">getProviderOrder</a></li><li><a href="global.html#getRequiredYears">getRequiredYears</a></li><li><a href="global.html#getSparklineData">getSparklineData</a></li><li><a href="global.html#getSpotHistoryForMetal">getSpotHistoryForMetal</a></li><li><a href="global.html#getStorageItemDescription">getStorageItemDescription</a></li><li><a href="global.html#getStorageItemDisplayName">getStorageItemDisplayName</a></li><li><a href="global.html#getStorageReportCSS">getStorageReportCSS</a></li><li><a href="global.html#getStorageReportJS">getStorageReportJS</a></li><li><a href="global.html#getSyncDeviceId">getSyncDeviceId</a></li><li><a href="global.html#getSyncPassword">getSyncPassword</a></li><li><a href="global.html#getTemplateVariables">getTemplateVariables</a></li><li><a href="global.html#getUserFriendlyMessage">getUserFriendlyMessage</a></li><li><a href="global.html#getVersionString">getVersionString</a></li><li><a href="global.html#getViewModalSectionConfig">getViewModalSectionConfig</a></li><li><a href="global.html#goldbackEnabled">goldbackEnabled</a></li><li><a href="global.html#goldbackEstimateEnabled">goldbackEstimateEnabled</a></li><li><a href="global.html#goldbackEstimateModifier">goldbackEstimateModifier</a></li><li><a href="global.html#goldbackPriceHistory">goldbackPriceHistory</a></li><li><a href="global.html#goldbackPrices">goldbackPrices</a></li><li><a href="global.html#gramsToOzt">gramsToOzt</a></li><li><a href="global.html#handleError">handleError</a></li><li><a href="global.html#handleHistoryPull">handleHistoryPull</a></li><li><a href="global.html#handleImageDeletion">handleImageDeletion</a></li><li><a href="global.html#handleProviderSave">handleProviderSave</a></li><li><a href="global.html#handleProviderSync">handleProviderSync</a></li><li><a href="global.html#handleRemoteChange">handleRemoteChange</a></li><li><a href="global.html#handleSaveSearchPattern">handleSaveSearchPattern</a></li><li><a href="global.html#handleStaktrakrHistoryPull">handleStaktrakrHistoryPull</a></li><li><a href="global.html#handleVaultAction">handleVaultAction</a></li><li><a href="global.html#hideAboutModal">hideAboutModal</a></li><li><a href="global.html#hideAckModal">hideAckModal</a></li><li><a href="global.html#hideApiHistoryModal">hideApiHistoryModal</a></li><li><a href="global.html#hideApiModal">hideApiModal</a></li><li><a href="global.html#hideApiProvidersModal">hideApiProvidersModal</a></li><li><a href="global.html#hideCatalogHistoryModal">hideCatalogHistoryModal</a></li><li><a href="global.html#hideEmptyColumns">hideEmptyColumns</a></li><li><a href="global.html#hideFilesModal">hideFilesModal</a></li><li><a href="global.html#hideGoldbackHistoryModal">hideGoldbackHistoryModal</a></li><li><a href="global.html#hideManualInput">hideManualInput</a></li><li><a href="global.html#hideProviderInfo">hideProviderInfo</a></li><li><a href="global.html#hideSettingsModal">hideSettingsModal</a></li><li><a href="global.html#historicalDataCache">historicalDataCache</a></li><li><a href="global.html#historicalFetchPromises">historicalFetchPromises</a></li><li><a href="global.html#importCsv">importCsv</a></li><li><a href="global.html#importEncryptedBackup">importEncryptedBackup</a></li><li><a href="global.html#importJson">importJson</a></li><li><a href="global.html#importNumistaCsv">importNumistaCsv</a></li><li><a href="global.html#importSpotHistory">importSpotHistory</a></li><li><a href="global.html#initCardSortBar">initCardSortBar</a></li><li><a href="global.html#initCloudSync">initCloudSync</a></li><li><a href="global.html#initSpotHistoryButtons">initSpotHistoryButtons</a></li><li><a href="global.html#initTheme">initTheme</a></li><li><a href="global.html#initializeAutocomplete">initializeAutocomplete</a></li><li><a href="global.html#injectVersionString">injectVersionString</a></li><li><a href="global.html#inventory">inventory</a></li><li><a href="global.html#isCardViewActive">isCardViewActive</a></li><li><a href="global.html#isFeatureEnabled">isFeatureEnabled</a></li><li><a href="global.html#isGoldbackPricingActive">isGoldbackPricingActive</a></li><li><a href="global.html#isValidSelectOption">isValidSelectOption</a></li><li><a href="global.html#itemPriceHistory">itemPriceHistory</a></li><li><a href="global.html#itemTags">itemTags</a></li><li><a href="global.html#itemsPerPage">itemsPerPage</a></li><li><a href="global.html#loadAnnouncements">loadAnnouncements</a></li><li><a href="global.html#loadApiCache">loadApiCache</a></li><li><a href="global.html#loadApiConfig">loadApiConfig</a></li><li><a href="global.html#loadCatalogHistory">loadCatalogHistory</a></li><li><a href="global.html#loadData">loadData</a></li><li><a href="global.html#loadDisplayCurrency">loadDisplayCurrency</a></li><li><a href="global.html#loadExchangeRates">loadExchangeRates</a></li><li><a href="global.html#loadGoldbackEnabled">loadGoldbackEnabled</a></li><li><a href="global.html#loadGoldbackEstimateEnabled">loadGoldbackEstimateEnabled</a></li><li><a href="global.html#loadGoldbackEstimateModifier">loadGoldbackEstimateModifier</a></li><li><a href="global.html#loadGoldbackPriceHistory">loadGoldbackPriceHistory</a></li><li><a href="global.html#loadGoldbackPrices">loadGoldbackPrices</a></li><li><a href="global.html#loadInventory">loadInventory</a></li><li><a href="global.html#loadItemPriceHistory">loadItemPriceHistory</a></li><li><a href="global.html#loadItemTags">loadItemTags</a></li><li><a href="global.html#loadLookupTable">loadLookupTable</a></li><li><a href="global.html#loadProviderPriorities">loadProviderPriorities</a></li><li><a href="global.html#loadSeedImages">loadSeedImages</a></li><li><a href="global.html#loadSeedInventory">loadSeedInventory</a></li><li><a href="global.html#loadSeedSpotHistory">loadSeedSpotHistory</a></li><li><a href="global.html#loadSpotHistory">loadSpotHistory</a></li><li><a href="global.html#loadTrendRanges">loadTrendRanges</a></li><li><a href="global.html#loadViewImages">loadViewImages</a></li><li><a href="global.html#loadViewNumistaData">loadViewNumistaData</a></li><li><a href="global.html#logChange">logChange</a></li><li><a href="global.html#logItemChanges">logItemChanges</a></li><li><a href="global.html#logSyncActivity">logSyncActivity</a></li><li><a href="global.html#lookupPcgsByNumber">lookupPcgsByNumber</a></li><li><a href="global.html#lookupPcgsFromForm">lookupPcgsFromForm</a></li><li><a href="global.html#mapNumistaType">mapNumistaType</a></li><li><a href="global.html#marketValueViewItems">marketValueViewItems</a></li><li><a href="global.html#matchCoinSeries">matchCoinSeries</a></li><li><a href="global.html#mergeItemPriceHistory">mergeItemPriceHistory</a></li><li><a href="global.html#migrateHourlySource">migrateHourlySource</a></li><li><a href="global.html#migrateLayoutVisibility">migrateLayoutVisibility</a></li><li><a href="global.html#migrateProviderPriority">migrateProviderPriority</a></li><li><a href="global.html#monitorPerformance">monitorPerformance</a></li><li><a href="global.html#normalizeItemName">normalizeItemName</a></li><li><a href="global.html#normalizeString">normalizeString</a></li><li><a href="global.html#normalizeType">normalizeType</a></li><li><a href="global.html#notesIndex">notesIndex</a></li><li><a href="global.html#onGoldSpotPriceChanged">onGoldSpotPriceChanged</a></li><li><a href="global.html#openEbaySearch">openEbaySearch</a></li><li><a href="global.html#openItemPriceHistoryModal">openItemPriceHistoryModal</a></li><li><a href="global.html#openModalById">openModalById</a></li><li><a href="global.html#openNumistaModal">openNumistaModal</a></li><li><a href="global.html#openSpotLookupModal">openSpotLookupModal</a></li><li><a href="global.html#openStorageReportPopup">openStorageReportPopup</a></li><li><a href="global.html#openVaultModal">openVaultModal</a></li><li><a href="global.html#optimizeStoragePhase1C">optimizeStoragePhase1C</a></li><li><a href="global.html#optionalListener">optionalListener</a></li><li><a href="global.html#oztToGrams">oztToGrams</a></li><li><a href="global.html#pad2">pad2</a></li><li><a href="global.html#parseDate">parseDate</a></li><li><a href="global.html#parseFraction">parseFraction</a></li><li><a href="global.html#parseItemFormFields">parseItemFormFields</a></li><li><a href="global.html#parseNumistaMetal">parseNumistaMetal</a></li><li><a href="global.html#parsePcgsResponse">parsePcgsResponse</a></li><li><a href="global.html#parsePriceToUSD">parsePriceToUSD</a></li><li><a href="global.html#parsePurity">parsePurity</a></li><li><a href="global.html#parseSearchPatterns">parseSearchPatterns</a></li><li><a href="global.html#parseVaultFile">parseVaultFile</a></li><li><a href="global.html#parseWeight">parseWeight</a></li><li><a href="global.html#pcgsFetch">pcgsFetch</a></li><li><a href="global.html#pcgsPreflightCheck">pcgsPreflightCheck</a></li><li><a href="global.html#persistInventoryAndRefresh">persistInventoryAndRefresh</a></li><li><a href="global.html#pollForRemoteChanges">pollForRemoteChanges</a></li><li><a href="global.html#populateAboutModal">populateAboutModal</a></li><li><a href="global.html#populateAckModal">populateAckModal</a></li><li><a href="global.html#populateApiSection">populateApiSection</a></li><li><a href="global.html#populateImagesSection">populateImagesSection</a></li><li><a href="global.html#populateVersionModal">populateVersionModal</a></li><li><a href="global.html#preparePriceHistoryRows">preparePriceHistoryRows</a></li><li><a href="global.html#priceHistoryFilterText">priceHistoryFilterText</a></li><li><a href="global.html#processUploadedImage">processUploadedImage</a></li><li><a href="global.html#providerRequiresKey">providerRequiresKey</a></li><li><a href="global.html#pullSyncVault">pullSyncVault</a></li><li><a href="global.html#purgeCatalogHistory">purgeCatalogHistory</a></li><li><a href="global.html#purgeItemPriceHistory">purgeItemPriceHistory</a></li><li><a href="global.html#purgeSpotHistory">purgeSpotHistory</a></li><li><a href="global.html#pushSyncVault">pushSyncVault</a></li><li><a href="global.html#recalcItem">recalcItem</a></li><li><a href="global.html#recordAllItemPriceSnapshots">recordAllItemPriceSnapshots</a></li><li><a href="global.html#recordCatalogHistory">recordCatalogHistory</a></li><li><a href="global.html#recordGoldbackPrices">recordGoldbackPrices</a></li><li><a href="global.html#recordItemPrice">recordItemPrice</a></li><li><a href="global.html#recordSingleItemPrice">recordSingleItemPrice</a></li><li><a href="global.html#recordSpot">recordSpot</a></li><li><a href="global.html#refreshCompositionOptions">refreshCompositionOptions</a></li><li><a href="global.html#refreshFromCache">refreshFromCache</a></li><li><a href="global.html#refreshLookupTable">refreshLookupTable</a></li><li><a href="global.html#refreshProviderStatuses">refreshProviderStatuses</a></li><li><a href="global.html#refreshSyncUI">refreshSyncUI</a></li><li><a href="global.html#refreshTotalsDots">refreshTotalsDots</a></li><li><a href="global.html#registerName">registerName</a></li><li><a href="global.html#removeFilter">removeFilter</a></li><li><a href="global.html#removeItemTag">removeItemTag</a></li><li><a href="global.html#renameTag">renameTag</a></li><li><a href="global.html#renderActiveFilters">renderActiveFilters</a></li><li><a href="global.html#renderApiHistoryTable">renderApiHistoryTable</a></li><li><a href="global.html#renderApiStatusSummary">renderApiStatusSummary</a></li><li><a href="global.html#renderBulkTable">renderBulkTable</a></li><li><a href="global.html#renderBulkTableBody">renderBulkTableBody</a></li><li><a href="global.html#renderBulkToolbar">renderBulkToolbar</a></li><li><a href="global.html#renderCardA">renderCardA</a></li><li><a href="global.html#renderCardB">renderCardB</a></li><li><a href="global.html#renderCardC">renderCardC</a></li><li><a href="global.html#renderCardView">renderCardView</a></li><li><a href="global.html#renderCatalogHistoryForSettings">renderCatalogHistoryForSettings</a></li><li><a href="global.html#renderCatalogHistoryTable">renderCatalogHistoryTable</a></li><li><a href="global.html#renderChangeLog">renderChangeLog</a></li><li><a href="global.html#renderCloudBackupList">renderCloudBackupList</a></li><li><a href="global.html#renderCustomPatternRules">renderCustomPatternRules</a></li><li><a href="global.html#renderCustomRuleTable">renderCustomRuleTable</a></li><li><a href="global.html#renderEligibleItemsTable">renderEligibleItemsTable</a></li><li><a href="global.html#renderFilterChipCategoryTable">renderFilterChipCategoryTable</a></li><li><a href="global.html#renderGoldbackHistoryTable">renderGoldbackHistoryTable</a></li><li><a href="global.html#renderImageStorageStats">renderImageStorageStats</a></li><li><a href="global.html#renderInlineChipConfigTable">renderInlineChipConfigTable</a></li><li><a href="global.html#renderItemPriceHistoryModalTable">renderItemPriceHistoryModalTable</a></li><li><a href="global.html#renderItemPriceHistoryTable">renderItemPriceHistoryTable</a></li><li><a href="global.html#renderLayoutSectionConfigTable">renderLayoutSectionConfigTable</a></li><li><a href="global.html#renderLogTab">renderLogTab</a></li><li><a href="global.html#renderMetalOrderConfigTable">renderMetalOrderConfigTable</a></li><li><a href="global.html#renderNumistaFieldCheckboxes">renderNumistaFieldCheckboxes</a></li><li><a href="global.html#renderNumistaResultCard">renderNumistaResultCard</a></li><li><a href="global.html#renderNumistaSelectedItem">renderNumistaSelectedItem</a></li><li><a href="global.html#renderNumistaSyncUI">renderNumistaSyncUI</a></li><li><a href="global.html#renderNumistaUsageBar">renderNumistaUsageBar</a></li><li><a href="global.html#renderPcgsFieldCheckboxes">renderPcgsFieldCheckboxes</a></li><li><a href="global.html#renderPcgsSelectedItem">renderPcgsSelectedItem</a></li><li><a href="global.html#renderPcgsUsageBar">renderPcgsUsageBar</a></li><li><a href="global.html#renderSeedRuleTable">renderSeedRuleTable</a></li><li><a href="global.html#renderSpotHistoryTable">renderSpotHistoryTable</a></li><li><a href="global.html#renderSpotLookupEmpty">renderSpotLookupEmpty</a></li><li><a href="global.html#renderSpotLookupResults">renderSpotLookupResults</a></li><li><a href="global.html#renderStorageSection">renderStorageSection</a></li><li><a href="global.html#renderSyncHistorySection">renderSyncHistorySection</a></li><li><a href="global.html#renderSyncStats">renderSyncStats</a></li><li><a href="global.html#renderUserImageGrid">renderUserImageGrid</a></li><li><a href="global.html#renderVersionBadge">renderVersionBadge</a></li><li><a href="global.html#renderViewModalSectionConfigTable">renderViewModalSectionConfigTable</a></li><li><a href="global.html#replaceTemplateVariables">replaceTemplateVariables</a></li><li><a href="global.html#resetSpot">resetSpot</a></li><li><a href="global.html#resetSpotByName">resetSpotByName</a></li><li><a href="global.html#resetSpotPrice">resetSpotPrice</a></li><li><a href="global.html#resolveElement">resolveElement</a></li><li><a href="global.html#restoreBackupZip">restoreBackupZip</a></li><li><a href="global.html#restoreVaultData">restoreVaultData</a></li><li><a href="global.html#resyncCachedEntry">resyncCachedEntry</a></li><li><a href="global.html#safeAttachListener">safeAttachListener</a></li><li><a href="global.html#safeGetElement">safeGetElement</a></li><li><a href="global.html#sanitizeHtml">sanitizeHtml</a></li><li><a href="global.html#sanitizeImportedItem">sanitizeImportedItem</a></li><li><a href="global.html#sanitizeObjectFields">sanitizeObjectFields</a></li><li><a href="global.html#sanitizeTablesOnLoad">sanitizeTablesOnLoad</a></li><li><a href="global.html#saveApiCache">saveApiCache</a></li><li><a href="global.html#saveApiConfig">saveApiConfig</a></li><li><a href="global.html#saveCatalogHistory">saveCatalogHistory</a></li><li><a href="global.html#saveData">saveData</a></li><li><a href="global.html#saveDisplayCurrency">saveDisplayCurrency</a></li><li><a href="global.html#saveExchangeRates">saveExchangeRates</a></li><li><a href="global.html#saveFilterChipCategoryConfig">saveFilterChipCategoryConfig</a></li><li><a href="global.html#saveGoldbackEnabled">saveGoldbackEnabled</a></li><li><a href="global.html#saveGoldbackEstimateEnabled">saveGoldbackEstimateEnabled</a></li><li><a href="global.html#saveGoldbackEstimateModifier">saveGoldbackEstimateModifier</a></li><li><a href="global.html#saveGoldbackPriceHistory">saveGoldbackPriceHistory</a></li><li><a href="global.html#saveGoldbackPrices">saveGoldbackPrices</a></li><li><a href="global.html#saveInlineChipConfig">saveInlineChipConfig</a></li><li><a href="global.html#saveInventory">saveInventory</a></li><li><a href="global.html#saveItemPriceHistory">saveItemPriceHistory</a></li><li><a href="global.html#saveItemTags">saveItemTags</a></li><li><a href="global.html#saveLayoutSectionConfig">saveLayoutSectionConfig</a></li><li><a href="global.html#saveNumistaViewFieldConfig">saveNumistaViewFieldConfig</a></li><li><a href="global.html#saveProviderPriorities">saveProviderPriorities</a></li><li><a href="global.html#saveSpotHistory">saveSpotHistory</a></li><li><a href="global.html#saveTrendRange">saveTrendRange</a></li><li><a href="global.html#saveUserImageForItem">saveUserImageForItem</a></li><li><a href="global.html#saveViewModalSectionConfig">saveViewModalSectionConfig</a></li><li><a href="global.html#scheduleSyncPush">scheduleSyncPush</a></li><li><a href="global.html#searchHistoricalByDate">searchHistoricalByDate</a></li><li><a href="global.html#searchPatternExistsInCustomGroups">searchPatternExistsInCustomGroups</a></li><li><a href="global.html#searchPatternMatchesAutoChip">searchPatternMatchesAutoChip</a></li><li><a href="global.html#searchQuery">searchQuery</a></li><li><a href="global.html#searchSpotByDate">searchSpotByDate</a></li><li><a href="global.html#serializeVaultFile">serializeVaultFile</a></li><li><a href="global.html#setDefaultProvider">setDefaultProvider</a></li><li><a href="global.html#setEditPreviewUrl">setEditPreviewUrl</a></li><li><a href="global.html#setProviderStatus">setProviderStatus</a></li><li><a href="global.html#setTheme">setTheme</a></li><li><a href="global.html#settingsCatalogSortAsc">settingsCatalogSortAsc</a></li><li><a href="global.html#settingsCatalogSortColumn">settingsCatalogSortColumn</a></li><li><a href="global.html#settingsCloudSortAsc">settingsCloudSortAsc</a></li><li><a href="global.html#settingsCloudSortColumn">settingsCloudSortColumn</a></li><li><a href="global.html#settingsPriceSortAsc">settingsPriceSortAsc</a></li><li><a href="global.html#settingsPriceSortColumn">settingsPriceSortColumn</a></li><li><a href="global.html#settingsSpotSortAsc">settingsSpotSortAsc</a></li><li><a href="global.html#settingsSpotSortColumn">settingsSpotSortColumn</a></li><li><a href="global.html#setupAboutModalEvents">setupAboutModalEvents</a></li><li><a href="global.html#setupAckModalEvents">setupAckModalEvents</a></li><li><a href="global.html#setupApiEvents">setupApiEvents</a></li><li><a href="global.html#setupBasicEventListeners">setupBasicEventListeners</a></li><li><a href="global.html#setupBulkEditControls">setupBulkEditControls</a></li><li><a href="global.html#setupColumnResizing">setupColumnResizing</a></li><li><a href="global.html#setupDataManagementListeners">setupDataManagementListeners</a></li><li><a href="global.html#setupEventListeners">setupEventListeners</a></li><li><a href="global.html#setupFormatImport">setupFormatImport</a></li><li><a href="global.html#setupHeaderButtonListeners">setupHeaderButtonListeners</a></li><li><a href="global.html#setupImportExportListeners">setupImportExportListeners</a></li><li><a href="global.html#setupItemFormListeners">setupItemFormListeners</a></li><li><a href="global.html#setupNoteAndModalListeners">setupNoteAndModalListeners</a></li><li><a href="global.html#setupPagination">setupPagination</a></li><li><a href="global.html#setupProviderPriority">setupProviderPriority</a></li><li><a href="global.html#setupProviderSettingsListeners">setupProviderSettingsListeners</a></li><li><a href="global.html#setupResponsiveColumns">setupResponsiveColumns</a></li><li><a href="global.html#setupSearch">setupSearch</a></li><li><a href="global.html#setupSearchAndChipListeners">setupSearchAndChipListeners</a></li><li><a href="global.html#setupSettingsEventListeners">setupSettingsEventListeners</a></li><li><a href="global.html#setupSpotPriceListeners">setupSpotPriceListeners</a></li><li><a href="global.html#setupSystemThemeListener">setupSystemThemeListener</a></li><li><a href="global.html#setupTableSortListeners">setupTableSortListeners</a></li><li><a href="global.html#setupThemeToggle">setupThemeToggle</a></li><li><a href="global.html#setupVaultListeners">setupVaultListeners</a></li><li><a href="global.html#setupVersionModalEvents">setupVersionModalEvents</a></li><li><a href="global.html#shouldShowSearchSaveButton">shouldShowSearchSaveButton</a></li><li><a href="global.html#showAboutModal">showAboutModal</a></li><li><a href="global.html#showAckModal">showAckModal</a></li><li><a href="global.html#showApiHistoryModal">showApiHistoryModal</a></li><li><a href="global.html#showApiModal">showApiModal</a></li><li><a href="global.html#showApiProvidersModal">showApiProvidersModal</a></li><li><a href="global.html#showBulkConfirm">showBulkConfirm</a></li><li><a href="global.html#showCatalogHistoryModal">showCatalogHistoryModal</a></li><li><a href="global.html#showDetailsModal">showDetailsModal</a></li><li><a href="global.html#showFilesModal">showFilesModal</a></li><li><a href="global.html#showFullChangelog">showFullChangelog</a></li><li><a href="global.html#showGoldbackHistoryModal">showGoldbackHistoryModal</a></li><li><a href="global.html#showManualInput">showManualInput</a></li><li><a href="global.html#showNotes">showNotes</a></li><li><a href="global.html#showNotesView">showNotesView</a></li><li><a href="global.html#showNumistaResults">showNumistaResults</a></li><li><a href="global.html#showPcgsFieldPicker">showPcgsFieldPicker</a></li><li><a href="global.html#showProviderInfo">showProviderInfo</a></li><li><a href="global.html#showSettingsModal">showSettingsModal</a></li><li><a href="global.html#showStaticVersionBadge">showStaticVersionBadge</a></li><li><a href="global.html#showSyncConflictModal">showSyncConflictModal</a></li><li><a href="global.html#showSyncUpdateModal">showSyncUpdateModal</a></li><li><a href="global.html#showTagInput">showTagInput</a></li><li><a href="global.html#showVaultStatus">showVaultStatus</a></li><li><a href="global.html#showViewModal">showViewModal</a></li><li><a href="global.html#simpleHash">simpleHash</a></li><li><a href="global.html#simplifyChipValue">simplifyChipValue</a></li><li><a href="global.html#sortInventory">sortInventory</a></li><li><a href="global.html#sortInventoryByDateNewestFirst">sortInventoryByDateNewestFirst</a></li><li><a href="global.html#sparklineInstances">sparklineInstances</a></li><li><a href="global.html#spotHistory">spotHistory</a></li><li><a href="global.html#spotPrices">spotPrices</a></li><li><a href="global.html#startBulkSync">startBulkSync</a></li><li><a href="global.html#startCellEdit">startCellEdit</a></li><li><a href="global.html#startSpotInlineEdit">startSpotInlineEdit</a></li><li><a href="global.html#startSyncPoller">startSyncPoller</a></li><li><a href="global.html#stopSyncPoller">stopSyncPoller</a></li><li><a href="global.html#stripNonAlphanumeric">stripNonAlphanumeric</a></li><li><a href="global.html#switchLogTab">switchLogTab</a></li><li><a href="global.html#switchProviderTab">switchProviderTab</a></li><li><a href="global.html#switchSettingsSection">switchSettingsSection</a></li><li><a href="global.html#syncAllProviders">syncAllProviders</a></li><li><a href="global.html#syncChipToggle">syncChipToggle</a></li><li><a href="global.html#syncCurrencySettingsUI">syncCurrencySettingsUI</a></li><li><a href="global.html#syncGoldbackSettingsUI">syncGoldbackSettingsUI</a></li><li><a href="global.html#syncHasLocalChanges">syncHasLocalChanges</a></li><li><a href="global.html#syncHeaderToggleUI">syncHeaderToggleUI</a></li><li><a href="global.html#syncLayoutVisibilityUI">syncLayoutVisibilityUI</a></li><li><a href="global.html#syncProviderChain">syncProviderChain</a></li><li><a href="global.html#syncProviderPriorityUI">syncProviderPriorityUI</a></li><li><a href="global.html#syncRestoreOverrideBackup">syncRestoreOverrideBackup</a></li><li><a href="global.html#syncSaveOverrideBackup">syncSaveOverrideBackup</a></li><li><a href="global.html#syncSettingsUI">syncSettingsUI</a></li><li><a href="global.html#syncSpotPricesFromApi">syncSpotPricesFromApi</a></li><li><a href="global.html#testApiConnection">testApiConnection</a></li><li><a href="global.html#todayStr">todayStr</a></li><li><a href="global.html#toggleChange">toggleChange</a></li><li><a href="global.html#toggleCurrencyDropdown">toggleCurrencyDropdown</a></li><li><a href="global.html#toggleGlobalPriceView">toggleGlobalPriceView</a></li><li><a href="global.html#togglePriceView">togglePriceView</a></li><li><a href="global.html#toggleTheme">toggleTheme</a></li><li><a href="global.html#toggleVaultPasswordVisibility">toggleVaultPasswordVisibility</a></li><li><a href="global.html#tokenizeWords">tokenizeWords</a></li><li><a href="global.html#updateAllSparklines">updateAllSparklines</a></li><li><a href="global.html#updateCardSortBar">updateCardSortBar</a></li><li><a href="global.html#updateColumnVisibility">updateColumnVisibility</a></li><li><a href="global.html#updateFuzzyIndicator">updateFuzzyIndicator</a></li><li><a href="global.html#updateHistoryPullCost">updateHistoryPullCost</a></li><li><a href="global.html#updateItemCount">updateItemCount</a></li><li><a href="global.html#updateLastTimestamps">updateLastTimestamps</a></li><li><a href="global.html#updateManualSpot">updateManualSpot</a></li><li><a href="global.html#updateMatchIndicator">updateMatchIndicator</a></li><li><a href="global.html#updateModalCurrencyUI">updateModalCurrencyUI</a></li><li><a href="global.html#updatePortalHeight">updatePortalHeight</a></li><li><a href="global.html#updateProviderHistoryTables">updateProviderHistoryTables</a></li><li><a href="global.html#updateProviderSettings">updateProviderSettings</a></li><li><a href="global.html#updateSaveSearchButton">updateSaveSearchButton</a></li><li><a href="global.html#updateSettingsFooter">updateSettingsFooter</a></li><li><a href="global.html#updateSparkline">updateSparkline</a></li><li><a href="global.html#updateSpotCardColor">updateSpotCardColor</a></li><li><a href="global.html#updateSpotChangePercent">updateSpotChangePercent</a></li><li><a href="global.html#updateSpotTimestamp">updateSpotTimestamp</a></li><li><a href="global.html#updateStatusCell">updateStatusCell</a></li><li><a href="global.html#updateStorageStats">updateStorageStats</a></li><li><a href="global.html#updateStrengthBar">updateStrengthBar</a></li><li><a href="global.html#updateSummary">updateSummary</a></li><li><a href="global.html#updateSyncButtonStates">updateSyncButtonStates</a></li><li><a href="global.html#updateSyncStatusIndicator">updateSyncStatusIndicator</a></li><li><a href="global.html#updateThemeButton">updateThemeButton</a></li><li><a href="global.html#useSpotPrice">useSpotPrice</a></li><li><a href="global.html#validateFieldValue">validateFieldValue</a></li><li><a href="global.html#validateInventoryItem">validateInventoryItem</a></li><li><a href="global.html#validateItemFields">validateItemFields</a></li><li><a href="global.html#vaultDecrypt">vaultDecrypt</a></li><li><a href="global.html#vaultDecryptAndRestore">vaultDecryptAndRestore</a></li><li><a href="global.html#vaultDeriveKey">vaultDeriveKey</a></li><li><a href="global.html#vaultEncrypt">vaultEncrypt</a></li><li><a href="global.html#vaultEncryptToBytes">vaultEncryptToBytes</a></li><li><a href="global.html#vaultEncryptToBytesScoped">vaultEncryptToBytesScoped</a></li><li><a href="global.html#vaultRandomBytes">vaultRandomBytes</a></li><li><a href="global.html#verifyPcgsCert">verifyPcgsCert</a></li><li><a href="global.html#wireChipSortToggle">wireChipSortToggle</a></li><li><a href="global.html#wireFeatureFlagToggle">wireFeatureFlagToggle</a></li><li><a href="global.html#wireStorageToggle">wireStorageToggle</a></li><li><a href="global.html#xhrLoadJSON">xhrLoadJSON</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Thu Feb 19 2026 02:57:08 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
