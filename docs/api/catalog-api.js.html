<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: catalog-api.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: catalog-api.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// CATALOG API SYSTEM
// =============================================================================
// Provider-agnostic catalog API architecture for StakTrakr
// Provider-agnostic architecture for catalog lookups

/**
 * Catalog API Configuration with base64-encoded key storage
 * Matches the metals API key pattern in js/api.js
 */
class CatalogConfig {
  constructor() {
    this.storageKey = 'catalog_api_config';
    this.load();
  }

  load() {
    try {
      const stored = localStorage.getItem(this.storageKey);
      if (stored) {
        const parsed = JSON.parse(stored);
        // Decode base64 keys on load
        if (parsed.numista &amp;&amp; parsed.numista.apiKey) {
          try {
            parsed.numista.apiKey = atob(parsed.numista.apiKey);
          } catch (e) {
            // Key wasn't base64 encoded (legacy or plain text) â€” keep as-is
          }
        }
        if (parsed.pcgs &amp;&amp; parsed.pcgs.bearerToken) {
          try {
            parsed.pcgs.bearerToken = atob(parsed.pcgs.bearerToken);
          } catch (e) {
            // Token wasn't base64 encoded â€” keep as-is
          }
        }
        this.config = parsed;
      } else {
        this.config = this.getDefaultConfig();
      }
    } catch (error) {
      console.warn('Failed to load catalog config:', error);
      this.config = this.getDefaultConfig();
    }
  }

  getDefaultConfig() {
    const now = new Date();
    const month = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
    const today = now.toISOString().slice(0, 10);
    return {
      numista: {
        apiKey: '',
        quota: 2000
      },
      numistaUsage: {
        used: 0,
        month: month
      },
      pcgs: {
        bearerToken: ''
      },
      pcgsUsage: {
        used: 0,
        date: today
      },
      local: {
        enabled: true
      }
    };
  }

  save() {
    try {
      // Encode keys as base64 before writing to localStorage
      const toStore = JSON.parse(JSON.stringify(this.config));
      if (toStore.numista &amp;&amp; toStore.numista.apiKey) {
        toStore.numista.apiKey = btoa(toStore.numista.apiKey);
      }
      if (toStore.pcgs &amp;&amp; toStore.pcgs.bearerToken) {
        toStore.pcgs.bearerToken = btoa(toStore.pcgs.bearerToken);
      }
      localStorage.setItem(this.storageKey, JSON.stringify(toStore));
    } catch (error) {
      console.error('Failed to save catalog config:', error);
    }
  }

  /**
   * Set Numista API key
   * @param {string} apiKey - Plain text API key
   * @param {number} quota - API quota (default 2000)
   */
  setNumistaConfig(apiKey, quota = 2000) {
    this.config.numista = {
      apiKey: apiKey || '',
      quota
    };
    this.save();
    return true;
  }

  /**
   * Get current Numista configuration
   */
  getNumistaConfig() {
    return {
      ...this.config.numista,
      apiKey: this.config.numista.apiKey || ''
    };
  }

  /**
   * Check if Numista is configured with a valid key
   */
  isNumistaEnabled() {
    return !!this.config.numista.apiKey;
  }

  /**
   * Clear stored Numista key
   */
  clearNumistaKey() {
    this.config.numista = {
      apiKey: '',
      quota: 2000
    };
    this.save();
  }

  /**
   * Check if user has stored a key
   */
  hasNumistaKey() {
    return !!this.config.numista.apiKey;
  }

  /**
   * Increment Numista usage counter, auto-resetting if month changed
   */
  incrementNumistaUsage() {
    const now = new Date();
    const currentMonth = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
    if (!this.config.numistaUsage) {
      this.config.numistaUsage = { used: 0, month: currentMonth };
    }
    if (this.config.numistaUsage.month !== currentMonth) {
      this.config.numistaUsage.used = 0;
      this.config.numistaUsage.month = currentMonth;
    }
    this.config.numistaUsage.used++;
    this.save();
  }

  /**
   * Get current Numista usage stats
   * @returns {{ used: number, quota: number, month: string }}
   */
  getNumistaUsage() {
    const now = new Date();
    const currentMonth = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
    if (!this.config.numistaUsage) {
      this.config.numistaUsage = { used: 0, month: currentMonth };
    }
    if (this.config.numistaUsage.month !== currentMonth) {
      this.config.numistaUsage.used = 0;
      this.config.numistaUsage.month = currentMonth;
    }
    return {
      used: this.config.numistaUsage.used,
      quota: this.config.numista?.quota || 2000,
      month: this.config.numistaUsage.month
    };
  }

  // â”€â”€â”€ PCGS Methods â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  /**
   * Set PCGS bearer token
   * @param {string} token - Bearer token from PCGS
   */
  setPcgsConfig(token) {
    if (!this.config.pcgs) this.config.pcgs = {};
    this.config.pcgs.bearerToken = token || '';
    this.save();
    return true;
  }

  /**
   * Get current PCGS configuration
   * @returns {{ bearerToken: string }}
   */
  getPcgsConfig() {
    if (!this.config.pcgs) this.config.pcgs = { bearerToken: '' };
    return { bearerToken: this.config.pcgs.bearerToken || '' };
  }

  /**
   * Check if PCGS is configured with a valid token
   * @returns {boolean}
   */
  isPcgsEnabled() {
    return !!(this.config.pcgs &amp;&amp; this.config.pcgs.bearerToken);
  }

  /**
   * Clear stored PCGS token
   */
  clearPcgsToken() {
    this.config.pcgs = { bearerToken: '' };
    this.save();
  }

  /**
   * Increment PCGS usage counter, auto-resetting if date changed (daily limit)
   */
  incrementPcgsUsage() {
    const today = new Date().toISOString().slice(0, 10);
    if (!this.config.pcgsUsage) {
      this.config.pcgsUsage = { used: 0, date: today };
    }
    if (this.config.pcgsUsage.date !== today) {
      this.config.pcgsUsage.used = 0;
      this.config.pcgsUsage.date = today;
    }
    this.config.pcgsUsage.used++;
    this.save();
  }

  /**
   * Check if a PCGS API request can be made (under daily rate limit)
   * @returns {boolean}
   */
  canMakePcgsRequest() {
    const today = new Date().toISOString().slice(0, 10);
    if (!this.config.pcgsUsage || this.config.pcgsUsage.date !== today) {
      return true; // New day, counter resets
    }
    return this.config.pcgsUsage.used &lt; 1000;
  }

  /**
   * Get current PCGS usage stats
   * @returns {{ used: number, limit: number, date: string }}
   */
  getPcgsUsage() {
    const today = new Date().toISOString().slice(0, 10);
    if (!this.config.pcgsUsage) {
      this.config.pcgsUsage = { used: 0, date: today };
    }
    if (this.config.pcgsUsage.date !== today) {
      this.config.pcgsUsage.used = 0;
      this.config.pcgsUsage.date = today;
    }
    return {
      used: this.config.pcgsUsage.used,
      limit: 1000,
      date: this.config.pcgsUsage.date
    };
  }
}

// Global catalog configuration instance
const catalogConfig = new CatalogConfig();

console.log('ðŸ”Œ Catalog API system ready - configure API keys through settings');

/**
 * Base interface for all catalog providers
 * Ensures consistent API regardless of provider
 */
class CatalogProvider {
  constructor(config = {}) {
    this.name = config.name || 'Unknown';
    this.apiKey = config.apiKey || '';
    this.baseUrl = config.baseUrl || '';
    this.rateLimit = config.rateLimit || 60; // requests per minute
    this.timeout = config.timeout || 10000; // 10 seconds
    this.lastRequest = 0;
    this.requestCount = 0;
    this.requestWindow = 60000; // 1 minute window
  }

  /**
   * Check if we can make a request (rate limiting)
   * @returns {boolean} True if request is allowed
   */
  canMakeRequest() {
    const now = Date.now();
    if (now - this.lastRequest > this.requestWindow) {
      this.requestCount = 0;
      this.lastRequest = now;
    }
    return this.requestCount &lt; this.rateLimit;
  }

  /**
   * Make rate-limited HTTP request
   * @param {string} url - Request URL
   * @param {Object} options - Fetch options
   * @returns {Promise} Fetch response
   */
  async request(url, options = {}) {
    if (!this.canMakeRequest()) {
      throw new Error(`Rate limit exceeded for ${this.name}. Try again later.`);
    }

    this.requestCount++;

    // Persist Numista usage across page reloads
    if (this instanceof NumistaProvider) {
      catalogConfig.incrementNumistaUsage();
    }

    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), this.timeout);

    try {
      const response = await fetch(url, {
        ...options,
        signal: controller.signal,
        headers: {
          'Content-Type': 'application/json',
          ...options.headers
        }
      });
      
      clearTimeout(timeoutId);
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      return response;
    } catch (error) {
      clearTimeout(timeoutId);
      if (error.name === 'AbortError') {
        throw new Error(`Request timeout for ${this.name}`);
      }
      throw error;
    }
  }

  /**
   * Lookup item by catalog ID - MUST be implemented by providers
   * @param {string} catalogId - Catalog identifier
   * @returns {Promise&lt;Object>} Standardized item data
   */
  async lookupItem(catalogId) {
    throw new Error('lookupItem must be implemented by provider');
  }

  /**
   * Search for items by query - MUST be implemented by providers
   * @param {string} query - Search term
   * @param {Object} filters - Search filters
   * @returns {Promise&lt;Array>} Array of standardized item data
   */
  async searchItems(query, filters = {}) {
    throw new Error('searchItems must be implemented by provider');
  }

  /**
   * Get current market value for item - MUST be implemented by providers
   * @param {string} catalogId - Catalog identifier
   * @returns {Promise&lt;number>} Current market value in USD
   */
  async getMarketValue(catalogId) {
    throw new Error('getMarketValue must be implemented by provider');
  }
}

/**
 * Numista API Provider
 * Implements Numista-specific API calls
 */
class NumistaProvider extends CatalogProvider {
  constructor() {
    const config = catalogConfig.getNumistaConfig();
    super({
      name: 'Numista',
      apiKey: config.apiKey,
      baseUrl: 'https://api.numista.com/v3',
      rateLimit: 100, // Numista allows 100 requests per minute
      timeout: 15000
    });
    this.clientName = config.clientName;
    this.clientId = config.clientId;
    this.quota = config.quota;
  }

  /**
   * Lookup item by Numista catalog ID
   * @param {string} catalogId - Numista item ID
   * @returns {Promise&lt;Object>} Standardized item data
   */
  async lookupItem(catalogId) {
    if (!catalogId) throw new Error('Catalog ID is required');

    const url = `${this.baseUrl}/types/${catalogId}?lang=en`;

    try {
      const response = await this.request(url, {
        headers: { 'Numista-API-Key': this.apiKey }
      });
      const data = await response.json();
      if (typeof window !== 'undefined' &amp;&amp; typeof window.debugLog === 'function') {
        window.debugLog(`Numista lookup ${catalogId}: keys=${Object.keys(data).join(',')}`);
        if (data.obverse) window.debugLog(`  obverse keys: ${Object.keys(data.obverse).join(',')}`);
        if (data.reverse) window.debugLog(`  reverse keys: ${Object.keys(data.reverse).join(',')}`);
      }

      return this.normalizeItemData(data);
    } catch (error) {
      console.error(`Numista lookup failed for ID ${catalogId}:`, error);
      throw new Error(`Failed to lookup item ${catalogId} from Numista: ${error.message}`);
    }
  }

  /**
   * Search for items on Numista
   * @param {string} query - Search term
   * @param {Object} filters - Search filters
   * @returns {Promise&lt;Array>} Array of standardized item data
   */
  async searchItems(query, filters = {}) {
    const params = new URLSearchParams({
      q: query,
      count: Math.min(filters.limit || 20, 50),
      lang: 'en'
    });

    if (filters.page) params.append('page', filters.page);
    if (filters.country) params.append('issuer', filters.country);
    if (filters.category) params.append('category', filters.category);
    if (filters.year) params.append('year', filters.year);

    const url = `${this.baseUrl}/types?${params.toString()}`;

    try {
      const response = await this.request(url, {
        headers: { 'Numista-API-Key': this.apiKey }
      });
      const data = await response.json();

      return data.types ? data.types.map(item => this.normalizeItemData(item)) : [];
    } catch (error) {
      console.error('Numista search failed:', error);
      throw new Error(`Numista search failed: ${error.message}`);
    }
  }

  /**
   * Get current market value from Numista
   * @param {string} catalogId - Numista item ID
   * @returns {Promise&lt;number>} Current market value in USD
   */
  async getMarketValue(catalogId) {
    // Note: Numista doesn't provide real-time market values
    // This would need to be enhanced or combined with other sources
    try {
      const item = await this.lookupItem(catalogId);
      return item.estimatedValue || 0;
    } catch (error) {
      console.warn(`Could not get market value for ${catalogId}:`, error);
      return 0;
    }
  }

  /**
   * Normalize Numista data to standard format
   * @param {Object} numistaData - Raw Numista API response
   * @returns {Object} Standardized item data
   */
  normalizeItemData(numistaData) {
    // Compose year from min_year / max_year range
    const minY = numistaData.min_year;
    const maxY = numistaData.max_year;
    const year = minY &amp;&amp; maxY &amp;&amp; minY !== maxY ? `${minY}-${maxY}` : (minY || maxY || '');

    // Handle composition â€” can be a string or object with .text
    const rawComp = numistaData.composition;
    const composition = typeof rawComp === 'object' &amp;&amp; rawComp !== null ? (rawComp.text || '') : (rawComp || '');

    // Image: prefer obverse_thumbnail with nested fallback
    const imageUrl = numistaData.obverse_thumbnail ||
      numistaData.obverse?.thumbnail ||
      numistaData.reverse_thumbnail ||
      '';

    // Reverse image: separate field for showing both sides
    const reverseImageUrl = numistaData.reverse_thumbnail ||
      numistaData.reverse?.thumbnail ||
      '';

    debugLog(`  imageUrl: ${imageUrl || '(empty)'}, reverseImageUrl: ${reverseImageUrl || '(empty)'}`);

    // Extract catalog references (KM#, Schon#, etc.)
    const kmReferences = [];
    if (Array.isArray(numistaData.references)) {
      numistaData.references.forEach(ref => {
        if (ref.catalogue?.code &amp;&amp; ref.number) {
          kmReferences.push(`${ref.catalogue.code}# ${ref.number}`);
        }
      });
    }

    // Extract mintage data by year
    const mintageByYear = [];
    if (Array.isArray(numistaData.years)) {
      numistaData.years.forEach(y => {
        if (y.year) {
          mintageByYear.push({
            year: y.year,
            mintage: y.mintage || 0,
            remark: y.remark || '',
          });
        }
      });
    }

    // Denomination / face value
    const denomination = numistaData.value?.text || '';

    return {
      catalogId: numistaData.id?.toString() || '',
      name: numistaData.title || '',
      year: year.toString(),
      country: numistaData.issuer?.name || '',
      metal: this.normalizeMetal(composition),
      weight: numistaData.weight || 0,
      diameter: numistaData.size || 0,
      thickness: numistaData.thickness || 0,
      type: this.normalizeType(numistaData.category || ''),
      mintage: 0, // Mintage is per-issue, not per-type in Numista API
      estimatedValue: numistaData.value?.numeric_value || 0,
      imageUrl: imageUrl,
      reverseImageUrl: reverseImageUrl,
      description: numistaData.comments || '',
      provider: 'Numista',
      lastUpdated: new Date().toISOString(),
      // Enriched fields for view modal
      denomination: denomination,
      shape: numistaData.shape || '',
      composition: composition,
      orientation: numistaData.orientation || '',
      commemorative: !!numistaData.is_commemorative,
      commemorativeDesc: numistaData.commemorative_description || '',
      rarityIndex: numistaData.rarity_index || 0,
      kmReferences: kmReferences,
      mintageByYear: mintageByYear,
      tags: Array.isArray(numistaData.tags) ? numistaData.tags : [],
      technique: typeof numistaData.technique === 'object' ? (numistaData.technique?.text || '') : (numistaData.technique || ''),
      obverseDesc: numistaData.obverse?.description || '',
      reverseDesc: numistaData.reverse?.description || '',
      edgeDesc: numistaData.edge?.description || '',
    };
  }

  /**
   * Normalize metal composition from Numista format
   * @param {string} composition - Numista composition string
   * @returns {string} Standardized metal name
   */
  normalizeMetal(composition) {
    const comp = composition.toLowerCase();
    if (comp.includes('gold') || comp.includes('au')) return 'Gold';
    if (comp.includes('silver') || comp.includes('ag')) return 'Silver';
    if (comp.includes('platinum') || comp.includes('pt')) return 'Platinum';
    if (comp.includes('palladium') || comp.includes('pd')) return 'Palladium';
    if (comp.includes('copper') || comp.includes('bronze') || comp.includes('brass')) return 'Alloy/Other';
    return 'Alloy/Other';
  }

  /**
   * Normalize item type from Numista format
   * @param {string} type - Numista type string
   * @returns {string} Standardized type
   */
  normalizeType(type) {
    const t = type.toLowerCase();
    if (t.includes('coin') || t.includes('circulation')) return 'Coin';
    if (t.includes('bar') || t.includes('ingot')) return 'Bar';
    if (t.includes('round')) return 'Round';
    if (t.includes('note') || t.includes('bill')) return 'Note';
    return 'Other';
  }
}

/**
/**
 * Local Provider (Fallback)
 * Uses local data when external APIs are unavailable
 */
class LocalProvider extends CatalogProvider {
  constructor() {
    super({
      name: 'Local',
      rateLimit: 1000, // No real rate limit for local data
      timeout: 1000
    });
    this.localData = this.loadLocalData();
  }

  loadLocalData() {
    // Load any cached catalog data from localStorage
    try {
      const stored = localStorage.getItem('staktrakr.catalog.cache');
      return stored ? JSON.parse(stored) : {};
    } catch (error) {
      console.warn('Could not load local catalog cache:', error);
      return {};
    }
  }

  async lookupItem(catalogId) {
    const item = this.localData[catalogId];
    if (!item) {
      throw new Error(`Item ${catalogId} not found in local cache`);
    }
    return item;
  }

  async searchItems(query, filters = {}) {
    const results = Object.values(this.localData).filter(item => 
      item.name.toLowerCase().includes(query.toLowerCase()) ||
      item.description.toLowerCase().includes(query.toLowerCase())
    );
    return results.slice(0, filters.limit || 20);
  }

  async getMarketValue(catalogId) {
    const item = this.localData[catalogId];
    return item ? (item.estimatedValue || 0) : 0;
  }

  /**
   * Cache item data locally
   * @param {string} catalogId - Catalog identifier
   * @param {Object} itemData - Standardized item data
   */
  cacheItem(catalogId, itemData) {
    this.localData[catalogId] = itemData;
    try {
      localStorage.setItem('staktrakr.catalog.cache', JSON.stringify(this.localData));
    } catch (error) {
      console.warn('Could not cache item data:', error);
    }
  }
}

/**
 * Main Catalog API Manager
 * Coordinates multiple providers with fallback chain
 */
class CatalogAPI {
  constructor() {
    this.providers = [];
    this.localProvider = new LocalProvider();
    this.activeProvider = null;
    this.settings = this.loadSettings();
    
    this.initializeProviders();
  }

  /**
   * Load API settings from localStorage
   */
  loadSettings() {
    try {
      const stored = localStorage.getItem('staktrakr.catalog.settings');
      return stored ? JSON.parse(stored) : {
        activeProvider: 'numista',
        numistaApiKey: '',
        enableFallback: true,
        cacheDuration: 3600000 // 1 hour
      };
    } catch (error) {
      console.warn('Could not load catalog API settings:', error);
      return {};
    }
  }

  /**
   * Save API settings to localStorage
   */
  saveSettings() {
    try {
      localStorage.setItem('staktrakr.catalog.settings', JSON.stringify(this.settings));
    } catch (error) {
      console.warn('Could not save catalog API settings:', error);
    }
  }

  /**
   * Initialize available providers based on API keys
   */
  initializeProviders() {
    this.providers = [];

    // Add Numista provider if configured and enabled
    if (catalogConfig.isNumistaEnabled()) {
      try {
        const numista = new NumistaProvider();
        this.providers.push(numista);
        this.activeProvider = numista;
        console.log('âœ… Numista provider initialized');
      } catch (error) {
        console.error('âŒ Failed to initialize Numista provider:', error);
      }
    }

    // Default to first available provider if none set
    if (!this.activeProvider &amp;&amp; this.providers.length > 0) {
      this.activeProvider = this.providers[0];
    }

    console.log(`ðŸ”Œ Catalog API initialized with ${this.providers.length} provider(s)`);
  }

  /**
   * Set API key for a provider
   * @param {string} provider - Provider name ('numista')
   * @param {string} apiKey - API key
   */
  setApiKey(provider, apiKey) {
    if (provider === 'numista') {
      this.settings.numistaApiKey = apiKey;
    }
    
    this.saveSettings();
    this.initializeProviders();
  }

  /**
   * Switch active provider
   * @param {string} providerName - Provider name to switch to
   */
  switchProvider(providerName) {
    const provider = this.providers.find(p => p.name.toLowerCase() === providerName.toLowerCase());
    if (provider) {
      this.activeProvider = provider;
      this.settings.activeProvider = providerName.toLowerCase();
      this.saveSettings();
      console.log(`Switched to ${provider.name} catalog provider`);
    } else {
      throw new Error(`Provider ${providerName} not available`);
    }
  }

  /**
   * Lookup item with fallback chain
   * @param {string} catalogId - Catalog identifier
   * @param {Object} [options={}] - Options (e.g. { action: 'test' })
   * @returns {Promise&lt;Object>} Standardized item data
   */
  async lookupItem(catalogId, options = {}) {
    const startTime = Date.now();
    const action = options.action || 'lookup';
    const providers = this.settings.enableFallback ?
      [this.activeProvider, ...this.providers.filter(p => p !== this.activeProvider), this.localProvider] :
      [this.activeProvider];

    let lastError;

    for (const provider of providers) {
      if (!provider) continue;

      try {
        console.log(`Attempting lookup with ${provider.name}...`);
        const result = await provider.lookupItem(catalogId);

        // Cache successful results locally
        if (provider !== this.localProvider) {
          this.localProvider.cacheItem(catalogId, result);
        }

        recordCatalogHistory({
          action,
          query: catalogId,
          result: 'success',
          itemCount: 1,
          provider: provider.name,
          duration: Date.now() - startTime,
        });

        return result;
      } catch (error) {
        console.warn(`${provider.name} lookup failed:`, error.message);
        lastError = error;
        continue;
      }
    }

    recordCatalogHistory({
      action,
      query: catalogId,
      result: 'fail',
      itemCount: 0,
      provider: '',
      duration: Date.now() - startTime,
      error: lastError ? lastError.message : 'All providers failed',
    });

    throw lastError || new Error('All catalog providers failed');
  }

  /**
   * Search items with active provider
   * @param {string} query - Search term
   * @param {Object} filters - Search filters
   * @returns {Promise&lt;Array>} Array of standardized item data
   */
  async searchItems(query, filters = {}) {
    const startTime = Date.now();

    if (!this.activeProvider) {
      recordCatalogHistory({
        action: 'search',
        query,
        result: 'fail',
        itemCount: 0,
        provider: '',
        duration: Date.now() - startTime,
        error: 'No catalog provider available',
      });
      throw new Error('No catalog provider available');
    }

    try {
      const results = await this.activeProvider.searchItems(query, filters);
      recordCatalogHistory({
        action: 'search',
        query,
        result: 'success',
        itemCount: results.length,
        provider: this.activeProvider.name,
        duration: Date.now() - startTime,
      });
      return results;
    } catch (error) {
      recordCatalogHistory({
        action: 'search',
        query,
        result: 'fail',
        itemCount: 0,
        provider: this.activeProvider.name,
        duration: Date.now() - startTime,
        error: error.message,
      });
      throw error;
    }
  }

  /**
   * Get market value with fallback
   * @param {string} catalogId - Catalog identifier
   * @returns {Promise&lt;number>} Current market value in USD
   */
  async getMarketValue(catalogId) {
    const startTime = Date.now();
    const providers = this.settings.enableFallback ?
      [this.activeProvider, ...this.providers.filter(p => p !== this.activeProvider)] :
      [this.activeProvider];

    let lastError;

    for (const provider of providers) {
      if (!provider) continue;

      try {
        const value = await provider.getMarketValue(catalogId);
        recordCatalogHistory({
          action: 'market_value',
          query: catalogId,
          result: 'success',
          itemCount: 1,
          provider: provider.name,
          duration: Date.now() - startTime,
        });
        return value;
      } catch (error) {
        console.warn(`${provider.name} market value lookup failed:`, error.message);
        lastError = error;
        continue;
      }
    }

    recordCatalogHistory({
      action: 'market_value',
      query: catalogId,
      result: 'fail',
      itemCount: 0,
      provider: '',
      duration: Date.now() - startTime,
      error: lastError ? lastError.message : 'All providers failed',
    });

    return 0; // Fallback to 0 if all providers fail
  }

  /**
   * Get provider status information
   * @returns {Object} Status of all providers
   */
  getProviderStatus() {
    return {
      active: this.activeProvider ? this.activeProvider.name : 'None',
      available: this.providers.map(p => p.name),
      settings: this.settings
    };
  }
}

// Global catalog API instance
let catalogAPI = new CatalogAPI();

// =============================================================================
// CATALOG HISTORY LOGGING
// =============================================================================

let catalogHistoryEntries = [];
let catalogHistorySortColumn = "";
let catalogHistorySortAsc = true;
let catalogHistoryFilterText = "";
let selectedNumistaResult = null;

/**
 * Save catalog history to localStorage
 */
const saveCatalogHistory = () => {
  try {
    saveDataSync(CATALOG_HISTORY_KEY, catalogHistory);
  } catch (e) {
    console.warn("Failed to save catalog history:", e);
  }
};

/**
 * Load catalog history from localStorage
 */
const loadCatalogHistory = () => {
  catalogHistory = loadDataSync(CATALOG_HISTORY_KEY, []);
};

/**
 * Purge catalog history entries older than given number of days
 * @param {number} days - Maximum age in days (default 180)
 */
const purgeCatalogHistory = (days = 180) => {
  const cutoff = new Date();
  cutoff.setDate(cutoff.getDate() - days);
  const cutoffStr = cutoff.toISOString().slice(0, 10).replace(/-/g, "-");
  catalogHistory = catalogHistory.filter(
    (e) => e.timestamp >= cutoffStr
  );
};

/**
 * Record a catalog API call to history
 * @param {Object} entry - History entry data
 */
const recordCatalogHistory = (entry) => {
  loadCatalogHistory();
  purgeCatalogHistory();

  const now = new Date();
  const pad = (n) => String(n).padStart(2, "0");
  const timestamp = `${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())} ${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;

  catalogHistory.push({
    timestamp,
    action: entry.action || "lookup",
    query: entry.query || "",
    result: entry.result || "success",
    itemCount: entry.itemCount || 0,
    provider: entry.provider || "",
    duration: entry.duration || 0,
    error: entry.error || null,
  });

  saveCatalogHistory();
};

/**
 * Renders catalog history table with filtering and sorting
 * Mirrors renderApiHistoryTable() in api.js
 */
const renderCatalogHistoryTable = () => {
  const table = document.getElementById("catalogHistoryTable");
  if (!table) return;

  let data = [...catalogHistoryEntries];
  if (catalogHistoryFilterText) {
    const f = catalogHistoryFilterText.toLowerCase();
    data = data.filter((e) =>
      Object.values(e).some((v) => String(v).toLowerCase().includes(f))
    );
  }
  if (catalogHistorySortColumn) {
    data.sort((a, b) => {
      const valA = a[catalogHistorySortColumn];
      const valB = b[catalogHistorySortColumn];
      if (valA &lt; valB) return catalogHistorySortAsc ? -1 : 1;
      if (valA > valB) return catalogHistorySortAsc ? 1 : -1;
      return 0;
    });
  }
  if (!catalogHistorySortColumn) {
    data.sort((a, b) => (a.timestamp &lt; b.timestamp ? 1 : -1));
  }

  let html =
    '&lt;tr>&lt;th data-column="timestamp">Time&lt;/th>&lt;th data-column="action">Action&lt;/th>&lt;th data-column="query">Query&lt;/th>&lt;th data-column="result">Result&lt;/th>&lt;th data-column="itemCount">Items&lt;/th>&lt;th data-column="provider">Provider&lt;/th>&lt;th data-column="duration">Duration&lt;/th>&lt;/tr>';
  data.forEach((e) => {
    const resultClass = e.result === "fail" ? ' style="color: var(--danger, #e74c3c);"' : "";
    const errorTitle = e.error ? ` title="${e.error.replace(/"/g, "&amp;quot;")}"` : "";
    html += `&lt;tr>&lt;td>${e.timestamp}&lt;/td>&lt;td>${e.action}&lt;/td>&lt;td>${e.query}&lt;/td>&lt;td${resultClass}${errorTitle}>${e.result}&lt;/td>&lt;td>${e.itemCount}&lt;/td>&lt;td>${e.provider || ""}&lt;/td>&lt;td>${e.duration}ms&lt;/td>&lt;/tr>`;
  });
  // nosemgrep: javascript.browser.security.insecure-innerhtml.insecure-innerhtml, javascript.browser.security.insecure-document-method.insecure-document-method
  table.innerHTML = html;

  table.querySelectorAll("th").forEach((th) => {
    th.addEventListener("click", () => {
      const col = th.dataset.column;
      if (catalogHistorySortColumn === col) {
        catalogHistorySortAsc = !catalogHistorySortAsc;
      } else {
        catalogHistorySortColumn = col;
        catalogHistorySortAsc = true;
      }
      renderCatalogHistoryTable();
    });
  });
};

/**
 * Shows catalog history modal
 */
const showCatalogHistoryModal = () => {
  const modal = document.getElementById("catalogHistoryModal");
  if (!modal) return;

  loadCatalogHistory();
  catalogHistoryEntries = [...catalogHistory];
  catalogHistorySortColumn = "";
  catalogHistorySortAsc = true;
  catalogHistoryFilterText = "";

  const filterInput = document.getElementById("catalogHistoryFilter");
  const clearFilterBtn = document.getElementById("catalogHistoryClearFilterBtn");
  if (filterInput) {
    filterInput.value = "";
    filterInput.oninput = (e) => {
      catalogHistoryFilterText = e.target.value;
      renderCatalogHistoryTable();
    };
  }
  if (clearFilterBtn) {
    clearFilterBtn.onclick = () => {
      catalogHistoryFilterText = "";
      if (filterInput) filterInput.value = "";
      renderCatalogHistoryTable();
    };
  }
  renderCatalogHistoryTable();
  modal.style.display = "flex";
};

/**
 * Hides catalog history modal
 */
const hideCatalogHistoryModal = () => {
  const modal = document.getElementById("catalogHistoryModal");
  if (modal) modal.style.display = "none";
};

// =============================================================================
// NUMISTA RESULTS MODAL â€” Search results + field picker UI
// =============================================================================

/**
 * Escape HTML for safe insertion into innerHTML
 * @param {string} str - Raw string
 * @returns {string} Escaped string
 */
const escapeHtmlCatalog = (str) =>
  String(str || '')
    .replace(/&amp;/g, '&amp;amp;')
    .replace(/&lt;/g, '&amp;lt;')
    .replace(/>/g, '&amp;gt;')
    .replace(/"/g, '&amp;quot;')
    .replace(/'/g, '&amp;#39;');

/**
 * Render a single result card HTML string
 * @param {Object} result - Normalized Numista item data
 * @param {number} index - Index in results array
 * @returns {string} HTML string
 */
const renderNumistaResultCard = (result, index) => {
  const placeholder = `&lt;div class="numista-img-placeholder">ðŸª™&lt;/div>`;
  const obverseImg = result.imageUrl
    ? `&lt;img src="${escapeHtmlCatalog(result.imageUrl)}" alt="Obverse" loading="lazy">`
    : placeholder;
  const reverseImg = result.reverseImageUrl
    ? `&lt;img src="${escapeHtmlCatalog(result.reverseImageUrl)}" alt="Reverse" loading="lazy">`
    : '';
  const meta = [
    result.year,
    result.country,
    result.metal,
    result.weight ? `${result.weight}g` : '',
    result.type
  ].filter(Boolean).join(' Â· ');

  return `&lt;div class="numista-result-card" data-result-index="${index}">
    &lt;div class="numista-result-images">${obverseImg}${reverseImg}&lt;/div>
    &lt;div class="numista-result-info">
      &lt;div class="numista-result-name">${escapeHtmlCatalog(result.name)}&lt;/div>
      &lt;div class="numista-result-meta">${escapeHtmlCatalog(meta)}&lt;/div>
      &lt;div class="numista-result-id">N#${escapeHtmlCatalog(result.catalogId)}&lt;/div>
    &lt;/div>
  &lt;/div>`;
};

/**
 * Render the selected item preview in field picker
 * @param {Object} result - Normalized Numista item data
 * @returns {string} HTML string
 */
const renderNumistaSelectedItem = (result) => {
  const placeholder = `&lt;div class="numista-img-placeholder">ðŸª™&lt;/div>`;
  const obverseImg = result.imageUrl
    ? `&lt;img src="${escapeHtmlCatalog(result.imageUrl)}" alt="Obverse" loading="lazy">`
    : placeholder;
  const reverseImg = result.reverseImageUrl
    ? `&lt;img src="${escapeHtmlCatalog(result.reverseImageUrl)}" alt="Reverse" loading="lazy">`
    : '';
  const meta = [
    result.year,
    result.country,
    result.metal,
    result.weight ? `${result.weight}g` : '',
    result.type
  ].filter(Boolean).join(' Â· ');

  return `&lt;div class="numista-result-images">${obverseImg}${reverseImg}&lt;/div>
    &lt;div class="numista-result-info">
      &lt;div class="numista-result-name">${escapeHtmlCatalog(result.name)}&lt;/div>
      &lt;div class="numista-result-meta">${escapeHtmlCatalog(meta)}&lt;/div>
      &lt;div class="numista-result-id">N#${escapeHtmlCatalog(result.catalogId)}&lt;/div>
    &lt;/div>`;
};

/**
 * Check if a value matches a valid &lt;select> option
 * @param {string} selectId - DOM id of the select element
 * @param {string} value - Value to check
 * @returns {boolean}
 */
const isValidSelectOption = (selectId, value) => {
  const el = document.getElementById(selectId);
  if (!el) return false;
  return Array.from(el.options).some(o => o.value === value);
};

/**
 * Render field checkboxes with editable input fields for the selected result.
 * Each row: [checkbox] [label] [editable text input]
 * User can tweak values before hitting "Fill Fields".
 * @param {Object} result - Normalized Numista item data
 */
const renderNumistaFieldCheckboxes = (result) => {
  const container = document.getElementById('numistaFieldCheckboxes');
  if (!container) return;

  const typeValid = result.type &amp;&amp; isValidSelectOption('itemType', result.type);

  // Fields ordered: primary (checked by default) first, then optional (unchecked)
  const fields = [
    { key: 'name', label: 'Name', value: result.name || '', available: true, defaultOn: true },
    { key: 'catalog', label: 'Catalog N#', value: result.catalogId || '', available: true, defaultOn: true },
    { key: 'year', label: 'Year', value: result.year || '', available: !!result.year, defaultOn: false },
    {
      key: 'type', label: 'Type',
      value: result.type || '',
      available: typeValid,
      defaultOn: false,
      warn: result.type &amp;&amp; !typeValid ? `"${result.type}" â€” not in form options` : ''
    },
    { key: 'weight', label: 'Weight (g)', value: result.weight ? String(result.weight) : '', available: result.weight > 0, defaultOn: result.weight > 0 },
  ];

  // Keep the heading, rebuild field rows
  const heading = container.querySelector('.numista-fields-heading');
  container.innerHTML = '';
  if (heading) {
    container.appendChild(heading);
  } else {
    const h = document.createElement('div');
    h.className = 'numista-fields-heading';
    h.textContent = 'Fields to fill:';
    container.appendChild(h);
  }

  // Map field keys to current form values for "Current:" hints
  const currentFormValues = {
    name: (elements.itemName || document.getElementById('itemName'))?.value?.trim() || '',
    catalog: (elements.itemCatalog || document.getElementById('itemCatalog'))?.value?.trim() || '',
    year: (elements.itemYear || document.getElementById('itemYear'))?.value?.trim() || '',
    type: (elements.itemType || document.getElementById('itemType'))?.value || '',
    weight: (elements.itemWeight || document.getElementById('itemWeight'))?.value?.trim() || '',
  };

  fields.forEach(f => {
    // Checkbox â€” grid column 1
    const cb = document.createElement('input');
    cb.type = 'checkbox';
    cb.name = 'numistaField';
    cb.value = f.key;
    cb.checked = f.available &amp;&amp; !!f.value &amp;&amp; f.defaultOn;
    if (!f.value) cb.disabled = true;

    // Label â€” grid column 2
    const label = document.createElement('span');
    label.className = 'numista-field-label';
    label.textContent = f.label + ':';

    // Editable text input â€” grid column 3
    const input = document.createElement('input');
    input.type = 'text';
    input.className = 'numista-field-input';
    input.name = 'numistaFieldValue_' + f.key;
    input.value = f.value;
    input.placeholder = f.available ? '' : 'N/A';
    if (!f.available &amp;&amp; !f.value) input.disabled = true;

    // Toggle input enabled/disabled when checkbox changes
    cb.addEventListener('change', () => { input.disabled = !cb.checked; });
    if (!cb.checked) input.disabled = true;

    container.appendChild(cb);
    container.appendChild(label);
    container.appendChild(input);

    // "Current:" hint showing existing form value (helps user compare before filling)
    const currentVal = currentFormValues[f.key];
    if (currentVal) {
      const hint = document.createElement('div');
      hint.className = 'numista-field-current';
      hint.textContent = `Current: ${currentVal}`;
      hint.title = currentVal;
      container.appendChild(hint);
    }

    // Warning text spanning all columns (e.g. "Alloy/Other â€” not in form options")
    if (f.warn) {
      const warn = document.createElement('div');
      warn.className = 'numista-field-warn';
      warn.textContent = f.warn;
      container.appendChild(warn);
    }
  });
};

/**
 * Curated list of popular bullion items for quick-pick in the no-results modal.
 * Focused on items silver/gold stackers commonly own.
 * @returns {Array&lt;{id: string, name: string, metal: string}>}
 */
const getPopularNumistaItems = () => [
  // Silver bullion
  { id: '1493',   name: 'American Silver Eagle',         metal: 'Silver' },
  { id: '298883', name: 'American Silver Eagle (New Rev)', metal: 'Silver' },
  { id: '9164',   name: 'Canadian Silver Maple Leaf',    metal: 'Silver' },
  { id: '13410',  name: 'British Silver Britannia',      metal: 'Silver' },
  { id: '9165',   name: 'Austrian Silver Philharmonic',  metal: 'Silver' },
  { id: '13855',  name: 'Mexican Silver Libertad',       metal: 'Silver' },
  { id: '143754', name: 'Silver Krugerrand',             metal: 'Silver' },
  // Gold bullion
  { id: '23134',  name: 'American Gold Eagle',           metal: 'Gold' },
  { id: '18451',  name: 'American Gold Buffalo',         metal: 'Gold' },
  { id: '6002',   name: 'Gold Krugerrand',               metal: 'Gold' },
  { id: '15150',  name: 'Austrian Gold Philharmonic',    metal: 'Gold' },
  // Classic silver
  { id: '1492',   name: 'Morgan Dollar',                 metal: 'Silver' },
  { id: '5580',   name: 'Peace Dollar',                  metal: 'Silver' },
];

/**
 * Show Numista results modal with search results
 * @param {Array} results - Array of normalized Numista item data
 * @param {boolean} directLookup - If true and single result, skip list and show field picker
 * @param {string} originalQuery - The search query used (for retry pre-fill)
 */
const showNumistaResults = (results, directLookup = false, originalQuery = '') => {
  const modal = document.getElementById('numistaResultsModal');
  const list = document.getElementById('numistaResultsList');
  const picker = document.getElementById('numistaFieldPicker');
  const title = document.getElementById('numistaResultsTitle');
  const preview = document.getElementById('numistaSelectedItem');
  if (!modal || !list || !picker) return;

  selectedNumistaResult = null;
  list.innerHTML = '';
  picker.style.display = 'none';

  if (!results || results.length === 0) {
    title.textContent = 'No Results';

    // Build quick-picks from curated popular items
    const popularItems = getPopularNumistaItems();
    const quickPicksHtml = `&lt;div class="numista-quick-picks">
        &lt;p class="numista-quick-picks-label">Popular bullion items:&lt;/p>
        &lt;div class="numista-quick-picks-list">
          ${popularItems.map(item =>
            `&lt;button type="button" class="numista-quick-pick" data-numista-id="${escapeHtmlCatalog(item.id)}">
              &lt;span class="quick-pick-id">N#${escapeHtmlCatalog(item.id)}&lt;/span>
              &lt;span class="quick-pick-name">${escapeHtmlCatalog(item.name)}&lt;/span>
              &lt;span class="quick-pick-count">${escapeHtmlCatalog(item.metal)}&lt;/span>
            &lt;/button>`
          ).join('')}
        &lt;/div>
      &lt;/div>`;

    // nosemgrep: javascript.browser.security.insecure-innerhtml.insecure-innerhtml, javascript.browser.security.insecure-document-method.insecure-document-method
    list.innerHTML = `&lt;div class="numista-no-results-enhanced">
      &lt;div class="numista-retry-search">
        &lt;p>No matching items found on Numista.&lt;/p>
        &lt;div class="numista-retry-row">
          &lt;input type="text" id="numistaRetryInput" class="numista-retry-input"
                 placeholder="Refine your search..." value="${escapeHtmlCatalog(originalQuery)}">
          &lt;button type="button" id="numistaRetryBtn" class="btn btn-primary numista-retry-btn">Search&lt;/button>
        &lt;/div>
      &lt;/div>
      ${quickPicksHtml}
    &lt;/div>`;
    list.style.display = 'block';
    modal.style.display = 'flex';

    // Wire up retry search
    const retryBtn = document.getElementById('numistaRetryBtn');
    const retryInput = document.getElementById('numistaRetryInput');
    if (retryBtn &amp;&amp; retryInput) {
      const doRetry = async () => {
        const query = retryInput.value.trim();
        if (!query) return;
        retryBtn.disabled = true;
        retryBtn.textContent = 'Searching\u2026';
        try {
          const retryResults = await catalogAPI.searchItems(query, { limit: 20 });
          showNumistaResults(retryResults, false, query);
        } catch (err) {
          console.error('Numista retry search failed:', err);
          retryBtn.textContent = 'Failed';
          setTimeout(() => { retryBtn.textContent = 'Search'; retryBtn.disabled = false; }, 1500);
        }
      };
      retryBtn.addEventListener('click', doRetry);
      retryInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') doRetry(); });
      // Auto-focus the search input for quick editing
      setTimeout(() => retryInput.select(), 50);
    }

    // Wire up quick-pick clicks
    list.querySelectorAll('.numista-quick-pick').forEach(pickBtn => {
      pickBtn.addEventListener('click', async () => {
        const nId = pickBtn.dataset.numistaId;
        if (!nId) return;
        pickBtn.style.opacity = '0.5';
        pickBtn.disabled = true;
        try {
          const result = await catalogAPI.lookupItem(nId);
          showNumistaResults(result ? [result] : [], true, nId);
        } catch (err) {
          console.error('Numista quick-pick lookup failed:', err);
          pickBtn.style.opacity = '1';
          pickBtn.disabled = false;
        }
      });
    });

    return;
  }

  // Direct lookup with single result â†’ skip to field picker
  if (directLookup &amp;&amp; results.length === 1) {
    title.textContent = 'Numista Item Found';
    list.style.display = 'none';
    selectedNumistaResult = results[0];
    // nosemgrep: javascript.browser.security.insecure-innerhtml.insecure-innerhtml, javascript.browser.security.insecure-document-method.insecure-document-method
    preview.innerHTML = renderNumistaSelectedItem(results[0]);
    renderNumistaFieldCheckboxes(results[0]);
    picker.style.display = 'block';
    modal.style.display = 'flex';
    return;
  }

  // Multiple results â†’ show selectable card list with search refinement
  title.textContent = `Numista Results (${results.length})`;
  // Stash results on the list element for delegated click retrieval
  list._numistaResults = results;

  // Build refinement search bar + result cards
  const searchBarHtml = `&lt;div class="numista-refine-search">
    &lt;input type="text" id="numistaRefineInput" class="numista-refine-input"
           placeholder="Refine search..." value="${escapeHtmlCatalog(originalQuery)}">
    &lt;button type="button" id="numistaRefineBtn" class="btn btn-primary numista-refine-btn">Search&lt;/button>
  &lt;/div>`;
  const cardsHtml = results.slice(0, 20).map((r, i) => renderNumistaResultCard(r, i)).join('');
  // nosemgrep: javascript.browser.security.insecure-innerhtml.insecure-innerhtml, javascript.browser.security.insecure-document-method.insecure-document-method
  list.innerHTML = searchBarHtml + cardsHtml;
  list.style.display = 'flex';
  modal.style.display = 'flex';

  // Wire up refinement search
  const refineBtn = document.getElementById('numistaRefineBtn');
  const refineInput = document.getElementById('numistaRefineInput');
  if (refineBtn &amp;&amp; refineInput) {
    const doRefine = async () => {
      const query = refineInput.value.trim();
      if (!query) return;
      refineBtn.disabled = true;
      refineBtn.textContent = 'Searching\u2026';
      try {
        const refineResults = await catalogAPI.searchItems(query, { limit: 20 });
        showNumistaResults(refineResults, false, query);
      } catch (err) {
        console.error('Numista refine search failed:', err);
        refineBtn.textContent = 'Failed';
        setTimeout(() => { refineBtn.textContent = 'Search'; refineBtn.disabled = false; }, 1500);
      }
    };
    refineBtn.addEventListener('click', doRefine);
    refineInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') doRefine(); });
    setTimeout(() => refineInput.select(), 50);
  }
};

/**
 * Fill form fields from the editable picker inputs.
 * Reads values from the numistaFieldValue_* text inputs (user may have edited them).
 */
const fillFormFromNumistaResult = () => {
  const container = document.getElementById('numistaFieldCheckboxes');
  if (!container) return;

  // Collect checked fields and their edited values from the picker inputs
  const checkboxes = container.querySelectorAll('input[name="numistaField"]');

  // Intercept for bulk edit â€” when callback is set, route field values there instead
  if (typeof window._bulkEditNumistaCallback === 'function') {
    const fieldMap = {};
    checkboxes.forEach(cb => {
      if (!cb.checked) return;
      const input = container.querySelector('input[name="numistaFieldValue_' + cb.value + '"]');
      if (input &amp;&amp; input.value.trim()) fieldMap[cb.value] = input.value.trim();
    });
    window._bulkEditNumistaCallback(fieldMap);
    window._bulkEditNumistaCallback = null;
    closeNumistaResultsModal();
    return;
  }

  checkboxes.forEach(cb => {
    if (!cb.checked) return;
    const input = container.querySelector(`input[name="numistaFieldValue_${cb.value}"]`);
    if (!input) return;
    const val = input.value.trim();
    if (!val) return;

    switch (cb.value) {
      case 'name': {
        const el = elements.itemName || document.getElementById('itemName');
        if (el) el.value = val;
        break;
      }
      case 'year': {
        const el = elements.itemYear || document.getElementById('itemYear');
        if (el) el.value = val;
        break;
      }
      case 'type': {
        const el = elements.itemType || document.getElementById('itemType');
        if (el) {
          const valid = Array.from(el.options).map(o => o.value);
          if (valid.includes(val)) el.value = val;
        }
        break;
      }
      case 'weight': {
        const el = elements.itemWeight || document.getElementById('itemWeight');
        const unitEl = document.getElementById('itemWeightUnit');
        const num = parseFloat(val);
        if (el &amp;&amp; !isNaN(num) &amp;&amp; num > 0) {
          el.value = num;
          if (unitEl) unitEl.value = 'g';
        }
        break;
      }
      case 'catalog': {
        const el = elements.itemCatalog || document.getElementById('itemCatalog');
        if (el) el.value = val;
        break;
      }
    }
  });
};

/**
 * Close Numista results modal and clean up state
 */
const closeNumistaResultsModal = () => {
  const modal = document.getElementById('numistaResultsModal');
  if (modal) modal.style.display = 'none';
  selectedNumistaResult = null;
};

// Test function for Numista API
async function testNumistaAPI() {
  if (!catalogConfig.isNumistaEnabled()) {
    console.log('âŒ Numista API not configured');
    return;
  }

  console.log('ðŸ§ª Testing Numista API...');
  
  try {
    // Test with a known coin ID (American Silver Eagle)
    const testId = '5685'; // This is a common test ID for American Silver Eagle 1986
    const result = await catalogAPI.lookupItem(testId, { action: 'test' });
    console.log('âœ… Numista API test successful:', result);
    return result;
  } catch (error) {
    console.error('âŒ Numista API test failed:', error);
    return null;
  }
}

/**
 * Renders Numista API usage progress bar into #numistaUsageBar
 * Reuses the same .api-usage / .usage-bar / .usage-text CSS as metals providers
 */
const renderNumistaUsageBar = () => {
  const container = document.getElementById('numistaUsageBar');
  if (!container) return;
  const usage = catalogConfig.getNumistaUsage();
  // Coerce to safe finite numbers and validate month format
  const used = Number.isFinite(usage.used) ? Math.max(0, usage.used) : 0;
  const quota = Number.isFinite(usage.quota) &amp;&amp; usage.quota > 0 ? usage.quota : 2000;
  const month = /^\d{4}-\d{2}$/.test(usage.month) ? usage.month : '';
  const usedPercent = Math.min((used / quota) * 100, 100);
  const remainingPercent = 100 - usedPercent;
  const warning = used / quota >= 0.9;

  // Build DOM nodes safely (no innerHTML with localStorage-sourced values)
  container.textContent = '';
  const wrapper = document.createElement('div');
  wrapper.className = 'api-usage';
  const bar = document.createElement('div');
  bar.className = 'usage-bar';
  const usedDiv = document.createElement('div');
  usedDiv.className = 'used';
  usedDiv.style.width = `${usedPercent}%`;
  const remainDiv = document.createElement('div');
  remainDiv.className = 'remaining';
  remainDiv.style.width = `${remainingPercent}%`;
  bar.appendChild(usedDiv);
  bar.appendChild(remainDiv);
  const text = document.createElement('div');
  text.className = 'usage-text';
  text.textContent = `${used}/${quota} calls${month ? ` (${month})` : ''}${warning ? ' ðŸš©' : ''}`;
  wrapper.appendChild(bar);
  wrapper.appendChild(text);
  container.appendChild(wrapper);
};

/**
 * Renders PCGS API usage progress bar into #pcgsUsageBar
 * Clones the Numista pattern but uses daily granularity (1,000/day)
 */
const renderPcgsUsageBar = () => {
  const container = document.getElementById('pcgsUsageBar');
  if (!container) return;
  const usage = catalogConfig.getPcgsUsage();
  const used = Number.isFinite(usage.used) ? Math.max(0, usage.used) : 0;
  const quota = Number.isFinite(usage.limit) &amp;&amp; usage.limit > 0 ? usage.limit : 1000;
  const day = /^\d{4}-\d{2}-\d{2}$/.test(usage.date) ? usage.date : '';
  const usedPercent = Math.min((used / quota) * 100, 100);
  const remainingPercent = 100 - usedPercent;
  const warning = used / quota >= 0.9;

  container.textContent = '';
  const wrapper = document.createElement('div');
  wrapper.className = 'api-usage';
  const bar = document.createElement('div');
  bar.className = 'usage-bar';
  const usedDiv = document.createElement('div');
  usedDiv.className = 'used';
  usedDiv.style.width = `${usedPercent}%`;
  const remainDiv = document.createElement('div');
  remainDiv.className = 'remaining';
  remainDiv.style.width = `${remainingPercent}%`;
  bar.appendChild(usedDiv);
  bar.appendChild(remainDiv);
  const text = document.createElement('div');
  text.className = 'usage-text';
  text.textContent = `${used}/${quota} calls${day ? ` (${day})` : ''}${warning ? ' \uD83D\uDEA9' : ''}`;
  wrapper.appendChild(bar);
  wrapper.appendChild(text);
  container.appendChild(wrapper);
};

// =============================================================================
// CATALOG HISTORY â€” SETTINGS LOG TABLE
// =============================================================================

/** @type {string} Sort column for settings catalog history table */
let settingsCatalogSortColumn = '';
/** @type {boolean} Sort ascending for settings catalog history table */
let settingsCatalogSortAsc = true;

/**
 * Renders the catalog history table in the Settings > Activity Log > Catalogs sub-tab.
 * Reads from global catalogHistory, sorts by timestamp descending by default.
 */
const renderCatalogHistoryForSettings = () => {
  const table = document.getElementById('settingsCatalogHistoryTable');
  if (!table) return;

  loadCatalogHistory();
  let data = [...catalogHistory];

  // Sort
  if (settingsCatalogSortColumn) {
    data.sort((a, b) => {
      const valA = a[settingsCatalogSortColumn];
      const valB = b[settingsCatalogSortColumn];
      if (valA &lt; valB) return settingsCatalogSortAsc ? -1 : 1;
      if (valA > valB) return settingsCatalogSortAsc ? 1 : -1;
      return 0;
    });
  } else {
    data.sort((a, b) => (a.timestamp &lt; b.timestamp ? 1 : -1));
  }

  const tbody = table.querySelector('tbody');
  if (!tbody) return;

  if (data.length === 0) {
    // nosemgrep: javascript.browser.security.insecure-innerhtml.insecure-innerhtml
    tbody.innerHTML = '&lt;tr class="settings-log-empty">&lt;td colspan="7">No catalog history recorded yet.&lt;/td>&lt;/tr>';
    return;
  }

  const rows = data.map(e => {
    const resultClass = e.result === 'fail' ? ' style="color: var(--danger, #e74c3c);"' : '';
    const errorTitle = e.error ? ` title="${String(e.error).replace(/"/g, '&amp;quot;')}"` : '';
    return `&lt;tr>&lt;td>${e.timestamp || ''}&lt;/td>&lt;td>${e.action || ''}&lt;/td>&lt;td>${e.query || ''}&lt;/td>&lt;td${resultClass}${errorTitle}>${e.result || ''}&lt;/td>&lt;td>${e.itemCount || 0}&lt;/td>&lt;td>${e.provider || ''}&lt;/td>&lt;td>${e.duration || 0}ms&lt;/td>&lt;/tr>`;
  });

  // nosemgrep: javascript.browser.security.insecure-innerhtml.insecure-innerhtml
  tbody.innerHTML = rows.join('');

  // Sortable headers
  table.querySelectorAll('th').forEach(th => {
    th.style.cursor = 'pointer';
    th.onclick = () => {
      const cols = ['timestamp', 'action', 'query', 'result', 'itemCount', 'provider', 'duration'];
      const idx = Array.from(th.parentNode.children).indexOf(th);
      const col = cols[idx];
      if (settingsCatalogSortColumn === col) {
        settingsCatalogSortAsc = !settingsCatalogSortAsc;
      } else {
        settingsCatalogSortColumn = col;
        settingsCatalogSortAsc = true;
      }
      renderCatalogHistoryForSettings();
    };
  });
};

/**
 * Clears all catalog API history after user confirmation.
 */
const clearCatalogHistory = () => {
  if (!confirm('Clear all catalog history? This cannot be undone.')) return;
  catalogHistory = [];
  saveCatalogHistory();
  const panel = document.getElementById('logPanel_catalogs');
  if (panel) delete panel.dataset.rendered;
  renderCatalogHistoryForSettings();
};

// Export for use in other modules
if (typeof window !== 'undefined') {
  window.catalogAPI = catalogAPI;
  window.catalogConfig = catalogConfig;
  window.testNumistaAPI = testNumistaAPI;
  window.CatalogAPI = CatalogAPI;
  window.NumistaProvider = NumistaProvider;
  window.LocalProvider = LocalProvider;
  window.showCatalogHistoryModal = showCatalogHistoryModal;
  window.hideCatalogHistoryModal = hideCatalogHistoryModal;
  window.recordCatalogHistory = recordCatalogHistory;
  window.loadCatalogHistory = loadCatalogHistory;
  window.saveCatalogHistory = saveCatalogHistory;
  window.showNumistaResults = showNumistaResults;
  window.fillFormFromNumistaResult = fillFormFromNumistaResult;
  window.closeNumistaResultsModal = closeNumistaResultsModal;
  window.renderNumistaUsageBar = renderNumistaUsageBar;
  window.renderPcgsUsageBar = renderPcgsUsageBar;
  window.renderCatalogHistoryForSettings = renderCatalogHistoryForSettings;
  window.clearCatalogHistory = clearCatalogHistory;
}

// Initialize UI event handlers when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
  // Numista API key input handler
  const numistaApiKeyInput = document.getElementById('numistaApiKey');
  const saveNumistaBtn = document.getElementById('saveNumistaBtn');
  const testNumistaBtn = document.getElementById('testNumistaBtn');
  const clearNumistaBtn = document.getElementById('clearNumistaBtn');

  if (numistaApiKeyInput) {
    // Load existing API key
    const existingConfig = catalogConfig.getNumistaConfig();
    if (existingConfig.apiKey) {
      numistaApiKeyInput.value = existingConfig.apiKey;
    }

    // Save API key when input changes
    numistaApiKeyInput.addEventListener('change', function() {
      const apiKey = this.value.trim();
      if (apiKey) {
        catalogConfig.setNumistaConfig(apiKey, 2000);
        catalogAPI.initializeProviders();
        console.log('âœ… Numista API key saved');
      }
    });
  }

  // Save key button
  if (saveNumistaBtn) {
    saveNumistaBtn.addEventListener('click', function() {
      const apiKey = numistaApiKeyInput?.value.trim();
      if (!apiKey) {
        alert('Please enter your Numista API key first');
        return;
      }
      catalogConfig.setNumistaConfig(apiKey, 2000);
      catalogAPI.initializeProviders();
      renderNumistaUsageBar();
      alert('Numista API key saved.');
    });
  }

  // Test connection button
  if (testNumistaBtn) {
    testNumistaBtn.addEventListener('click', async function() {
      const apiKey = numistaApiKeyInput?.value.trim();
      if (!apiKey) {
        alert('Please enter your Numista API key first');
        return;
      }

      // Save the key first
      catalogConfig.setNumistaConfig(apiKey, 2000);
      catalogAPI.initializeProviders();

      // Test the connection
      this.textContent = 'Testing...';
      this.disabled = true;

      try {
        const result = await testNumistaAPI();
        if (result) {
          renderNumistaUsageBar();
          alert('âœ… Numista API connection successful!');
        } else {
          alert('âŒ Numista API connection failed. Please check your API key.');
        }
      } catch (error) {
        alert('âŒ Connection failed: ' + error.message);
      } finally {
        this.textContent = 'Test Connection';
        this.disabled = false;
      }
    });
  }

  // Clear API key button
  if (clearNumistaBtn) {
    clearNumistaBtn.addEventListener('click', function() {
      if (confirm('Are you sure you want to clear your Numista API key?')) {
        catalogConfig.clearNumistaKey();
        if (numistaApiKeyInput) {
          numistaApiKeyInput.value = '';
        }
        catalogAPI.initializeProviders();
        console.log('ðŸ—‘ï¸ Numista API key cleared');
      }
    });
  }

  // =========================================================================
  // PCGS API â€” settings UI event wiring
  // =========================================================================

  const pcgsTokenInput = document.getElementById('pcgsBearerToken');
  const savePcgsBtn = document.getElementById('savePcgsBtn');
  const testPcgsBtn = document.getElementById('testPcgsBtn');
  const clearPcgsBtn = document.getElementById('clearPcgsBtn');
  const pcgsStatus = document.getElementById('pcgsStatus');

  if (pcgsTokenInput) {
    const existingPcgs = catalogConfig.getPcgsConfig();
    if (existingPcgs.bearerToken) {
      pcgsTokenInput.value = existingPcgs.bearerToken;
    }
  }

  if (savePcgsBtn) {
    savePcgsBtn.addEventListener('click', function() {
      const token = pcgsTokenInput?.value.trim();
      if (!token) {
        alert('Please enter your PCGS bearer token first');
        return;
      }
      catalogConfig.setPcgsConfig(token);
      if (pcgsStatus) pcgsStatus.textContent = 'Token saved.';
      // Update provider status indicator and header status row
      const statusEl = document.getElementById('pcgsProviderStatus');
      if (statusEl) {
        statusEl.querySelector('.status-dot')?.classList.add('connected');
        const txt = statusEl.querySelector('.status-text');
        if (txt) txt.textContent = 'Connected';
      }
      if (typeof renderApiStatusSummary === 'function') renderApiStatusSummary();
      renderPcgsUsageBar();
      alert('PCGS bearer token saved.');
    });
  }

  if (testPcgsBtn) {
    testPcgsBtn.addEventListener('click', async function() {
      const token = pcgsTokenInput?.value.trim();
      if (!token) {
        alert('Please enter your PCGS bearer token first');
        return;
      }

      // Save first
      catalogConfig.setPcgsConfig(token);

      this.textContent = 'Testing...';
      this.disabled = true;

      try {
        if (typeof verifyPcgsCert === 'function') {
          const result = await verifyPcgsCert('00000000');
          // Even a "not found" response means the API is reachable
          if (pcgsStatus) pcgsStatus.textContent = 'Connected â€” API reachable.';
          alert('PCGS API connection successful!');
        } else {
          if (pcgsStatus) pcgsStatus.textContent = 'pcgs-api.js not loaded.';
          alert('PCGS API module not loaded. Ensure pcgs-api.js is included.');
        }
      } catch (error) {
        const msg = error.message || 'Unknown error';
        if (pcgsStatus) pcgsStatus.textContent = 'Connection failed: ' + msg;
        alert('PCGS API connection failed: ' + msg);
      } finally {
        this.textContent = 'Test Connection';
        this.disabled = false;
      }
    });
  }

  if (clearPcgsBtn) {
    clearPcgsBtn.addEventListener('click', function() {
      if (confirm('Are you sure you want to clear your PCGS bearer token?')) {
        catalogConfig.clearPcgsToken();
        if (pcgsTokenInput) pcgsTokenInput.value = '';
        if (pcgsStatus) pcgsStatus.textContent = 'Token cleared.';
        // Update provider status indicator and header status row
        const statusEl = document.getElementById('pcgsProviderStatus');
        if (statusEl) {
          statusEl.querySelector('.status-dot')?.classList.remove('connected');
          const txt = statusEl.querySelector('.status-text');
          if (txt) txt.textContent = 'Disconnected';
        }
        if (typeof renderApiStatusSummary === 'function') renderApiStatusSummary();
      }
    });
  }

  // =========================================================================
  // NUMISTA RESULTS MODAL â€” event wiring
  // =========================================================================

  const numistaResultsModal = document.getElementById('numistaResultsModal');
  const numistaResultsCloseBtn = document.getElementById('numistaResultsCloseBtn');
  const numistaFillCancelBtn = document.getElementById('numistaFillCancelBtn');
  const numistaFillBtn = document.getElementById('numistaFillBtn');
  const numistaResultsList = document.getElementById('numistaResultsList');

  // Close button
  if (numistaResultsCloseBtn) {
    numistaResultsCloseBtn.addEventListener('click', closeNumistaResultsModal);
  }

  // Cancel button in field picker
  if (numistaFillCancelBtn) {
    numistaFillCancelBtn.addEventListener('click', closeNumistaResultsModal);
  }

  // Fill Fields button
  if (numistaFillBtn) {
    numistaFillBtn.addEventListener('click', function() {
      if (selectedNumistaResult) {
        fillFormFromNumistaResult();

        // Fire-and-forget: cache images + metadata in IndexedDB
        if (window.imageCache?.isAvailable() &amp;&amp; selectedNumistaResult.catalogId &amp;&amp;
            window.featureFlags?.isEnabled('COIN_IMAGES')) {
          imageCache.cacheImages(
            selectedNumistaResult.catalogId,
            selectedNumistaResult.imageUrl || '',
            selectedNumistaResult.reverseImageUrl || ''
          ).catch(e => console.warn('Image cache failed:', e));
          imageCache.cacheMetadata(
            selectedNumistaResult.catalogId,
            selectedNumistaResult
          ).catch(e => console.warn('Metadata cache failed:', e));
        }
      }
      closeNumistaResultsModal();
    });
  }

  // Delegated click on result cards â†’ select and show field picker
  if (numistaResultsList) {
    numistaResultsList.addEventListener('click', function(e) {
      const card = e.target.closest('.numista-result-card');
      if (!card) return;

      const index = parseInt(card.dataset.resultIndex, 10);
      const results = numistaResultsList._numistaResults;
      if (!results || !results[index]) return;

      // Highlight selected card
      numistaResultsList.querySelectorAll('.numista-result-card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');

      // Transition to field picker
      selectedNumistaResult = results[index];
      const preview = document.getElementById('numistaSelectedItem');
      const picker = document.getElementById('numistaFieldPicker');
      const title = document.getElementById('numistaResultsTitle');
      // nosemgrep: javascript.browser.security.insecure-innerhtml.insecure-innerhtml, javascript.browser.security.insecure-document-method.insecure-document-method
      if (preview) preview.innerHTML = renderNumistaSelectedItem(selectedNumistaResult);
      renderNumistaFieldCheckboxes(selectedNumistaResult);
      if (numistaResultsList) numistaResultsList.style.display = 'none';
      if (picker) picker.style.display = 'block';
      if (title) title.textContent = 'Fill Form Fields';
    });
  }

  // Background click dismiss
  if (numistaResultsModal) {
    numistaResultsModal.addEventListener('click', function(e) {
      if (e.target === numistaResultsModal) {
        closeNumistaResultsModal();
      }
    });
  }

  // ESC key handler â€” results modal has higher z-index, check it first
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      const resultsModal = document.getElementById('numistaResultsModal');
      if (resultsModal &amp;&amp; resultsModal.style.display !== 'none') {
        e.stopImmediatePropagation();
        closeNumistaResultsModal();
      }
    }
  });
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CatalogAPI.html">CatalogAPI</a></li><li><a href="CatalogConfig.html">CatalogConfig</a></li><li><a href="CatalogManager.html">CatalogManager</a></li><li><a href="CatalogProvider.html">CatalogProvider</a></li><li><a href="FeatureFlags.html">FeatureFlags</a></li><li><a href="ImageCache.html">ImageCache</a></li><li><a href="ImageProcessor.html">ImageProcessor</a></li><li><a href="LocalProvider.html">LocalProvider</a></li><li><a href="NumistaCatalogProvider.html">NumistaCatalogProvider</a></li><li><a href="NumistaProvider.html">NumistaProvider</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ACK_DISMISSED_KEY">ACK_DISMISSED_KEY</a></li><li><a href="global.html#API_CACHE_KEY">API_CACHE_KEY</a></li><li><a href="global.html#API_KEY_STORAGE_KEY">API_KEY_STORAGE_KEY</a></li><li><a href="global.html#API_PROVIDERS">API_PROVIDERS</a></li><li><a href="global.html#APP_VERSION">APP_VERSION</a></li><li><a href="global.html#APP_VERSION_KEY">APP_VERSION_KEY</a></li><li><a href="global.html#AUTOCOMPLETE_CONFIG">AUTOCOMPLETE_CONFIG</a></li><li><a href="global.html#BRANDING_DOMAIN_OPTIONS">BRANDING_DOMAIN_OPTIONS</a></li><li><a href="global.html#BRANDING_DOMAIN_OVERRIDE">BRANDING_DOMAIN_OVERRIDE</a></li><li><a href="global.html#BRANDING_TITLE">BRANDING_TITLE</a></li><li><a href="global.html#CARD_STYLE_KEY">CARD_STYLE_KEY</a></li><li><a href="global.html#CATALOG_HISTORY_KEY">CATALOG_HISTORY_KEY</a></li><li><a href="global.html#CATALOG_MAP_KEY">CATALOG_MAP_KEY</a></li><li><a href="global.html#CERT_LOOKUP_URLS">CERT_LOOKUP_URLS</a></li><li><a href="global.html#CLOUD_PROVIDERS">CLOUD_PROVIDERS</a></li><li><a href="global.html#DEBUG">DEBUG</a></li><li><a href="global.html#DEFAULT_API_CACHE_DURATION">DEFAULT_API_CACHE_DURATION</a></li><li><a href="global.html#DEFAULT_API_QUOTA">DEFAULT_API_QUOTA</a></li><li><a href="global.html#DEFAULT_CURRENCY">DEFAULT_CURRENCY</a></li><li><a href="global.html#DEFAULT_SORT_COL_KEY">DEFAULT_SORT_COL_KEY</a></li><li><a href="global.html#DEFAULT_SORT_DIR_KEY">DEFAULT_SORT_DIR_KEY</a></li><li><a href="global.html#DESKTOP_CARD_VIEW_KEY">DESKTOP_CARD_VIEW_KEY</a></li><li><a href="global.html#DEV_MODE">DEV_MODE</a></li><li><a href="global.html#DISPLAY_CURRENCY_KEY">DISPLAY_CURRENCY_KEY</a></li><li><a href="global.html#EXCHANGE_RATES_KEY">EXCHANGE_RATES_KEY</a></li><li><a href="global.html#EXCHANGE_RATE_API_URL">EXCHANGE_RATE_API_URL</a></li><li><a href="global.html#FALLBACK_EXCHANGE_RATES">FALLBACK_EXCHANGE_RATES</a></li><li><a href="global.html#FEATURE_FLAGS">FEATURE_FLAGS</a></li><li><a href="global.html#FEATURE_FLAGS_KEY">FEATURE_FLAGS_KEY</a></li><li><a href="global.html#FIELD_COERCIONS">FIELD_COERCIONS</a></li><li><a href="global.html#FILTER_CHIP_CATEGORY_DEFAULTS">FILTER_CHIP_CATEGORY_DEFAULTS</a></li><li><a href="global.html#GB_ESTIMATE_MODIFIER_KEY">GB_ESTIMATE_MODIFIER_KEY</a></li><li><a href="global.html#GB_ESTIMATE_PREMIUM">GB_ESTIMATE_PREMIUM</a></li><li><a href="global.html#GB_TO_OZT">GB_TO_OZT</a></li><li><a href="global.html#GITHUB_RELEASES_URL">GITHUB_RELEASES_URL</a></li><li><a href="global.html#GOLDBACK_DENOMINATIONS">GOLDBACK_DENOMINATIONS</a></li><li><a href="global.html#GOLDBACK_ENABLED_KEY">GOLDBACK_ENABLED_KEY</a></li><li><a href="global.html#GOLDBACK_ESTIMATE_ENABLED_KEY">GOLDBACK_ESTIMATE_ENABLED_KEY</a></li><li><a href="global.html#GOLDBACK_PRICES_KEY">GOLDBACK_PRICES_KEY</a></li><li><a href="global.html#GOLDBACK_PRICE_HISTORY_KEY">GOLDBACK_PRICE_HISTORY_KEY</a></li><li><a href="global.html#HEADER_SYNC_BTN_KEY">HEADER_SYNC_BTN_KEY</a></li><li><a href="global.html#HEADER_TREND_BTN_KEY">HEADER_TREND_BTN_KEY</a></li><li><a href="global.html#IMAGE_MAX_BYTES">IMAGE_MAX_BYTES</a></li><li><a href="global.html#IMAGE_MAX_DIM">IMAGE_MAX_DIM</a></li><li><a href="global.html#IMAGE_QUALITY">IMAGE_QUALITY</a></li><li><a href="global.html#INLINE_CHIP_DEFAULTS">INLINE_CHIP_DEFAULTS</a></li><li><a href="global.html#ITEMS_PER_PAGE_KEY">ITEMS_PER_PAGE_KEY</a></li><li><a href="global.html#ITEM_PRICE_HISTORY_KEY">ITEM_PRICE_HISTORY_KEY</a></li><li><a href="global.html#ITEM_TAGS_KEY">ITEM_TAGS_KEY</a></li><li><a href="global.html#LAST_API_SYNC_KEY">LAST_API_SYNC_KEY</a></li><li><a href="global.html#LAST_CACHE_REFRESH_KEY">LAST_CACHE_REFRESH_KEY</a></li><li><a href="global.html#LAST_VERSION_CHECK_KEY">LAST_VERSION_CHECK_KEY</a></li><li><a href="global.html#LATEST_REMOTE_URL_KEY">LATEST_REMOTE_URL_KEY</a></li><li><a href="global.html#LATEST_REMOTE_VERSION_KEY">LATEST_REMOTE_VERSION_KEY</a></li><li><a href="global.html#LAYOUT_SECTION_DEFAULTS">LAYOUT_SECTION_DEFAULTS</a></li><li><a href="global.html#LOG_TAB_RENDERERS">LOG_TAB_RENDERERS</a></li><li><a href="global.html#LS_KEY">LS_KEY</a></li><li><a href="global.html#MAX_LOCAL_FILE_SIZE">MAX_LOCAL_FILE_SIZE</a></li><li><a href="global.html#MAX_TAGS_PER_ITEM">MAX_TAGS_PER_ITEM</a></li><li><a href="global.html#MAX_TAG_LENGTH">MAX_TAG_LENGTH</a></li><li><a href="global.html#METALS">METALS</a></li><li><a href="global.html#METAL_COLORS">METAL_COLORS</a></li><li><a href="global.html#METAL_ORDER_KEY">METAL_ORDER_KEY</a></li><li><a href="global.html#METAL_SYMBOLS">METAL_SYMBOLS</a></li><li><a href="global.html#NUMISTA_VIEW_FIELD_DEFAULTS">NUMISTA_VIEW_FIELD_DEFAULTS</a></li><li><a href="global.html#NumistaLookup">NumistaLookup</a></li><li><a href="global.html#PREBUILT_LOOKUP_DATA">PREBUILT_LOOKUP_DATA</a></li><li><a href="global.html#PRICE_HISTORY_COLS">PRICE_HISTORY_COLS</a></li><li><a href="global.html#Remote">Remote</a></li><li><a href="global.html#SEED_CUSTOM_RULES">SEED_CUSTOM_RULES</a></li><li><a href="global.html#SEED_DATA_YEARS">SEED_DATA_YEARS</a></li><li><a href="global.html#SEED_IMAGES_VERSION">SEED_IMAGES_VERSION</a></li><li><a href="global.html#SEED_INVENTORY_ITEMS">SEED_INVENTORY_ITEMS</a></li><li><a href="global.html#SERIAL_KEY">SERIAL_KEY</a></li><li><a href="global.html#SPOT_COMPARE_MODE_KEY">SPOT_COMPARE_MODE_KEY</a></li><li><a href="global.html#SPOT_HISTORY_KEY">SPOT_HISTORY_KEY</a></li><li><a href="global.html#SPOT_TREND_KEY">SPOT_TREND_KEY</a></li><li><a href="global.html#SPOT_TREND_RANGE_KEY">SPOT_TREND_RANGE_KEY</a></li><li><a href="global.html#STORAGE_KEY_LABELS">STORAGE_KEY_LABELS</a></li><li><a href="global.html#STORAGE_TINY_THRESHOLD_KB">STORAGE_TINY_THRESHOLD_KB</a></li><li><a href="global.html#SUPPORTED_CURRENCIES">SUPPORTED_CURRENCIES</a></li><li><a href="global.html#SYNC_FILE_PATH">SYNC_FILE_PATH</a></li><li><a href="global.html#SYNC_META_PATH">SYNC_META_PATH</a></li><li><a href="global.html#SYNC_POLL_INTERVAL">SYNC_POLL_INTERVAL</a></li><li><a href="global.html#SYNC_PUSH_DEBOUNCE">SYNC_PUSH_DEBOUNCE</a></li><li><a href="global.html#SYNC_SCOPE_KEYS">SYNC_SCOPE_KEYS</a></li><li><a href="global.html#THEME_KEY">THEME_KEY</a></li><li><a href="global.html#TIMEZONE_KEY">TIMEZONE_KEY</a></li><li><a href="global.html#TREND_PRESETS">TREND_PRESETS</a></li><li><a href="global.html#VALID_TYPES">VALID_TYPES</a></li><li><a href="global.html#VAULT_FILE_EXTENSION">VAULT_FILE_EXTENSION</a></li><li><a href="global.html#VERSION_ACK_KEY">VERSION_ACK_KEY</a></li><li><a href="global.html#VERSION_CHECK_TTL">VERSION_CHECK_TTL</a></li><li><a href="global.html#VERSION_CHECK_URL">VERSION_CHECK_URL</a></li><li><a href="global.html#VIEW_METADATA_TTL">VIEW_METADATA_TTL</a></li><li><a href="global.html#VIEW_MODAL_SECTION_DEFAULTS">VIEW_MODAL_SECTION_DEFAULTS</a></li><li><a href="global.html#_VIEW_CHART_DEFAULT_RANGE">_VIEW_CHART_DEFAULT_RANGE</a></li><li><a href="global.html#_VIEW_CHART_RANGES">_VIEW_CHART_RANGES</a></li><li><a href="global.html#_VIEW_CHART_RANGE_LABELS">_VIEW_CHART_RANGE_LABELS</a></li><li><a href="global.html#__ST_COMP_PREFIX">__ST_COMP_PREFIX</a></li><li><a href="global.html#_addDetail">_addDetail</a></li><li><a href="global.html#_applyTrend">_applyTrend</a></li><li><a href="global.html#_cardChipsHTML">_cardChipsHTML</a></li><li><a href="global.html#_cardClickBound">_cardClickBound</a></li><li><a href="global.html#_cardFmt">_cardFmt</a></li><li><a href="global.html#_cardImageHTML">_cardImageHTML</a></li><li><a href="global.html#_cardMetalClass">_cardMetalClass</a></li><li><a href="global.html#_cardSortBarBound">_cardSortBarBound</a></li><li><a href="global.html#_cloudBackupWithCachedPw">_cloudBackupWithCachedPw</a></li><li><a href="global.html#_cloudBtnAction">_cloudBtnAction</a></li><li><a href="global.html#_cloudContext">_cloudContext</a></li><li><a href="global.html#_cloudRestoreWithCachedPw">_cloudRestoreWithCachedPw</a></li><li><a href="global.html#_computePortfolioSummary">_computePortfolioSummary</a></li><li><a href="global.html#_createPriceHistoryChart">_createPriceHistoryChart</a></li><li><a href="global.html#_cvBlobUrls">_cvBlobUrls</a></li><li><a href="global.html#_cvChartInstances">_cvChartInstances</a></li><li><a href="global.html#_cvEscapeAttr">_cvEscapeAttr</a></li><li><a href="global.html#_cvImageObserver">_cvImageObserver</a></li><li><a href="global.html#_darkenColor">_darkenColor</a></li><li><a href="global.html#_dataToPolylineScaled">_dataToPolylineScaled</a></li><li><a href="global.html#_deleteObverseOnSave">_deleteObverseOnSave</a></li><li><a href="global.html#_deleteReverseOnSave">_deleteReverseOnSave</a></li><li><a href="global.html#_detailItem">_detailItem</a></li><li><a href="global.html#_el">_el</a></li><li><a href="global.html#_enhanceCardImages">_enhanceCardImages</a></li><li><a href="global.html#_enhanceTableThumbnails">_enhanceTableThumbnails</a></li><li><a href="global.html#_extractMetadata">_extractMetadata</a></li><li><a href="global.html#_fetchHistoricalSpotData">_fetchHistoricalSpotData</a></li><li><a href="global.html#_fetchNumistaResult">_fetchNumistaResult</a></li><li><a href="global.html#_fetchYearFile">_fetchYearFile</a></li><li><a href="global.html#_getBulkImageSides">_getBulkImageSides</a></li><li><a href="global.html#_getOrCreateHScrollBar">_getOrCreateHScrollBar</a></li><li><a href="global.html#_getThumbPlaceholder">_getThumbPlaceholder</a></li><li><a href="global.html#_getViewMetrics">_getViewMetrics</a></li><li><a href="global.html#_hScrollWired">_hScrollWired</a></li><li><a href="global.html#_imageSlot">_imageSlot</a></li><li><a href="global.html#_initCardCharts">_initCardCharts</a></li><li><a href="global.html#_initSpotControls">_initSpotControls</a></li><li><a href="global.html#_interpolateNulls">_interpolateNulls</a></li><li><a href="global.html#_isLightColor">_isLightColor</a></li><li><a href="global.html#_itemPriceModalFilterText">_itemPriceModalFilterText</a></li><li><a href="global.html#_itemPriceModalUuid">_itemPriceModalUuid</a></li><li><a href="global.html#_loadBulkRowImages">_loadBulkRowImages</a></li><li><a href="global.html#_loadCardImage">_loadCardImage</a></li><li><a href="global.html#_loadSectionConfig">_loadSectionConfig</a></li><li><a href="global.html#_loadThumbImage">_loadThumbImage</a></li><li><a href="global.html#_normalizePatterns">_normalizePatterns</a></li><li><a href="global.html#_openBulkImagePopover">_openBulkImagePopover</a></li><li><a href="global.html#_openExternalPopup">_openExternalPopup</a></li><li><a href="global.html#_openThumbPopover">_openThumbPopover</a></li><li><a href="global.html#_parseColor">_parseColor</a></li><li><a href="global.html#_patternMode">_patternMode</a></li><li><a href="global.html#_pendingObverseBlob">_pendingObverseBlob</a></li><li><a href="global.html#_pendingObversePreviewUrl">_pendingObversePreviewUrl</a></li><li><a href="global.html#_pendingReverseBlob">_pendingReverseBlob</a></li><li><a href="global.html#_pendingReversePreviewUrl">_pendingReversePreviewUrl</a></li><li><a href="global.html#_renderSectionConfigTable">_renderSectionConfigTable</a></li><li><a href="global.html#_renderSortBarSummary">_renderSortBarSummary</a></li><li><a href="global.html#_restoreCdnFolderFromZip">_restoreCdnFolderFromZip</a></li><li><a href="global.html#_saveSectionConfig">_saveSectionConfig</a></li><li><a href="global.html#_schedulePoll">_schedulePoll</a></li><li><a href="global.html#_section">_section</a></li><li><a href="global.html#_setSlotImage">_setSlotImage</a></li><li><a href="global.html#_showCardImage">_showCardImage</a></li><li><a href="global.html#_statusCells">_statusCells</a></li><li><a href="global.html#_storageTinyVisible">_storageTinyVisible</a></li><li><a href="global.html#_storedSortCol">_storedSortCol</a></li><li><a href="global.html#_syncFallbackUUID">_syncFallbackUUID</a></li><li><a href="global.html#_syncHScrollBar">_syncHScrollBar</a></li><li><a href="global.html#_syncPollerTimer">_syncPollerTimer</a></li><li><a href="global.html#_syncProvider">_syncProvider</a></li><li><a href="global.html#_syncPushInFlight">_syncPushInFlight</a></li><li><a href="global.html#_syncRelativeTime">_syncRelativeTime</a></li><li><a href="global.html#_syncRetryDelay">_syncRetryDelay</a></li><li><a href="global.html#_syncSortBar">_syncSortBar</a></li><li><a href="global.html#_thumbBlobUrls">_thumbBlobUrls</a></li><li><a href="global.html#_thumbObserver">_thumbObserver</a></li><li><a href="global.html#_updateHScrollThumb">_updateHScrollThumb</a></li><li><a href="global.html#_vaultPendingFile">_vaultPendingFile</a></li><li><a href="global.html#_viewModalChartInstance">_viewModalChartInstance</a></li><li><a href="global.html#_viewModalObjectUrls">_viewModalObjectUrls</a></li><li><a href="global.html#_viewYearCache">_viewYearCache</a></li><li><a href="global.html#_viewYearFetchPromises">_viewYearFetchPromises</a></li><li><a href="global.html#acceptAck">acceptAck</a></li><li><a href="global.html#activeFilters">activeFilters</a></li><li><a href="global.html#addCompositionOption">addCompositionOption</a></li><li><a href="global.html#addItemTag">addItemTag</a></li><li><a href="global.html#analyzeStorageData">analyzeStorageData</a></li><li><a href="global.html#analyzeStorageItem">analyzeStorageItem</a></li><li><a href="global.html#apiCache">apiCache</a></li><li><a href="global.html#apiConfig">apiConfig</a></li><li><a href="global.html#apiHistoryEntries">apiHistoryEntries</a></li><li><a href="global.html#apiHistoryFilterText">apiHistoryFilterText</a></li><li><a href="global.html#apiHistorySortAsc">apiHistorySortAsc</a></li><li><a href="global.html#apiHistorySortColumn">apiHistorySortColumn</a></li><li><a href="global.html#applyColumnFilter">applyColumnFilter</a></li><li><a href="global.html#applyHeaderToggleVisibility">applyHeaderToggleVisibility</a></li><li><a href="global.html#applyLayoutOrder">applyLayoutOrder</a></li><li><a href="global.html#applyMetalOrder">applyMetalOrder</a></li><li><a href="global.html#applyMinCountThreshold">applyMinCountThreshold</a></li><li><a href="global.html#applyNumistaTags">applyNumistaTags</a></li><li><a href="global.html#applyQuickFilter">applyQuickFilter</a></li><li><a href="global.html#attachAutocomplete">attachAutocomplete</a></li><li><a href="global.html#attachPriceHistorySortHeaders">attachPriceHistorySortHeaders</a></li><li><a href="global.html#autoSelectDefaultProvider">autoSelectDefaultProvider</a></li><li><a href="global.html#autoSyncSpotPrices">autoSyncSpotPrices</a></li><li><a href="global.html#backfillStaktrakrHourly">backfillStaktrakrHourly</a></li><li><a href="global.html#bindAppearanceAndHeaderListeners">bindAppearanceAndHeaderListeners</a></li><li><a href="global.html#bindCardAndTableImageListeners">bindCardAndTableImageListeners</a></li><li><a href="global.html#bindCardClickHandler">bindCardClickHandler</a></li><li><a href="global.html#bindCloudCacheListeners">bindCloudCacheListeners</a></li><li><a href="global.html#bindFilterAndNumistaListeners">bindFilterAndNumistaListeners</a></li><li><a href="global.html#bindGoldbackActionListeners">bindGoldbackActionListeners</a></li><li><a href="global.html#bindGoldbackToggleListeners">bindGoldbackToggleListeners</a></li><li><a href="global.html#bindImageImportExportListeners">bindImageImportExportListeners</a></li><li><a href="global.html#bindImageSettingsListeners">bindImageSettingsListeners</a></li><li><a href="global.html#bindImageSyncListeners">bindImageSyncListeners</a></li><li><a href="global.html#bindLbmaHistoryControls">bindLbmaHistoryControls</a></li><li><a href="global.html#bindNumistaBulkSyncListeners">bindNumistaBulkSyncListeners</a></li><li><a href="global.html#bindPatternRuleModeListeners">bindPatternRuleModeListeners</a></li><li><a href="global.html#bindSettingsModalShellListeners">bindSettingsModalShellListeners</a></li><li><a href="global.html#bindSettingsNavigationListeners">bindSettingsNavigationListeners</a></li><li><a href="global.html#bindStorageListeners">bindStorageListeners</a></li><li><a href="global.html#blobToWebP">blobToWebP</a></li><li><a href="global.html#brandingWarned">brandingWarned</a></li><li><a href="global.html#buildBulkItemRow">buildBulkItemRow</a></li><li><a href="global.html#buildImageExportZip">buildImageExportZip</a></li><li><a href="global.html#buildItemFields">buildItemFields</a></li><li><a href="global.html#buildNumistaSearchQuery">buildNumistaSearchQuery</a></li><li><a href="global.html#buildSearchIndices">buildSearchIndices</a></li><li><a href="global.html#buildTagSection">buildTagSection</a></li><li><a href="global.html#buildViewContent">buildViewContent</a></li><li><a href="global.html#cacheLookupTable">cacheLookupTable</a></li><li><a href="global.html#calculateApiUsage">calculateApiUsage</a></li><li><a href="global.html#calculateLevenshteinDistance">calculateLevenshteinDistance</a></li><li><a href="global.html#calculateRetailPrice">calculateRetailPrice</a></li><li><a href="global.html#catalogHistory">catalogHistory</a></li><li><a href="global.html#catalogMap">catalogMap</a></li><li><a href="global.html#changeLog">changeLog</a></li><li><a href="global.html#chartInstances">chartInstances</a></li><li><a href="global.html#checkFileSize">checkFileSize</a></li><li><a href="global.html#checkRemoteVersion">checkRemoteVersion</a></li><li><a href="global.html#checkVersionChange">checkVersionChange</a></li><li><a href="global.html#cleanOrphanedItemPriceHistory">cleanOrphanedItemPriceHistory</a></li><li><a href="global.html#cleanSearchTerm">cleanSearchTerm</a></li><li><a href="global.html#cleanString">cleanString</a></li><li><a href="global.html#cleanupStorage">cleanupStorage</a></li><li><a href="global.html#clearAllCachedData">clearAllCachedData</a></li><li><a href="global.html#clearAllFilters">clearAllFilters</a></li><li><a href="global.html#clearApiCache">clearApiCache</a></li><li><a href="global.html#clearApiConfig">clearApiConfig</a></li><li><a href="global.html#clearApiHistory">clearApiHistory</a></li><li><a href="global.html#clearApiKey">clearApiKey</a></li><li><a href="global.html#clearCatalogHistory">clearCatalogHistory</a></li><li><a href="global.html#clearChangeLog">clearChangeLog</a></li><li><a href="global.html#clearItemPriceHistory">clearItemPriceHistory</a></li><li><a href="global.html#clearLookupCache">clearLookupCache</a></li><li><a href="global.html#clearSpotHistory">clearSpotHistory</a></li><li><a href="global.html#clearUploadState">clearUploadState</a></li><li><a href="global.html#closeCurrencyDropdown">closeCurrencyDropdown</a></li><li><a href="global.html#closeCurrencyDropdownOnOutside">closeCurrencyDropdownOnOutside</a></li><li><a href="global.html#closeDetailsModal">closeDetailsModal</a></li><li><a href="global.html#closeModalById">closeModalById</a></li><li><a href="global.html#closeNumistaResultsModal">closeNumistaResultsModal</a></li><li><a href="global.html#closePcgsFieldPicker">closePcgsFieldPicker</a></li><li><a href="global.html#closeSpotLookupModal">closeSpotLookupModal</a></li><li><a href="global.html#closeVaultModal">closeVaultModal</a></li><li><a href="global.html#closeViewModal">closeViewModal</a></li><li><a href="global.html#cloudBackupEnabled">cloudBackupEnabled</a></li><li><a href="global.html#coerceFieldValue">coerceFieldValue</a></li><li><a href="global.html#collectVaultData">collectVaultData</a></li><li><a href="global.html#commitItemToInventory">commitItemToInventory</a></li><li><a href="global.html#compareVersions">compareVersions</a></li><li><a href="global.html#compositionOptions">compositionOptions</a></li><li><a href="global.html#computeGoldbackEstimatedRate">computeGoldbackEstimatedRate</a></li><li><a href="global.html#computeItemValuation">computeItemValuation</a></li><li><a href="global.html#computeMeltValue">computeMeltValue</a></li><li><a href="global.html#convertToUsd">convertToUsd</a></li><li><a href="global.html#createBackupData">createBackupData</a></li><li><a href="global.html#createBackupZip">createBackupZip</a></li><li><a href="global.html#createBreakdownElements">createBreakdownElements</a></li><li><a href="global.html#createDummyElement">createDummyElement</a></li><li><a href="global.html#createEmptyLookupTable">createEmptyLookupTable</a></li><li><a href="global.html#createFieldInput">createFieldInput</a></li><li><a href="global.html#createPieChart">createPieChart</a></li><li><a href="global.html#createStorageItemModal">createStorageItemModal</a></li><li><a href="global.html#createThumbEl">createThumbEl</a></li><li><a href="global.html#currentLookupTable">currentLookupTable</a></li><li><a href="global.html#currentMonthKey">currentMonthKey</a></li><li><a href="global.html#cycleSpotTrend">cycleSpotTrend</a></li><li><a href="global.html#dataToPolyline">dataToPolyline</a></li><li><a href="global.html#dataUriToBlob">dataUriToBlob</a></li><li><a href="global.html#debounce">debounce</a></li><li><a href="global.html#debugError">debugError</a></li><li><a href="global.html#debugLog">debugLog</a></li><li><a href="global.html#debugWarn">debugWarn</a></li><li><a href="global.html#deleteItem">deleteItem</a></li><li><a href="global.html#deleteItemPriceEntry">deleteItemPriceEntry</a></li><li><a href="global.html#deleteItemTags">deleteItemTags</a></li><li><a href="global.html#deleteTagGlobal">deleteTagGlobal</a></li><li><a href="global.html#deriveSearchLabel">deriveSearchLabel</a></li><li><a href="global.html#destroyCharts">destroyCharts</a></li><li><a href="global.html#destroySparklines">destroySparklines</a></li><li><a href="global.html#detailsChartMetric">detailsChartMetric</a></li><li><a href="global.html#detailsResizeObserver">detailsResizeObserver</a></li><li><a href="global.html#detectCurrency">detectCurrency</a></li><li><a href="global.html#disableCloudSync">disableCloudSync</a></li><li><a href="global.html#dismissAllAutocompletes">dismissAllAutocompletes</a></li><li><a href="global.html#dismissNotesModal">dismissNotesModal</a></li><li><a href="global.html#displayCurrency">displayCurrency</a></li><li><a href="global.html#downloadCompleteBackup">downloadCompleteBackup</a></li><li><a href="global.html#downloadFile">downloadFile</a></li><li><a href="global.html#downloadStorageReport">downloadStorageReport</a></li><li><a href="global.html#duplicateItem">duplicateItem</a></li><li><a href="global.html#editItem">editItem</a></li><li><a href="global.html#editingChangeLogIndex">editingChangeLogIndex</a></li><li><a href="global.html#editingIndex">editingIndex</a></li><li><a href="global.html#elements">elements</a></li><li><a href="global.html#enableCloudSync">enableCloudSync</a></li><li><a href="global.html#escapeAttribute">escapeAttribute</a></li><li><a href="global.html#escapeHtml">escapeHtml</a></li><li><a href="global.html#escapeHtmlCatalog">escapeHtmlCatalog</a></li><li><a href="global.html#escapeHtmlPcgs">escapeHtmlPcgs</a></li><li><a href="global.html#exchangeRates">exchangeRates</a></li><li><a href="global.html#exportCsv">exportCsv</a></li><li><a href="global.html#exportEncryptedBackup">exportEncryptedBackup</a></li><li><a href="global.html#exportGoldbackHistory">exportGoldbackHistory</a></li><li><a href="global.html#exportJson">exportJson</a></li><li><a href="global.html#exportNumistaCsv">exportNumistaCsv</a></li><li><a href="global.html#exportPdf">exportPdf</a></li><li><a href="global.html#exportSpotHistory">exportSpotHistory</a></li><li><a href="global.html#extractUniqueValues">extractUniqueValues</a></li><li><a href="global.html#featureFlags">featureFlags</a></li><li><a href="global.html#fetchBatchSpotPrices">fetchBatchSpotPrices</a></li><li><a href="global.html#fetchExchangeRates">fetchExchangeRates</a></li><li><a href="global.html#fetchHistoryBatched">fetchHistoryBatched</a></li><li><a href="global.html#fetchLatestPrices">fetchLatestPrices</a></li><li><a href="global.html#fetchMetalPriceApiHourly">fetchMetalPriceApiHourly</a></li><li><a href="global.html#fetchSpotForDate">fetchSpotForDate</a></li><li><a href="global.html#fetchSpotPrice">fetchSpotPrice</a></li><li><a href="global.html#fetchSpotPricesFromApi">fetchSpotPricesFromApi</a></li><li><a href="global.html#fetchStaktrakrHourlyRange">fetchStaktrakrHourlyRange</a></li><li><a href="global.html#fetchStaktrakrPrices">fetchStaktrakrPrices</a></li><li><a href="global.html#fetchYearFile">fetchYearFile</a></li><li><a href="global.html#fillFormFromNumistaResult">fillFormFromNumistaResult</a></li><li><a href="global.html#fillFormFromPcgsResult">fillFormFromPcgsResult</a></li><li><a href="global.html#filterInventory">filterInventory</a></li><li><a href="global.html#filterInventoryAdvanced">filterInventoryAdvanced</a></li><li><a href="global.html#filterItemPriceHistoryTable">filterItemPriceHistoryTable</a></li><li><a href="global.html#flattenGoldbackHistory">flattenGoldbackHistory</a></li><li><a href="global.html#formatCurrency">formatCurrency</a></li><li><a href="global.html#formatDateOnly">formatDateOnly</a></li><li><a href="global.html#formatDisplayDate">formatDisplayDate</a></li><li><a href="global.html#formatFileSize">formatFileSize</a></li><li><a href="global.html#formatLossProfit">formatLossProfit</a></li><li><a href="global.html#formatOffsetLabel">formatOffsetLabel</a></li><li><a href="global.html#formatPurchaseLocation">formatPurchaseLocation</a></li><li><a href="global.html#formatStorageLocation">formatStorageLocation</a></li><li><a href="global.html#formatTimeOnly">formatTimeOnly</a></li><li><a href="global.html#formatTimestamp">formatTimestamp</a></li><li><a href="global.html#formatWeight">formatWeight</a></li><li><a href="global.html#fuzzyMatch">fuzzyMatch</a></li><li><a href="global.html#fuzzySearch">fuzzySearch</a></li><li><a href="global.html#gbHistoryFilterText">gbHistoryFilterText</a></li><li><a href="global.html#gbHistorySortAsc">gbHistorySortAsc</a></li><li><a href="global.html#gbHistorySortColumn">gbHistorySortColumn</a></li><li><a href="global.html#generateBackupHtml">generateBackupHtml</a></li><li><a href="global.html#generateCategorySummary">generateCategorySummary</a></li><li><a href="global.html#generateColors">generateColors</a></li><li><a href="global.html#generateItemDataTable">generateItemDataTable</a></li><li><a href="global.html#generateLookupTable">generateLookupTable</a></li><li><a href="global.html#generateNGrams">generateNGrams</a></li><li><a href="global.html#generateReadmeContent">generateReadmeContent</a></li><li><a href="global.html#generateSparklineSVG">generateSparklineSVG</a></li><li><a href="global.html#generateStorageReport">generateStorageReport</a></li><li><a href="global.html#generateStorageReportHTML">generateStorageReportHTML</a></li><li><a href="global.html#generateStorageReportTar">generateStorageReportTar</a></li><li><a href="global.html#generateUUID">generateUUID</a></li><li><a href="global.html#generateVariations">generateVariations</a></li><li><a href="global.html#get24hChange">get24hChange</a></li><li><a href="global.html#getAllMetalsBreakdownData">getAllMetalsBreakdownData</a></li><li><a href="global.html#getAllUniqueTags">getAllUniqueTags</a></li><li><a href="global.html#getApiAvailability">getApiAvailability</a></li><li><a href="global.html#getAppTitle">getAppTitle</a></li><li><a href="global.html#getBreakdownData">getBreakdownData</a></li><li><a href="global.html#getCacheDurationMs">getCacheDurationMs</a></li><li><a href="global.html#getCachedLookupTable">getCachedLookupTable</a></li><li><a href="global.html#getCardStyle">getCardStyle</a></li><li><a href="global.html#getChartBackgroundColor">getChartBackgroundColor</a></li><li><a href="global.html#getChartColor">getChartColor</a></li><li><a href="global.html#getChartTextColor">getChartTextColor</a></li><li><a href="global.html#getChipColors">getChipColors</a></li><li><a href="global.html#getCompositionFirstWords">getCompositionFirstWords</a></li><li><a href="global.html#getContrastColor">getContrastColor</a></li><li><a href="global.html#getCryptoBackend">getCryptoBackend</a></li><li><a href="global.html#getCurrencySymbol">getCurrencySymbol</a></li><li><a href="global.html#getDateChunks">getDateChunks</a></li><li><a href="global.html#getDebugHistory">getDebugHistory</a></li><li><a href="global.html#getDefaultSyncMode">getDefaultSyncMode</a></li><li><a href="global.html#getDisplayComposition">getDisplayComposition</a></li><li><a href="global.html#getEmbeddedRoadmap">getEmbeddedRoadmap</a></li><li><a href="global.html#getEmbeddedSeedData">getEmbeddedSeedData</a></li><li><a href="global.html#getEmbeddedWhatsNew">getEmbeddedWhatsNew</a></li><li><a href="global.html#getExchangeRate">getExchangeRate</a></li><li><a href="global.html#getExistingElement">getExistingElement</a></li><li><a href="global.html#getFilterChipCategoryConfig">getFilterChipCategoryConfig</a></li><li><a href="global.html#getFooterDomain">getFooterDomain</a></li><li><a href="global.html#getGoldbackDenominationPrice">getGoldbackDenominationPrice</a></li><li><a href="global.html#getGoldbackRetailPrice">getGoldbackRetailPrice</a></li><li><a href="global.html#getHistoricalSparklineData">getHistoricalSparklineData</a></li><li><a href="global.html#getInlineChipConfig">getInlineChipConfig</a></li><li><a href="global.html#getItemTags">getItemTags</a></li><li><a href="global.html#getLastProviderSyncTime">getLastProviderSyncTime</a></li><li><a href="global.html#getLastUpdateTime">getLastUpdateTime</a></li><li><a href="global.html#getLayoutSectionConfig">getLayoutSectionConfig</a></li><li><a href="global.html#getLbmaReferenceYears">getLbmaReferenceYears</a></li><li><a href="global.html#getLookupStats">getLookupStats</a></li><li><a href="global.html#getMetalColor">getMetalColor</a></li><li><a href="global.html#getMetalOrderConfig">getMetalOrderConfig</a></li><li><a href="global.html#getNumistaViewFieldConfig">getNumistaViewFieldConfig</a></li><li><a href="global.html#getPasswordStrength">getPasswordStrength</a></li><li><a href="global.html#getPopularNumistaItems">getPopularNumistaItems</a></li><li><a href="global.html#getProviderOrder">getProviderOrder</a></li><li><a href="global.html#getRequiredYears">getRequiredYears</a></li><li><a href="global.html#getSparklineData">getSparklineData</a></li><li><a href="global.html#getSpotHistoryForMetal">getSpotHistoryForMetal</a></li><li><a href="global.html#getStorageItemDescription">getStorageItemDescription</a></li><li><a href="global.html#getStorageItemDisplayName">getStorageItemDisplayName</a></li><li><a href="global.html#getStorageReportCSS">getStorageReportCSS</a></li><li><a href="global.html#getStorageReportJS">getStorageReportJS</a></li><li><a href="global.html#getSyncDeviceId">getSyncDeviceId</a></li><li><a href="global.html#getSyncPassword">getSyncPassword</a></li><li><a href="global.html#getTemplateVariables">getTemplateVariables</a></li><li><a href="global.html#getUserFriendlyMessage">getUserFriendlyMessage</a></li><li><a href="global.html#getVersionString">getVersionString</a></li><li><a href="global.html#getViewModalSectionConfig">getViewModalSectionConfig</a></li><li><a href="global.html#goldbackEnabled">goldbackEnabled</a></li><li><a href="global.html#goldbackEstimateEnabled">goldbackEstimateEnabled</a></li><li><a href="global.html#goldbackEstimateModifier">goldbackEstimateModifier</a></li><li><a href="global.html#goldbackPriceHistory">goldbackPriceHistory</a></li><li><a href="global.html#goldbackPrices">goldbackPrices</a></li><li><a href="global.html#gramsToOzt">gramsToOzt</a></li><li><a href="global.html#handleError">handleError</a></li><li><a href="global.html#handleHistoryPull">handleHistoryPull</a></li><li><a href="global.html#handleImageDeletion">handleImageDeletion</a></li><li><a href="global.html#handleProviderSave">handleProviderSave</a></li><li><a href="global.html#handleProviderSync">handleProviderSync</a></li><li><a href="global.html#handleRemoteChange">handleRemoteChange</a></li><li><a href="global.html#handleSaveSearchPattern">handleSaveSearchPattern</a></li><li><a href="global.html#handleStaktrakrHistoryPull">handleStaktrakrHistoryPull</a></li><li><a href="global.html#handleVaultAction">handleVaultAction</a></li><li><a href="global.html#hideAboutModal">hideAboutModal</a></li><li><a href="global.html#hideAckModal">hideAckModal</a></li><li><a href="global.html#hideApiHistoryModal">hideApiHistoryModal</a></li><li><a href="global.html#hideApiModal">hideApiModal</a></li><li><a href="global.html#hideApiProvidersModal">hideApiProvidersModal</a></li><li><a href="global.html#hideCatalogHistoryModal">hideCatalogHistoryModal</a></li><li><a href="global.html#hideDebugModal">hideDebugModal</a></li><li><a href="global.html#hideEmptyColumns">hideEmptyColumns</a></li><li><a href="global.html#hideFilesModal">hideFilesModal</a></li><li><a href="global.html#hideGoldbackHistoryModal">hideGoldbackHistoryModal</a></li><li><a href="global.html#hideManualInput">hideManualInput</a></li><li><a href="global.html#hideProviderInfo">hideProviderInfo</a></li><li><a href="global.html#hideSettingsModal">hideSettingsModal</a></li><li><a href="global.html#historicalDataCache">historicalDataCache</a></li><li><a href="global.html#historicalFetchPromises">historicalFetchPromises</a></li><li><a href="global.html#importCsv">importCsv</a></li><li><a href="global.html#importEncryptedBackup">importEncryptedBackup</a></li><li><a href="global.html#importJson">importJson</a></li><li><a href="global.html#importNumistaCsv">importNumistaCsv</a></li><li><a href="global.html#importSpotHistory">importSpotHistory</a></li><li><a href="global.html#initCardSortBar">initCardSortBar</a></li><li><a href="global.html#initCloudSync">initCloudSync</a></li><li><a href="global.html#initSpotHistoryButtons">initSpotHistoryButtons</a></li><li><a href="global.html#initTheme">initTheme</a></li><li><a href="global.html#initializeAutocomplete">initializeAutocomplete</a></li><li><a href="global.html#injectVersionString">injectVersionString</a></li><li><a href="global.html#inventory">inventory</a></li><li><a href="global.html#isCardViewActive">isCardViewActive</a></li><li><a href="global.html#isFeatureEnabled">isFeatureEnabled</a></li><li><a href="global.html#isGoldbackPricingActive">isGoldbackPricingActive</a></li><li><a href="global.html#isValidSelectOption">isValidSelectOption</a></li><li><a href="global.html#itemPriceHistory">itemPriceHistory</a></li><li><a href="global.html#itemTags">itemTags</a></li><li><a href="global.html#itemsPerPage">itemsPerPage</a></li><li><a href="global.html#loadAnnouncements">loadAnnouncements</a></li><li><a href="global.html#loadApiCache">loadApiCache</a></li><li><a href="global.html#loadApiConfig">loadApiConfig</a></li><li><a href="global.html#loadCatalogHistory">loadCatalogHistory</a></li><li><a href="global.html#loadData">loadData</a></li><li><a href="global.html#loadDisplayCurrency">loadDisplayCurrency</a></li><li><a href="global.html#loadExchangeRates">loadExchangeRates</a></li><li><a href="global.html#loadGoldbackEnabled">loadGoldbackEnabled</a></li><li><a href="global.html#loadGoldbackEstimateEnabled">loadGoldbackEstimateEnabled</a></li><li><a href="global.html#loadGoldbackEstimateModifier">loadGoldbackEstimateModifier</a></li><li><a href="global.html#loadGoldbackPriceHistory">loadGoldbackPriceHistory</a></li><li><a href="global.html#loadGoldbackPrices">loadGoldbackPrices</a></li><li><a href="global.html#loadInventory">loadInventory</a></li><li><a href="global.html#loadItemPriceHistory">loadItemPriceHistory</a></li><li><a href="global.html#loadItemTags">loadItemTags</a></li><li><a href="global.html#loadLbmaReferenceEntries">loadLbmaReferenceEntries</a></li><li><a href="global.html#loadLookupTable">loadLookupTable</a></li><li><a href="global.html#loadProviderPriorities">loadProviderPriorities</a></li><li><a href="global.html#loadSeedImages">loadSeedImages</a></li><li><a href="global.html#loadSeedInventory">loadSeedInventory</a></li><li><a href="global.html#loadSeedSpotHistory">loadSeedSpotHistory</a></li><li><a href="global.html#loadSpotHistory">loadSpotHistory</a></li><li><a href="global.html#loadTrendRanges">loadTrendRanges</a></li><li><a href="global.html#loadViewImages">loadViewImages</a></li><li><a href="global.html#loadViewNumistaData">loadViewNumistaData</a></li><li><a href="global.html#logChange">logChange</a></li><li><a href="global.html#logItemChanges">logItemChanges</a></li><li><a href="global.html#logSyncActivity">logSyncActivity</a></li><li><a href="global.html#lookupPcgsByNumber">lookupPcgsByNumber</a></li><li><a href="global.html#lookupPcgsFromForm">lookupPcgsFromForm</a></li><li><a href="global.html#mapNumistaType">mapNumistaType</a></li><li><a href="global.html#marketValueViewItems">marketValueViewItems</a></li><li><a href="global.html#matchCoinSeries">matchCoinSeries</a></li><li><a href="global.html#mergeItemPriceHistory">mergeItemPriceHistory</a></li><li><a href="global.html#migrateHourlySource">migrateHourlySource</a></li><li><a href="global.html#migrateLayoutVisibility">migrateLayoutVisibility</a></li><li><a href="global.html#migrateProviderPriority">migrateProviderPriority</a></li><li><a href="global.html#monitorPerformance">monitorPerformance</a></li><li><a href="global.html#normalizeItemName">normalizeItemName</a></li><li><a href="global.html#normalizeString">normalizeString</a></li><li><a href="global.html#normalizeType">normalizeType</a></li><li><a href="global.html#notesIndex">notesIndex</a></li><li><a href="global.html#onGoldSpotPriceChanged">onGoldSpotPriceChanged</a></li><li><a href="global.html#openEbaySearch">openEbaySearch</a></li><li><a href="global.html#openItemPriceHistoryModal">openItemPriceHistoryModal</a></li><li><a href="global.html#openModalById">openModalById</a></li><li><a href="global.html#openNumistaModal">openNumistaModal</a></li><li><a href="global.html#openSpotLookupModal">openSpotLookupModal</a></li><li><a href="global.html#openStorageReportPopup">openStorageReportPopup</a></li><li><a href="global.html#openVaultModal">openVaultModal</a></li><li><a href="global.html#optimizeStoragePhase1C">optimizeStoragePhase1C</a></li><li><a href="global.html#optionalListener">optionalListener</a></li><li><a href="global.html#oztToGrams">oztToGrams</a></li><li><a href="global.html#pad2">pad2</a></li><li><a href="global.html#parseDate">parseDate</a></li><li><a href="global.html#parseFraction">parseFraction</a></li><li><a href="global.html#parseItemFormFields">parseItemFormFields</a></li><li><a href="global.html#parseNumistaMetal">parseNumistaMetal</a></li><li><a href="global.html#parsePcgsResponse">parsePcgsResponse</a></li><li><a href="global.html#parsePriceToUSD">parsePriceToUSD</a></li><li><a href="global.html#parsePurity">parsePurity</a></li><li><a href="global.html#parseSearchPatterns">parseSearchPatterns</a></li><li><a href="global.html#parseVaultFile">parseVaultFile</a></li><li><a href="global.html#parseWeight">parseWeight</a></li><li><a href="global.html#pcgsFetch">pcgsFetch</a></li><li><a href="global.html#pcgsPreflightCheck">pcgsPreflightCheck</a></li><li><a href="global.html#persistInventoryAndRefresh">persistInventoryAndRefresh</a></li><li><a href="global.html#pollForRemoteChanges">pollForRemoteChanges</a></li><li><a href="global.html#populateAboutModal">populateAboutModal</a></li><li><a href="global.html#populateAckModal">populateAckModal</a></li><li><a href="global.html#populateApiSection">populateApiSection</a></li><li><a href="global.html#populateImagesSection">populateImagesSection</a></li><li><a href="global.html#populateVersionModal">populateVersionModal</a></li><li><a href="global.html#preparePriceHistoryRows">preparePriceHistoryRows</a></li><li><a href="global.html#priceHistoryFilterText">priceHistoryFilterText</a></li><li><a href="global.html#processUploadedImage">processUploadedImage</a></li><li><a href="global.html#providerRequiresKey">providerRequiresKey</a></li><li><a href="global.html#pullSyncVault">pullSyncVault</a></li><li><a href="global.html#purgeCatalogHistory">purgeCatalogHistory</a></li><li><a href="global.html#purgeItemPriceHistory">purgeItemPriceHistory</a></li><li><a href="global.html#purgeSpotHistory">purgeSpotHistory</a></li><li><a href="global.html#pushSyncVault">pushSyncVault</a></li><li><a href="global.html#recalcItem">recalcItem</a></li><li><a href="global.html#recordAllItemPriceSnapshots">recordAllItemPriceSnapshots</a></li><li><a href="global.html#recordCatalogHistory">recordCatalogHistory</a></li><li><a href="global.html#recordGoldbackPrices">recordGoldbackPrices</a></li><li><a href="global.html#recordItemPrice">recordItemPrice</a></li><li><a href="global.html#recordSingleItemPrice">recordSingleItemPrice</a></li><li><a href="global.html#recordSpot">recordSpot</a></li><li><a href="global.html#refreshCompositionOptions">refreshCompositionOptions</a></li><li><a href="global.html#refreshFromCache">refreshFromCache</a></li><li><a href="global.html#refreshLookupTable">refreshLookupTable</a></li><li><a href="global.html#refreshProviderStatuses">refreshProviderStatuses</a></li><li><a href="global.html#refreshSyncUI">refreshSyncUI</a></li><li><a href="global.html#refreshTotalsDots">refreshTotalsDots</a></li><li><a href="global.html#registerName">registerName</a></li><li><a href="global.html#removeFilter">removeFilter</a></li><li><a href="global.html#removeItemTag">removeItemTag</a></li><li><a href="global.html#renameTag">renameTag</a></li><li><a href="global.html#renderActiveFilters">renderActiveFilters</a></li><li><a href="global.html#renderApiHistoryTable">renderApiHistoryTable</a></li><li><a href="global.html#renderApiStatusSummary">renderApiStatusSummary</a></li><li><a href="global.html#renderBulkTable">renderBulkTable</a></li><li><a href="global.html#renderBulkTableBody">renderBulkTableBody</a></li><li><a href="global.html#renderBulkToolbar">renderBulkToolbar</a></li><li><a href="global.html#renderCardA">renderCardA</a></li><li><a href="global.html#renderCardB">renderCardB</a></li><li><a href="global.html#renderCardC">renderCardC</a></li><li><a href="global.html#renderCardView">renderCardView</a></li><li><a href="global.html#renderCatalogHistoryForSettings">renderCatalogHistoryForSettings</a></li><li><a href="global.html#renderCatalogHistoryTable">renderCatalogHistoryTable</a></li><li><a href="global.html#renderChangeLog">renderChangeLog</a></li><li><a href="global.html#renderCloudBackupList">renderCloudBackupList</a></li><li><a href="global.html#renderCustomPatternRules">renderCustomPatternRules</a></li><li><a href="global.html#renderCustomRuleTable">renderCustomRuleTable</a></li><li><a href="global.html#renderEligibleItemsTable">renderEligibleItemsTable</a></li><li><a href="global.html#renderFilterChipCategoryTable">renderFilterChipCategoryTable</a></li><li><a href="global.html#renderGoldbackHistoryTable">renderGoldbackHistoryTable</a></li><li><a href="global.html#renderImageStorageStats">renderImageStorageStats</a></li><li><a href="global.html#renderInlineChipConfigTable">renderInlineChipConfigTable</a></li><li><a href="global.html#renderItemPriceHistoryModalTable">renderItemPriceHistoryModalTable</a></li><li><a href="global.html#renderItemPriceHistoryTable">renderItemPriceHistoryTable</a></li><li><a href="global.html#renderLayoutSectionConfigTable">renderLayoutSectionConfigTable</a></li><li><a href="global.html#renderLbmaHistoryTable">renderLbmaHistoryTable</a></li><li><a href="global.html#renderLogTab">renderLogTab</a></li><li><a href="global.html#renderMetalOrderConfigTable">renderMetalOrderConfigTable</a></li><li><a href="global.html#renderNumistaFieldCheckboxes">renderNumistaFieldCheckboxes</a></li><li><a href="global.html#renderNumistaResultCard">renderNumistaResultCard</a></li><li><a href="global.html#renderNumistaSelectedItem">renderNumistaSelectedItem</a></li><li><a href="global.html#renderNumistaSyncUI">renderNumistaSyncUI</a></li><li><a href="global.html#renderNumistaUsageBar">renderNumistaUsageBar</a></li><li><a href="global.html#renderPcgsFieldCheckboxes">renderPcgsFieldCheckboxes</a></li><li><a href="global.html#renderPcgsSelectedItem">renderPcgsSelectedItem</a></li><li><a href="global.html#renderPcgsUsageBar">renderPcgsUsageBar</a></li><li><a href="global.html#renderSeedRuleTable">renderSeedRuleTable</a></li><li><a href="global.html#renderSpotHistoryTable">renderSpotHistoryTable</a></li><li><a href="global.html#renderSpotLookupEmpty">renderSpotLookupEmpty</a></li><li><a href="global.html#renderSpotLookupResults">renderSpotLookupResults</a></li><li><a href="global.html#renderStorageSection">renderStorageSection</a></li><li><a href="global.html#renderSyncHistorySection">renderSyncHistorySection</a></li><li><a href="global.html#renderSyncStats">renderSyncStats</a></li><li><a href="global.html#renderUserImageGrid">renderUserImageGrid</a></li><li><a href="global.html#renderVersionBadge">renderVersionBadge</a></li><li><a href="global.html#renderViewModalSectionConfigTable">renderViewModalSectionConfigTable</a></li><li><a href="global.html#replaceTemplateVariables">replaceTemplateVariables</a></li><li><a href="global.html#resetSpot">resetSpot</a></li><li><a href="global.html#resetSpotByName">resetSpotByName</a></li><li><a href="global.html#resetSpotPrice">resetSpotPrice</a></li><li><a href="global.html#resolveElement">resolveElement</a></li><li><a href="global.html#restoreBackupZip">restoreBackupZip</a></li><li><a href="global.html#restoreVaultData">restoreVaultData</a></li><li><a href="global.html#resyncCachedEntry">resyncCachedEntry</a></li><li><a href="global.html#safeAttachListener">safeAttachListener</a></li><li><a href="global.html#safeDebug">safeDebug</a></li><li><a href="global.html#safeGetElement">safeGetElement</a></li><li><a href="global.html#sanitizeHtml">sanitizeHtml</a></li><li><a href="global.html#sanitizeImportedItem">sanitizeImportedItem</a></li><li><a href="global.html#sanitizeObjectFields">sanitizeObjectFields</a></li><li><a href="global.html#sanitizeTablesOnLoad">sanitizeTablesOnLoad</a></li><li><a href="global.html#saveApiCache">saveApiCache</a></li><li><a href="global.html#saveApiConfig">saveApiConfig</a></li><li><a href="global.html#saveCatalogHistory">saveCatalogHistory</a></li><li><a href="global.html#saveData">saveData</a></li><li><a href="global.html#saveDisplayCurrency">saveDisplayCurrency</a></li><li><a href="global.html#saveExchangeRates">saveExchangeRates</a></li><li><a href="global.html#saveFilterChipCategoryConfig">saveFilterChipCategoryConfig</a></li><li><a href="global.html#saveGoldbackEnabled">saveGoldbackEnabled</a></li><li><a href="global.html#saveGoldbackEstimateEnabled">saveGoldbackEstimateEnabled</a></li><li><a href="global.html#saveGoldbackEstimateModifier">saveGoldbackEstimateModifier</a></li><li><a href="global.html#saveGoldbackPriceHistory">saveGoldbackPriceHistory</a></li><li><a href="global.html#saveGoldbackPrices">saveGoldbackPrices</a></li><li><a href="global.html#saveInlineChipConfig">saveInlineChipConfig</a></li><li><a href="global.html#saveInventory">saveInventory</a></li><li><a href="global.html#saveItemPriceHistory">saveItemPriceHistory</a></li><li><a href="global.html#saveItemTags">saveItemTags</a></li><li><a href="global.html#saveLayoutSectionConfig">saveLayoutSectionConfig</a></li><li><a href="global.html#saveNumistaViewFieldConfig">saveNumistaViewFieldConfig</a></li><li><a href="global.html#saveProviderPriorities">saveProviderPriorities</a></li><li><a href="global.html#saveSpotHistory">saveSpotHistory</a></li><li><a href="global.html#saveTrendRange">saveTrendRange</a></li><li><a href="global.html#saveUserImageForItem">saveUserImageForItem</a></li><li><a href="global.html#saveViewModalSectionConfig">saveViewModalSectionConfig</a></li><li><a href="global.html#scheduleSyncPush">scheduleSyncPush</a></li><li><a href="global.html#searchHistoricalByDate">searchHistoricalByDate</a></li><li><a href="global.html#searchPatternExistsInCustomGroups">searchPatternExistsInCustomGroups</a></li><li><a href="global.html#searchPatternMatchesAutoChip">searchPatternMatchesAutoChip</a></li><li><a href="global.html#searchQuery">searchQuery</a></li><li><a href="global.html#searchSpotByDate">searchSpotByDate</a></li><li><a href="global.html#serializeVaultFile">serializeVaultFile</a></li><li><a href="global.html#setDefaultProvider">setDefaultProvider</a></li><li><a href="global.html#setEditPreviewUrl">setEditPreviewUrl</a></li><li><a href="global.html#setProviderStatus">setProviderStatus</a></li><li><a href="global.html#setTheme">setTheme</a></li><li><a href="global.html#settingsCatalogSortAsc">settingsCatalogSortAsc</a></li><li><a href="global.html#settingsCatalogSortColumn">settingsCatalogSortColumn</a></li><li><a href="global.html#settingsCloudSortAsc">settingsCloudSortAsc</a></li><li><a href="global.html#settingsCloudSortColumn">settingsCloudSortColumn</a></li><li><a href="global.html#settingsLbmaControlsBound">settingsLbmaControlsBound</a></li><li><a href="global.html#settingsLbmaLoadPromise">settingsLbmaLoadPromise</a></li><li><a href="global.html#settingsLbmaReferenceCache">settingsLbmaReferenceCache</a></li><li><a href="global.html#settingsLbmaSortAsc">settingsLbmaSortAsc</a></li><li><a href="global.html#settingsLbmaSortColumn">settingsLbmaSortColumn</a></li><li><a href="global.html#settingsPriceSortAsc">settingsPriceSortAsc</a></li><li><a href="global.html#settingsPriceSortColumn">settingsPriceSortColumn</a></li><li><a href="global.html#settingsSpotSortAsc">settingsSpotSortAsc</a></li><li><a href="global.html#settingsSpotSortColumn">settingsSpotSortColumn</a></li><li><a href="global.html#setupAboutModalEvents">setupAboutModalEvents</a></li><li><a href="global.html#setupAckModalEvents">setupAckModalEvents</a></li><li><a href="global.html#setupApiEvents">setupApiEvents</a></li><li><a href="global.html#setupBasicEventListeners">setupBasicEventListeners</a></li><li><a href="global.html#setupBulkEditControls">setupBulkEditControls</a></li><li><a href="global.html#setupColumnResizing">setupColumnResizing</a></li><li><a href="global.html#setupDataManagementListeners">setupDataManagementListeners</a></li><li><a href="global.html#setupEventListeners">setupEventListeners</a></li><li><a href="global.html#setupFormatImport">setupFormatImport</a></li><li><a href="global.html#setupHeaderButtonListeners">setupHeaderButtonListeners</a></li><li><a href="global.html#setupImportExportListeners">setupImportExportListeners</a></li><li><a href="global.html#setupItemFormListeners">setupItemFormListeners</a></li><li><a href="global.html#setupNoteAndModalListeners">setupNoteAndModalListeners</a></li><li><a href="global.html#setupPagination">setupPagination</a></li><li><a href="global.html#setupProviderPriority">setupProviderPriority</a></li><li><a href="global.html#setupProviderSettingsListeners">setupProviderSettingsListeners</a></li><li><a href="global.html#setupResponsiveColumns">setupResponsiveColumns</a></li><li><a href="global.html#setupSearch">setupSearch</a></li><li><a href="global.html#setupSearchAndChipListeners">setupSearchAndChipListeners</a></li><li><a href="global.html#setupSettingsEventListeners">setupSettingsEventListeners</a></li><li><a href="global.html#setupSpotPriceListeners">setupSpotPriceListeners</a></li><li><a href="global.html#setupSystemThemeListener">setupSystemThemeListener</a></li><li><a href="global.html#setupTableSortListeners">setupTableSortListeners</a></li><li><a href="global.html#setupThemeToggle">setupThemeToggle</a></li><li><a href="global.html#setupVaultListeners">setupVaultListeners</a></li><li><a href="global.html#setupVersionModalEvents">setupVersionModalEvents</a></li><li><a href="global.html#shouldShowSearchSaveButton">shouldShowSearchSaveButton</a></li><li><a href="global.html#showAboutModal">showAboutModal</a></li><li><a href="global.html#showAckModal">showAckModal</a></li><li><a href="global.html#showApiHistoryModal">showApiHistoryModal</a></li><li><a href="global.html#showApiModal">showApiModal</a></li><li><a href="global.html#showApiProvidersModal">showApiProvidersModal</a></li><li><a href="global.html#showAppAlert">showAppAlert</a></li><li><a href="global.html#showAppConfirm">showAppConfirm</a></li><li><a href="global.html#showAppPrompt">showAppPrompt</a></li><li><a href="global.html#showBulkConfirm">showBulkConfirm</a></li><li><a href="global.html#showCatalogHistoryModal">showCatalogHistoryModal</a></li><li><a href="global.html#showDebugModal">showDebugModal</a></li><li><a href="global.html#showDetailsModal">showDetailsModal</a></li><li><a href="global.html#showFaqModal">showFaqModal</a></li><li><a href="global.html#showFilesModal">showFilesModal</a></li><li><a href="global.html#showFullChangelog">showFullChangelog</a></li><li><a href="global.html#showGoldbackHistoryModal">showGoldbackHistoryModal</a></li><li><a href="global.html#showManualInput">showManualInput</a></li><li><a href="global.html#showNotes">showNotes</a></li><li><a href="global.html#showNotesView">showNotesView</a></li><li><a href="global.html#showNumistaResults">showNumistaResults</a></li><li><a href="global.html#showPcgsFieldPicker">showPcgsFieldPicker</a></li><li><a href="global.html#showProviderInfo">showProviderInfo</a></li><li><a href="global.html#showSettingsModal">showSettingsModal</a></li><li><a href="global.html#showStaticVersionBadge">showStaticVersionBadge</a></li><li><a href="global.html#showSyncConflictModal">showSyncConflictModal</a></li><li><a href="global.html#showSyncUpdateModal">showSyncUpdateModal</a></li><li><a href="global.html#showTagInput">showTagInput</a></li><li><a href="global.html#showVaultStatus">showVaultStatus</a></li><li><a href="global.html#showViewModal">showViewModal</a></li><li><a href="global.html#simpleHash">simpleHash</a></li><li><a href="global.html#simplifyChipValue">simplifyChipValue</a></li><li><a href="global.html#sortInventory">sortInventory</a></li><li><a href="global.html#sortInventoryByDateNewestFirst">sortInventoryByDateNewestFirst</a></li><li><a href="global.html#sparklineInstances">sparklineInstances</a></li><li><a href="global.html#spotHistory">spotHistory</a></li><li><a href="global.html#spotPrices">spotPrices</a></li><li><a href="global.html#startBulkSync">startBulkSync</a></li><li><a href="global.html#startCellEdit">startCellEdit</a></li><li><a href="global.html#startSpotInlineEdit">startSpotInlineEdit</a></li><li><a href="global.html#startSyncPoller">startSyncPoller</a></li><li><a href="global.html#stopSyncPoller">stopSyncPoller</a></li><li><a href="global.html#stripNonAlphanumeric">stripNonAlphanumeric</a></li><li><a href="global.html#switchLogTab">switchLogTab</a></li><li><a href="global.html#switchProviderTab">switchProviderTab</a></li><li><a href="global.html#switchSettingsSection">switchSettingsSection</a></li><li><a href="global.html#syncAllProviders">syncAllProviders</a></li><li><a href="global.html#syncChipToggle">syncChipToggle</a></li><li><a href="global.html#syncCurrencySettingsUI">syncCurrencySettingsUI</a></li><li><a href="global.html#syncGoldbackSettingsUI">syncGoldbackSettingsUI</a></li><li><a href="global.html#syncHasLocalChanges">syncHasLocalChanges</a></li><li><a href="global.html#syncHeaderToggleUI">syncHeaderToggleUI</a></li><li><a href="global.html#syncLayoutVisibilityUI">syncLayoutVisibilityUI</a></li><li><a href="global.html#syncProviderChain">syncProviderChain</a></li><li><a href="global.html#syncProviderPriorityUI">syncProviderPriorityUI</a></li><li><a href="global.html#syncRestoreOverrideBackup">syncRestoreOverrideBackup</a></li><li><a href="global.html#syncSaveOverrideBackup">syncSaveOverrideBackup</a></li><li><a href="global.html#syncSettingsUI">syncSettingsUI</a></li><li><a href="global.html#syncSpotPricesFromApi">syncSpotPricesFromApi</a></li><li><a href="global.html#testApiConnection">testApiConnection</a></li><li><a href="global.html#todayStr">todayStr</a></li><li><a href="global.html#toggleChange">toggleChange</a></li><li><a href="global.html#toggleCurrencyDropdown">toggleCurrencyDropdown</a></li><li><a href="global.html#toggleGlobalPriceView">toggleGlobalPriceView</a></li><li><a href="global.html#togglePriceView">togglePriceView</a></li><li><a href="global.html#toggleTheme">toggleTheme</a></li><li><a href="global.html#toggleVaultPasswordVisibility">toggleVaultPasswordVisibility</a></li><li><a href="global.html#tokenizeWords">tokenizeWords</a></li><li><a href="global.html#updateAllSparklines">updateAllSparklines</a></li><li><a href="global.html#updateCardSortBar">updateCardSortBar</a></li><li><a href="global.html#updateColumnVisibility">updateColumnVisibility</a></li><li><a href="global.html#updateFuzzyIndicator">updateFuzzyIndicator</a></li><li><a href="global.html#updateHistoryPullCost">updateHistoryPullCost</a></li><li><a href="global.html#updateItemCount">updateItemCount</a></li><li><a href="global.html#updateLastTimestamps">updateLastTimestamps</a></li><li><a href="global.html#updateManualSpot">updateManualSpot</a></li><li><a href="global.html#updateMatchIndicator">updateMatchIndicator</a></li><li><a href="global.html#updateModalCurrencyUI">updateModalCurrencyUI</a></li><li><a href="global.html#updatePortalHeight">updatePortalHeight</a></li><li><a href="global.html#updateProviderHistoryTables">updateProviderHistoryTables</a></li><li><a href="global.html#updateProviderSettings">updateProviderSettings</a></li><li><a href="global.html#updateSaveSearchButton">updateSaveSearchButton</a></li><li><a href="global.html#updateSettingsFooter">updateSettingsFooter</a></li><li><a href="global.html#updateSparkline">updateSparkline</a></li><li><a href="global.html#updateSpotCardColor">updateSpotCardColor</a></li><li><a href="global.html#updateSpotChangePercent">updateSpotChangePercent</a></li><li><a href="global.html#updateSpotTimestamp">updateSpotTimestamp</a></li><li><a href="global.html#updateStatusCell">updateStatusCell</a></li><li><a href="global.html#updateStorageStats">updateStorageStats</a></li><li><a href="global.html#updateStrengthBar">updateStrengthBar</a></li><li><a href="global.html#updateSummary">updateSummary</a></li><li><a href="global.html#updateSyncButtonStates">updateSyncButtonStates</a></li><li><a href="global.html#updateSyncStatusIndicator">updateSyncStatusIndicator</a></li><li><a href="global.html#updateThemeButton">updateThemeButton</a></li><li><a href="global.html#useSpotPrice">useSpotPrice</a></li><li><a href="global.html#validateFieldValue">validateFieldValue</a></li><li><a href="global.html#validateInventoryItem">validateInventoryItem</a></li><li><a href="global.html#validateItemFields">validateItemFields</a></li><li><a href="global.html#vaultDecrypt">vaultDecrypt</a></li><li><a href="global.html#vaultDecryptAndRestore">vaultDecryptAndRestore</a></li><li><a href="global.html#vaultDeriveKey">vaultDeriveKey</a></li><li><a href="global.html#vaultEncrypt">vaultEncrypt</a></li><li><a href="global.html#vaultEncryptToBytes">vaultEncryptToBytes</a></li><li><a href="global.html#vaultEncryptToBytesScoped">vaultEncryptToBytesScoped</a></li><li><a href="global.html#vaultRandomBytes">vaultRandomBytes</a></li><li><a href="global.html#verifyPcgsCert">verifyPcgsCert</a></li><li><a href="global.html#wireChipSortToggle">wireChipSortToggle</a></li><li><a href="global.html#wireFeatureFlagToggle">wireFeatureFlagToggle</a></li><li><a href="global.html#wireStorageToggle">wireStorageToggle</a></li><li><a href="global.html#xhrLoadJSON">xhrLoadJSON</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Thu Feb 19 2026 08:11:00 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
