#!/bin/bash

# StackTrackr Engine Management CLI
# Simplified interface for engine operations

ENGINE_DIR="/Volumes/DATA/GitHub/StackTrackr/engine"

case "${1:-help}" in
    "sync")
        echo "üîÑ Syncing templates..."
        $ENGINE_DIR/sync/sync-templates.sh
        ;;
    
    "deploy")
        if [ -z "$2" ]; then
            echo "Usage: engine deploy <project_path> [project_name]"
            echo "Example: engine deploy ~/Projects/MyApp MyApp"
            exit 1
        fi
        $ENGINE_DIR/deployment/deploy-agent-framework.sh "$2" "$3"
        ;;
    
    "deploy-minimal")
        if [ -z "$2" ]; then
            echo "Usage: engine deploy-minimal <project_path> [project_name]"
            exit 1
        fi
        $ENGINE_DIR/deployment/deploy-minimal-framework.sh "$2" "$3"
        ;;
    
    "status")
        echo "üìä StackTrackr Engine Status"
        echo ""
        if [ -f "$ENGINE_DIR/sync/last_sync.json" ]; then
            echo "Last Sync:"
            cat "$ENGINE_DIR/sync/last_sync.json" | grep -E '"last_sync"|"synced_count"|"template_count"' | sed 's/^/  /'
        else
            echo "  ‚ö†Ô∏è  Templates not synced yet"
        fi
        echo ""
        echo "Templates Available:"
        ls -1 "$ENGINE_DIR/templates/" | sed 's/^/  ‚úÖ /'
        echo ""
        echo "Deployment Scripts:"
        ls -1 "$ENGINE_DIR/deployment/" | sed 's/^/  üöÄ /'
        ;;
    
    "help"|*)
        echo "üîß StackTrackr Engine CLI"
        echo ""
        echo "Commands:"
        echo "  sync              - Sync master protocols to templates"
        echo "  deploy <path>     - Deploy full framework to project"
        echo "  deploy-minimal    - Deploy minimal framework"
        echo "  status            - Show engine status"
        echo "  help              - Show this help"
        echo ""
        echo "Examples:"
        echo "  engine sync"
        echo "  engine deploy ~/Projects/MyApp MyApp"
        echo "  engine deploy-minimal ~/Scripts/SimpleScript"
        echo "  engine status"
        ;;
esac
